<html>
<head>
<title>deps/hiredis/hiredis.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/387.html'>deps</a>/<a href='../files/388.html'>hiredis</a>/hiredis.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L61'>[^]</a><a href='#L1281'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L61' title='Defined at 61.'>createReplyObject</a>
<li><a href='#L72' title='Defined at 72.'>freeReplyObject</a>
<li><a href='#L97' title='Defined at 97.'>createStringObject</a>
<li><a href='#L129' title='Defined at 129.'>createArrayObject</a>
<li><a href='#L154' title='Defined at 154.'>createIntegerObject</a>
<li><a href='#L171' title='Defined at 171.'>createNilObject</a>
<li><a href='#L186' title='Defined at 186.'>__redisReaderSetError</a>
<li><a href='#L212' title='Defined at 212.'>chrtos</a>
<li><a href='#L236' title='Defined at 236.'>__redisReaderSetErrorProtocolByte</a>
<li><a href='#L245' title='Defined at 245.'>__redisReaderSetErrorOOM</a>
<li><a href='#L249' title='Defined at 249.'>readBytes</a>
<li><a href='#L260' title='Defined at 260.'>seekNewline</a>
<li><a href='#L288' title='Defined at 288.'>readLongLong</a>
<li><a href='#L315' title='Defined at 315.'>readLine</a>
<li><a href='#L330' title='Defined at 330.'>moveToNextTask</a>
<li><a href='#L355' title='Defined at 355.'>processLineItem</a>
<li><a href='#L389' title='Defined at 389.'>processBulkItem</a>
<li><a href='#L442' title='Defined at 442.'>processMultiBulkItem</a>
<li><a href='#L507' title='Defined at 507.'>processItem</a>
<li><a href='#L556' title='Defined at 556.'>redisReaderCreate</a>
<li><a href='#L577' title='Defined at 577.'>redisReaderFree</a>
<li><a href='#L585' title='Defined at 585.'>redisReaderFeed</a>
<li><a href='#L617' title='Defined at 617.'>redisReaderGetReply</a>
<li><a href='#L668' title='Defined at 668.'>intlen</a>
<li><a href='#L682' title='Defined at 682.'>bulklen</a>
<li><a href='#L686' title='Defined at 686.'>redisvFormatCommand</a>
<li><a href='#L925' title='Defined at 925.'>redisFormatCommand</a>
<li><a href='#L939' title='Defined at 939.'>redisFormatCommandArgv</a>
<li><a href='#L973' title='Defined at 973.'>__redisSetError</a>
<li><a href='#L989' title='Defined at 989.'>redisContextInit</a>
<li><a href='#L1003' title='Defined at 1003.'>redisFree</a>
<li><a href='#L1016' title='Defined at 1016.'>redisConnect</a>
<li><a href='#L1023' title='Defined at 1023.'>redisConnectWithTimeout</a>
<li><a href='#L1030' title='Defined at 1030.'>redisConnectNonBlock</a>
<li><a href='#L1037' title='Defined at 1037.'>redisConnectUnix</a>
<li><a href='#L1044' title='Defined at 1044.'>redisConnectUnixWithTimeout</a>
<li><a href='#L1051' title='Defined at 1051.'>redisConnectUnixNonBlock</a>
<li><a href='#L1059' title='Defined at 1059.'>redisSetTimeout</a>
<li><a href='#L1070' title='Defined at 1070.'>redisBufferRead</a>
<li><a href='#L1107' title='Defined at 1107.'>redisBufferWrite</a>
<li><a href='#L1138' title='Defined at 1138.'>redisGetReplyFromReader</a>
<li><a href='#L1146' title='Defined at 1146.'>redisGetReply</a>
<li><a href='#L1183' title='Defined at 1183.'>__redisAppendCommand</a>
<li><a href='#L1196' title='Defined at 1196.'>redisvAppendCommand</a>
<li><a href='#L1215' title='Defined at 1215.'>redisAppendCommand</a>
<li><a href='#L1225' title='Defined at 1225.'>redisAppendCommandArgv</a>
<li><a href='#L1255' title='Defined at 1255.'>__redisBlockForReply</a>
<li><a href='#L1266' title='Defined at 1266.'>redisvCommand</a>
<li><a href='#L1272' title='Defined at 1272.'>redisCommand</a>
<li><a href='#L1281' title='Defined at 1281.'>redisCommandArgv</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/*</font></i>
<a name='L2'><i><font color='green'> * Copyright (c) 2009-2011, Salvatore Sanfilippo &lt;antirez at gmail dot com&gt;</font></i>
<a name='L3'><i><font color='green'> * Copyright (c) 2010-2011, Pieter Noordhuis &lt;pcnoordhuis at gmail dot com&gt;</font></i>
<a name='L4'><i><font color='green'> *</font></i>
<a name='L5'><i><font color='green'> * All rights reserved.</font></i>
<a name='L6'><i><font color='green'> *</font></i>
<a name='L7'><i><font color='green'> * Redistribution and use in source and binary forms, with or without</font></i>
<a name='L8'><i><font color='green'> * modification, are permitted provided that the following conditions are met:</font></i>
<a name='L9'><i><font color='green'> *</font></i>
<a name='L10'><i><font color='green'> *   * Redistributions of source code must retain the above copyright notice,</font></i>
<a name='L11'><i><font color='green'> *     this list of conditions and the following disclaimer.</font></i>
<a name='L12'><i><font color='green'> *   * Redistributions in binary form must reproduce the above copyright</font></i>
<a name='L13'><i><font color='green'> *     notice, this list of conditions and the following disclaimer in the</font></i>
<a name='L14'><i><font color='green'> *     documentation and/or other materials provided with the distribution.</font></i>
<a name='L15'><i><font color='green'> *   * Neither the name of Redis nor the names of its contributors may be used</font></i>
<a name='L16'><i><font color='green'> *     to endorse or promote products derived from this software without</font></i>
<a name='L17'><i><font color='green'> *     specific prior written permission.</font></i>
<a name='L18'><i><font color='green'> *</font></i>
<a name='L19'><i><font color='green'> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"</font></i>
<a name='L20'><i><font color='green'> * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</font></i>
<a name='L21'><i><font color='green'> * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</font></i>
<a name='L22'><i><font color='green'> * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE</font></i>
<a name='L23'><i><font color='green'> * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</font></i>
<a name='L24'><i><font color='green'> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</font></i>
<a name='L25'><i><font color='green'> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</font></i>
<a name='L26'><i><font color='green'> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</font></i>
<a name='L27'><i><font color='green'> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</font></i>
<a name='L28'><i><font color='green'> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</font></i>
<a name='L29'><i><font color='green'> * POSSIBILITY OF SUCH DAMAGE.</font></i>
<a name='L30'><i><font color='green'> */</font></i>
<a name='L31'>
<a name='L32'><font color='darkred'>#include</font> "<a href='../I/12.html'>fmacros.h</a>"
<a name='L33'><font color='darkred'>#include</font> &lt;string.h&gt;
<a name='L34'><font color='darkred'>#include</font> &lt;stdlib.h&gt;
<a name='L35'><font color='darkred'>#include</font> &lt;unistd.h&gt;
<a name='L36'><font color='darkred'>#include</font> &lt;assert.h&gt;
<a name='L37'><font color='darkred'>#include</font> &lt;errno.h&gt;
<a name='L38'><font color='darkred'>#include</font> &lt;ctype.h&gt;
<a name='L39'>
<a name='L40'><font color='darkred'>#include</font> "<a href='121.html'>hiredis.h</a>"
<a name='L41'><font color='darkred'>#include</font> "<a href='125.html'>net.h</a>"
<a name='L42'><font color='darkred'>#include</font> "<a href='../I/18.html'>sds.h</a>"
<a name='L43'>
<a name='L44'><b>static</b> <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *<a href='../S/120.html#L61' title='Defined at 61 in deps/hiredis/hiredis.c.'>createReplyObject</a>(<b>int</b> type);
<a name='L45'><b>static</b> <b>void</b> *<a href='../D/1986.html' title='Multiple defined in 2 places.'>createStringObject</a>(<b>const</b> redisReadTask *task, <b>char</b> *str, size_t len);
<a name='L46'><b>static</b> <b>void</b> *<a href='../S/120.html#L129' title='Defined at 129 in deps/hiredis/hiredis.c.'>createArrayObject</a>(<b>const</b> redisReadTask *task, <b>int</b> elements);
<a name='L47'><b>static</b> <b>void</b> *<a href='../S/120.html#L154' title='Defined at 154 in deps/hiredis/hiredis.c.'>createIntegerObject</a>(<b>const</b> redisReadTask *task, <b>long</b> <b>long</b> value);
<a name='L48'><b>static</b> <b>void</b> *<a href='../S/120.html#L171' title='Defined at 171 in deps/hiredis/hiredis.c.'>createNilObject</a>(<b>const</b> redisReadTask *task);
<a name='L49'>
<a name='L50'><i><font color='green'>/* Default set of functions to build the reply. Keep in mind that such a</font></i>
<a name='L51'><i><font color='green'> * function returning NULL is interpreted as OOM. */</font></i>
<a name='L52'><b>static</b> <a href='../D/3856.html' title='Multiple defined in 2 places.'>redisReplyObjectFunctions</a> defaultFunctions = <font color='red'>{</font>
<a name='L53'>    <a href='../D/1986.html' title='Multiple defined in 2 places.'>createStringObject</a>,
<a name='L54'>    <a href='../S/120.html#L129' title='Defined at 129 in deps/hiredis/hiredis.c.'>createArrayObject</a>,
<a name='L55'>    <a href='../S/120.html#L154' title='Defined at 154 in deps/hiredis/hiredis.c.'>createIntegerObject</a>,
<a name='L56'>    <a href='../S/120.html#L171' title='Defined at 171 in deps/hiredis/hiredis.c.'>createNilObject</a>,
<a name='L57'>    <a href='../S/120.html#L72' title='Defined at 72 in deps/hiredis/hiredis.c.'>freeReplyObject</a>
<a name='L58'><font color='red'>}</font>;
<a name='L59'>
<a name='L60'><i><font color='green'>/* Create a reply object */</font></i>
<a name='L61'><b>static</b> <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *<a href='../R/1704.html' title='Multiple refered from 5 places.'>createReplyObject</a>(<b>int</b> type) <font color='red'>{</font>
<a name='L62'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r = <a href='../D/1797.html' title='Multiple defined in 2 places.'>calloc</a>(1,<b>sizeof</b>(*r));
<a name='L63'>
<a name='L64'>    <b>if</b> (r == NULL)
<a name='L65'>        <b>return</b> NULL;
<a name='L66'>
<a name='L67'>    r-&gt;type = type;
<a name='L68'>    <b>return</b> r;
<a name='L69'><font color='red'>}</font>
<a name='L70'>
<a name='L71'><i><font color='green'>/* Free a reply object */</font></i>
<a name='L72'><b>void</b> <a href='../R/2005.html' title='Multiple refered from 53 places.'>freeReplyObject</a>(<b>void</b> *reply) <font color='red'>{</font>
<a name='L73'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r = reply;
<a name='L74'>    size_t j;
<a name='L75'>
<a name='L76'>    <b>switch</b>(r-&gt;type) <font color='red'>{</font>
<a name='L77'>    <b>case</b> <a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>:
<a name='L78'>        <b>break</b>; <i><font color='green'>/* Nothing to free */</font></i>
<a name='L79'>    <b>case</b> <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>:
<a name='L80'>        <b>if</b> (r-&gt;element != NULL) <font color='red'>{</font>
<a name='L81'>            <b>for</b> (j = 0; j &lt; r-&gt;elements; j++)
<a name='L82'>                <b>if</b> (r-&gt;element[j] != NULL)
<a name='L83'>                    <a href='../S/120.html#L72' title='Defined at 72 in deps/hiredis/hiredis.c.'>freeReplyObject</a>(r-&gt;element[j]);
<a name='L84'>            <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(r-&gt;element);
<a name='L85'>        <font color='red'>}</font>
<a name='L86'>        <b>break</b>;
<a name='L87'>    <b>case</b> <a href='../S/121.html#L87' title='Defined at 87 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ERROR</a>:
<a name='L88'>    <b>case</b> <a href='../S/121.html#L86' title='Defined at 86 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STATUS</a>:
<a name='L89'>    <b>case</b> <a href='../S/121.html#L82' title='Defined at 82 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STRING</a>:
<a name='L90'>        <b>if</b> (r-&gt;str != NULL)
<a name='L91'>            <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(r-&gt;str);
<a name='L92'>        <b>break</b>;
<a name='L93'>    <font color='red'>}</font>
<a name='L94'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(r);
<a name='L95'><font color='red'>}</font>
<a name='L96'>
<a name='L97'><b>static</b> <b>void</b> *<a href='../R/1711.html' title='Multiple refered from 51 places.'>createStringObject</a>(<b>const</b> redisReadTask *task, <b>char</b> *str, size_t len) <font color='red'>{</font>
<a name='L98'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r, *parent;
<a name='L99'>    <b>char</b> *buf;
<a name='L100'>
<a name='L101'>    r = <a href='../S/120.html#L61' title='Defined at 61 in deps/hiredis/hiredis.c.'>createReplyObject</a>(task-&gt;type);
<a name='L102'>    <b>if</b> (r == NULL)
<a name='L103'>        <b>return</b> NULL;
<a name='L104'>
<a name='L105'>    buf = <a href='../D/3259.html' title='Multiple defined in 2 places.'>malloc</a>(len+1);
<a name='L106'>    <b>if</b> (buf == NULL) <font color='red'>{</font>
<a name='L107'>        <a href='../S/120.html#L72' title='Defined at 72 in deps/hiredis/hiredis.c.'>freeReplyObject</a>(r);
<a name='L108'>        <b>return</b> NULL;
<a name='L109'>    <font color='red'>}</font>
<a name='L110'>
<a name='L111'>    <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(task-&gt;type == <a href='../S/121.html#L87' title='Defined at 87 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ERROR</a>  ||
<a name='L112'>           task-&gt;type == <a href='../S/121.html#L86' title='Defined at 86 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STATUS</a> ||
<a name='L113'>           task-&gt;type == <a href='../S/121.html#L82' title='Defined at 82 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STRING</a>);
<a name='L114'>
<a name='L115'>    <i><font color='green'>/* Copy string value */</font></i>
<a name='L116'>    memcpy(buf,str,len);
<a name='L117'>    buf[len] = '\0';
<a name='L118'>    r-&gt;str = buf;
<a name='L119'>    r-&gt;len = len;
<a name='L120'>
<a name='L121'>    <b>if</b> (task-&gt;parent) <font color='red'>{</font>
<a name='L122'>        parent = task-&gt;parent-&gt;obj;
<a name='L123'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(parent-&gt;type == <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L124'>        parent-&gt;element[task-&gt;idx] = r;
<a name='L125'>    <font color='red'>}</font>
<a name='L126'>    <b>return</b> r;
<a name='L127'><font color='red'>}</font>
<a name='L128'>
<a name='L129'><b>static</b> <b>void</b> *<a href='../R/1690.html' title='Multiple refered from 2 places.'>createArrayObject</a>(<b>const</b> redisReadTask *task, <b>int</b> elements) <font color='red'>{</font>
<a name='L130'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r, *parent;
<a name='L131'>
<a name='L132'>    r = <a href='../S/120.html#L61' title='Defined at 61 in deps/hiredis/hiredis.c.'>createReplyObject</a>(<a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L133'>    <b>if</b> (r == NULL)
<a name='L134'>        <b>return</b> NULL;
<a name='L135'>
<a name='L136'>    <b>if</b> (elements &gt; 0) <font color='red'>{</font>
<a name='L137'>        r-&gt;element = <a href='../D/1797.html' title='Multiple defined in 2 places.'>calloc</a>(elements,<b>sizeof</b>(<a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a>*));
<a name='L138'>        <b>if</b> (r-&gt;element == NULL) <font color='red'>{</font>
<a name='L139'>            <a href='../S/120.html#L72' title='Defined at 72 in deps/hiredis/hiredis.c.'>freeReplyObject</a>(r);
<a name='L140'>            <b>return</b> NULL;
<a name='L141'>        <font color='red'>}</font>
<a name='L142'>    <font color='red'>}</font>
<a name='L143'>
<a name='L144'>    r-&gt;elements = elements;
<a name='L145'>
<a name='L146'>    <b>if</b> (task-&gt;parent) <font color='red'>{</font>
<a name='L147'>        parent = task-&gt;parent-&gt;obj;
<a name='L148'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(parent-&gt;type == <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L149'>        parent-&gt;element[task-&gt;idx] = r;
<a name='L150'>    <font color='red'>}</font>
<a name='L151'>    <b>return</b> r;
<a name='L152'><font color='red'>}</font>
<a name='L153'>
<a name='L154'><b>static</b> <b>void</b> *<a href='../R/1696.html' title='Multiple refered from 2 places.'>createIntegerObject</a>(<b>const</b> redisReadTask *task, <b>long</b> <b>long</b> value) <font color='red'>{</font>
<a name='L155'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r, *parent;
<a name='L156'>
<a name='L157'>    r = <a href='../S/120.html#L61' title='Defined at 61 in deps/hiredis/hiredis.c.'>createReplyObject</a>(<a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>);
<a name='L158'>    <b>if</b> (r == NULL)
<a name='L159'>        <b>return</b> NULL;
<a name='L160'>
<a name='L161'>    r-&gt;integer = value;
<a name='L162'>
<a name='L163'>    <b>if</b> (task-&gt;parent) <font color='red'>{</font>
<a name='L164'>        parent = task-&gt;parent-&gt;obj;
<a name='L165'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(parent-&gt;type == <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L166'>        parent-&gt;element[task-&gt;idx] = r;
<a name='L167'>    <font color='red'>}</font>
<a name='L168'>    <b>return</b> r;
<a name='L169'><font color='red'>}</font>
<a name='L170'>
<a name='L171'><b>static</b> <b>void</b> *<a href='../R/1701.html' title='Multiple refered from 2 places.'>createNilObject</a>(<b>const</b> redisReadTask *task) <font color='red'>{</font>
<a name='L172'>    <a href='../D/3855.html' title='Multiple defined in 2 places.'>redisReply</a> *r, *parent;
<a name='L173'>
<a name='L174'>    r = <a href='../S/120.html#L61' title='Defined at 61 in deps/hiredis/hiredis.c.'>createReplyObject</a>(<a href='../S/121.html#L85' title='Defined at 85 in deps/hiredis/hiredis.h.'>REDIS_REPLY_NIL</a>);
<a name='L175'>    <b>if</b> (r == NULL)
<a name='L176'>        <b>return</b> NULL;
<a name='L177'>
<a name='L178'>    <b>if</b> (task-&gt;parent) <font color='red'>{</font>
<a name='L179'>        parent = task-&gt;parent-&gt;obj;
<a name='L180'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(parent-&gt;type == <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L181'>        parent-&gt;element[task-&gt;idx] = r;
<a name='L182'>    <font color='red'>}</font>
<a name='L183'>    <b>return</b> r;
<a name='L184'><font color='red'>}</font>
<a name='L185'>
<a name='L186'><b>static</b> <b>void</b> <a href='../R/1141.html' title='Multiple refered from 3 places.'>__redisReaderSetError</a>(redisReader *r, <b>int</b> type, <b>const</b> <b>char</b> *str) <font color='red'>{</font>
<a name='L187'>    size_t len;
<a name='L188'>
<a name='L189'>    <b>if</b> (r-&gt;reply != NULL &amp;&amp; r-&gt;fn &amp;&amp; r-&gt;fn-&gt;freeObject) <font color='red'>{</font>
<a name='L190'>        r-&gt;fn-&gt;freeObject(r-&gt;reply);
<a name='L191'>        r-&gt;reply = NULL;
<a name='L192'>    <font color='red'>}</font>
<a name='L193'>
<a name='L194'>    <i><font color='green'>/* Clear input buffer on errors. */</font></i>
<a name='L195'>    <b>if</b> (r-&gt;buf != NULL) <font color='red'>{</font>
<a name='L196'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(r-&gt;buf);
<a name='L197'>        r-&gt;buf = NULL;
<a name='L198'>        r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = r-&gt;len = 0;
<a name='L199'>    <font color='red'>}</font>
<a name='L200'>
<a name='L201'>    <i><font color='green'>/* Reset task stack. */</font></i>
<a name='L202'>    r-&gt;ridx = -1;
<a name='L203'>
<a name='L204'>    <i><font color='green'>/* Set error. */</font></i>
<a name='L205'>    r-&gt;err = type;
<a name='L206'>    len = strlen(str);
<a name='L207'>    len = len &lt; (<b>sizeof</b>(r-&gt;errstr)-1) ? len : (<b>sizeof</b>(r-&gt;errstr)-1);
<a name='L208'>    memcpy(r-&gt;errstr,str,len);
<a name='L209'>    r-&gt;errstr[len] = '\0';
<a name='L210'><font color='red'>}</font>
<a name='L211'>
<a name='L212'><b>static</b> size_t <a href='../S/120.html#L239' title='Refered from 239 in deps/hiredis/hiredis.c.'>chrtos</a>(<b>char</b> *buf, size_t size, <b>char</b> byte) <font color='red'>{</font>
<a name='L213'>    size_t len = 0;
<a name='L214'>
<a name='L215'>    <b>switch</b>(byte) <font color='red'>{</font>
<a name='L216'>    <b>case</b> '\\':
<a name='L217'>    <b>case</b> '"':
<a name='L218'>        len = snprintf(buf,size,"\"\\%c\"",byte);
<a name='L219'>        <b>break</b>;
<a name='L220'>    <b>case</b> '\n': len = snprintf(buf,size,"\"\\n\""); <b>break</b>;
<a name='L221'>    <b>case</b> '\r': len = snprintf(buf,size,"\"\\r\""); <b>break</b>;
<a name='L222'>    <b>case</b> '\t': len = snprintf(buf,size,"\"\\t\""); <b>break</b>;
<a name='L223'>    <b>case</b> '\a': len = snprintf(buf,size,"\"\\a\""); <b>break</b>;
<a name='L224'>    <b>case</b> '\b': len = snprintf(buf,size,"\"\\b\""); <b>break</b>;
<a name='L225'>    <b>default</b>:
<a name='L226'>        <b>if</b> (isprint(byte))
<a name='L227'>            len = snprintf(buf,size,"\"%c\"",byte);
<a name='L228'>        <b>else</b>
<a name='L229'>            len = snprintf(buf,size,"\"\\x%02x\"",(<b>unsigned</b> <b>char</b>)byte);
<a name='L230'>        <b>break</b>;
<a name='L231'>    <font color='red'>}</font>
<a name='L232'>
<a name='L233'>    <b>return</b> len;
<a name='L234'><font color='red'>}</font>
<a name='L235'>
<a name='L236'><b>static</b> <b>void</b> <a href='../S/120.html#L531' title='Refered from 531 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorProtocolByte</a>(redisReader *r, <b>char</b> byte) <font color='red'>{</font>
<a name='L237'>    <b>char</b> cbuf[8], sbuf[128];
<a name='L238'>
<a name='L239'>    <a href='../S/120.html#L212' title='Defined at 212 in deps/hiredis/hiredis.c.'>chrtos</a>(cbuf,<b>sizeof</b>(cbuf),byte);
<a name='L240'>    snprintf(sbuf,<b>sizeof</b>(sbuf),
<a name='L241'>        "Protocol error, got %s as reply type byte", cbuf);
<a name='L242'>    <a href='../S/120.html#L186' title='Defined at 186 in deps/hiredis/hiredis.c.'>__redisReaderSetError</a>(r,<a href='../S/121.html#L51' title='Defined at 51 in deps/hiredis/hiredis.h.'>REDIS_ERR_PROTOCOL</a>,sbuf);
<a name='L243'><font color='red'>}</font>
<a name='L244'>
<a name='L245'><b>static</b> <b>void</b> <a href='../R/1142.html' title='Multiple refered from 5 places.'>__redisReaderSetErrorOOM</a>(redisReader *r) <font color='red'>{</font>
<a name='L246'>    <a href='../S/120.html#L186' title='Defined at 186 in deps/hiredis/hiredis.c.'>__redisReaderSetError</a>(r,<a href='../S/121.html#L52' title='Defined at 52 in deps/hiredis/hiredis.h.'>REDIS_ERR_OOM</a>,"Out of memory");
<a name='L247'><font color='red'>}</font>
<a name='L248'>
<a name='L249'><b>static</b> <b>char</b> *<a href='../R/3372.html' title='Multiple refered from 16 places.'>readBytes</a>(redisReader *r, <b>unsigned</b> <b>int</b> bytes) <font color='red'>{</font>
<a name='L250'>    <b>char</b> *p;
<a name='L251'>    <b>if</b> (r-&gt;len-r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> &gt;= bytes) <font color='red'>{</font>
<a name='L252'>        p = r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>;
<a name='L253'>        r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += bytes;
<a name='L254'>        <b>return</b> p;
<a name='L255'>    <font color='red'>}</font>
<a name='L256'>    <b>return</b> NULL;
<a name='L257'><font color='red'>}</font>
<a name='L258'>
<a name='L259'><i><font color='green'>/* Find pointer to \r\n. */</font></i>
<a name='L260'><b>static</b> <b>char</b> *<a href='../R/3654.html' title='Multiple refered from 2 places.'>seekNewline</a>(<b>char</b> *s, size_t len) <font color='red'>{</font>
<a name='L261'>    <b>int</b> <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = 0;
<a name='L262'>    <b>int</b> _len = len-1;
<a name='L263'>
<a name='L264'>    <i><font color='green'>/* Position should be &lt; len-1 because the character at "pos" should be</font></i>
<a name='L265'><i><font color='green'>     * followed by a \n. Note that strchr cannot be used because it doesn't</font></i>
<a name='L266'><i><font color='green'>     * allow to search a limited length and the buffer that is being searched</font></i>
<a name='L267'><i><font color='green'>     * might not have a trailing NULL character. */</font></i>
<a name='L268'>    <b>while</b> (<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> &lt; _len) <font color='red'>{</font>
<a name='L269'>        <b>while</b>(<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> &lt; _len &amp;&amp; s[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>] != '\r') <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++;
<a name='L270'>        <b>if</b> (s[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>] != '\r') <font color='red'>{</font>
<a name='L271'>            <i><font color='green'>/* Not found. */</font></i>
<a name='L272'>            <b>return</b> NULL;
<a name='L273'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L274'>            <b>if</b> (s[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>+1] == '\n') <font color='red'>{</font>
<a name='L275'>                <i><font color='green'>/* Found. */</font></i>
<a name='L276'>                <b>return</b> s+<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>;
<a name='L277'>            <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L278'>                <i><font color='green'>/* Continue searching. */</font></i>
<a name='L279'>                <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++;
<a name='L280'>            <font color='red'>}</font>
<a name='L281'>        <font color='red'>}</font>
<a name='L282'>    <font color='red'>}</font>
<a name='L283'>    <b>return</b> NULL;
<a name='L284'><font color='red'>}</font>
<a name='L285'>
<a name='L286'><i><font color='green'>/* Read a long long value starting at *s, under the assumption that it will be</font></i>
<a name='L287'><i><font color='green'> * terminated by \r\n. Ambiguously returns -1 for unexpected input. */</font></i>
<a name='L288'><b>static</b> <b>long</b> <b>long</b> <a href='../R/3376.html' title='Multiple refered from 3 places.'>readLongLong</a>(<b>char</b> *s) <font color='red'>{</font>
<a name='L289'>    <b>long</b> <b>long</b> v = 0;
<a name='L290'>    <b>int</b> dec, mult = 1;
<a name='L291'>    <b>char</b> c;
<a name='L292'>
<a name='L293'>    <b>if</b> (*s == '-') <font color='red'>{</font>
<a name='L294'>        mult = -1;
<a name='L295'>        s++;
<a name='L296'>    <font color='red'>}</font> <b>else</b> <b>if</b> (*s == '+') <font color='red'>{</font>
<a name='L297'>        mult = 1;
<a name='L298'>        s++;
<a name='L299'>    <font color='red'>}</font>
<a name='L300'>
<a name='L301'>    <b>while</b> ((c = *(s++)) != '\r') <font color='red'>{</font>
<a name='L302'>        dec = c - '0';
<a name='L303'>        <b>if</b> (dec &gt;= 0 &amp;&amp; dec &lt; 10) <font color='red'>{</font>
<a name='L304'>            v *= 10;
<a name='L305'>            v += dec;
<a name='L306'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L307'>            <i><font color='green'>/* Should not happen... */</font></i>
<a name='L308'>            <b>return</b> -1;
<a name='L309'>        <font color='red'>}</font>
<a name='L310'>    <font color='red'>}</font>
<a name='L311'>
<a name='L312'>    <b>return</b> mult*v;
<a name='L313'><font color='red'>}</font>
<a name='L314'>
<a name='L315'><b>static</b> <b>char</b> *<a href='../R/3374.html' title='Multiple refered from 2 places.'>readLine</a>(redisReader *r, <b>int</b> *_len) <font color='red'>{</font>
<a name='L316'>    <b>char</b> *p, *s;
<a name='L317'>    <b>int</b> len;
<a name='L318'>
<a name='L319'>    p = r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>;
<a name='L320'>    s = <a href='../S/120.html#L260' title='Defined at 260 in deps/hiredis/hiredis.c.'>seekNewline</a>(p,(r-&gt;len-r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>));
<a name='L321'>    <b>if</b> (s != NULL) <font color='red'>{</font>
<a name='L322'>        len = s-(r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>);
<a name='L323'>        r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += len+2; <i><font color='green'>/* skip \r\n */</font></i>
<a name='L324'>        <b>if</b> (_len) *_len = len;
<a name='L325'>        <b>return</b> p;
<a name='L326'>    <font color='red'>}</font>
<a name='L327'>    <b>return</b> NULL;
<a name='L328'><font color='red'>}</font>
<a name='L329'>
<a name='L330'><b>static</b> <b>void</b> <a href='../R/3023.html' title='Multiple refered from 4 places.'>moveToNextTask</a>(redisReader *r) <font color='red'>{</font>
<a name='L331'>    <a href='../D/3849.html' title='Multiple defined in 2 places.'>redisReadTask</a> *cur, *prv;
<a name='L332'>    <b>while</b> (r-&gt;ridx &gt;= 0) <font color='red'>{</font>
<a name='L333'>        <i><font color='green'>/* Return a.s.a.p. when the stack is now empty. */</font></i>
<a name='L334'>        <b>if</b> (r-&gt;ridx == 0) <font color='red'>{</font>
<a name='L335'>            r-&gt;ridx--;
<a name='L336'>            <b>return</b>;
<a name='L337'>        <font color='red'>}</font>
<a name='L338'>
<a name='L339'>        cur = &amp;(r-&gt;rstack[r-&gt;ridx]);
<a name='L340'>        prv = &amp;(r-&gt;rstack[r-&gt;ridx-1]);
<a name='L341'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(prv-&gt;type == <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>);
<a name='L342'>        <b>if</b> (cur-&gt;idx == prv-&gt;elements-1) <font color='red'>{</font>
<a name='L343'>            r-&gt;ridx--;
<a name='L344'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L345'>            <i><font color='green'>/* Reset the type because the next item can be anything */</font></i>
<a name='L346'>            <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(cur-&gt;idx &lt; prv-&gt;elements);
<a name='L347'>            cur-&gt;type = -1;
<a name='L348'>            cur-&gt;elements = -1;
<a name='L349'>            cur-&gt;idx++;
<a name='L350'>            <b>return</b>;
<a name='L351'>        <font color='red'>}</font>
<a name='L352'>    <font color='red'>}</font>
<a name='L353'><font color='red'>}</font>
<a name='L354'>
<a name='L355'><b>static</b> <b>int</b> <a href='../S/120.html#L545' title='Refered from 545 in deps/hiredis/hiredis.c.'>processLineItem</a>(redisReader *r) <font color='red'>{</font>
<a name='L356'>    <a href='../D/3849.html' title='Multiple defined in 2 places.'>redisReadTask</a> *cur = &amp;(r-&gt;rstack[r-&gt;ridx]);
<a name='L357'>    <b>void</b> *obj;
<a name='L358'>    <b>char</b> *p;
<a name='L359'>    <b>int</b> len;
<a name='L360'>
<a name='L361'>    <b>if</b> ((p = <a href='../S/120.html#L315' title='Defined at 315 in deps/hiredis/hiredis.c.'>readLine</a>(r,&amp;len)) != NULL) <font color='red'>{</font>
<a name='L362'>        <b>if</b> (cur-&gt;type == <a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>) <font color='red'>{</font>
<a name='L363'>            <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createInteger)
<a name='L364'>                obj = r-&gt;fn-&gt;createInteger(cur,<a href='../S/120.html#L288' title='Defined at 288 in deps/hiredis/hiredis.c.'>readLongLong</a>(p));
<a name='L365'>            <b>else</b>
<a name='L366'>                obj = (<b>void</b>*)<a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>;
<a name='L367'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L368'>            <i><font color='green'>/* Type will be error or status. */</font></i>
<a name='L369'>            <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createString)
<a name='L370'>                obj = r-&gt;fn-&gt;createString(cur,p,len);
<a name='L371'>            <b>else</b>
<a name='L372'>                obj = (<b>void</b>*)(size_t)(cur-&gt;type);
<a name='L373'>        <font color='red'>}</font>
<a name='L374'>
<a name='L375'>        <b>if</b> (obj == NULL) <font color='red'>{</font>
<a name='L376'>            <a href='../S/120.html#L245' title='Defined at 245 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorOOM</a>(r);
<a name='L377'>            <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L378'>        <font color='red'>}</font>
<a name='L379'>
<a name='L380'>        <i><font color='green'>/* Set reply if this is the root object. */</font></i>
<a name='L381'>        <b>if</b> (r-&gt;ridx == 0) r-&gt;reply = obj;
<a name='L382'>        <a href='../S/120.html#L330' title='Defined at 330 in deps/hiredis/hiredis.c.'>moveToNextTask</a>(r);
<a name='L383'>        <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L384'>    <font color='red'>}</font>
<a name='L385'>
<a name='L386'>    <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L387'><font color='red'>}</font>
<a name='L388'>
<a name='L389'><b>static</b> <b>int</b> <a href='../S/120.html#L547' title='Refered from 547 in deps/hiredis/hiredis.c.'>processBulkItem</a>(redisReader *r) <font color='red'>{</font>
<a name='L390'>    <a href='../D/3849.html' title='Multiple defined in 2 places.'>redisReadTask</a> *cur = &amp;(r-&gt;rstack[r-&gt;ridx]);
<a name='L391'>    <b>void</b> *obj = NULL;
<a name='L392'>    <b>char</b> *p, *s;
<a name='L393'>    <b>long</b> len;
<a name='L394'>    <b>unsigned</b> <b>long</b> bytelen;
<a name='L395'>    <b>int</b> success = 0;
<a name='L396'>
<a name='L397'>    p = r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>;
<a name='L398'>    s = <a href='../S/120.html#L260' title='Defined at 260 in deps/hiredis/hiredis.c.'>seekNewline</a>(p,r-&gt;len-r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>);
<a name='L399'>    <b>if</b> (s != NULL) <font color='red'>{</font>
<a name='L400'>        p = r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>;
<a name='L401'>        bytelen = s-(r-&gt;buf+r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>)+2; <i><font color='green'>/* include \r\n */</font></i>
<a name='L402'>        len = <a href='../S/120.html#L288' title='Defined at 288 in deps/hiredis/hiredis.c.'>readLongLong</a>(p);
<a name='L403'>
<a name='L404'>        <b>if</b> (len &lt; 0) <font color='red'>{</font>
<a name='L405'>            <i><font color='green'>/* The nil object can always be created. */</font></i>
<a name='L406'>            <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createNil)
<a name='L407'>                obj = r-&gt;fn-&gt;createNil(cur);
<a name='L408'>            <b>else</b>
<a name='L409'>                obj = (<b>void</b>*)<a href='../S/121.html#L85' title='Defined at 85 in deps/hiredis/hiredis.h.'>REDIS_REPLY_NIL</a>;
<a name='L410'>            success = 1;
<a name='L411'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L412'>            <i><font color='green'>/* Only continue when the buffer contains the entire bulk item. */</font></i>
<a name='L413'>            bytelen += len+2; <i><font color='green'>/* include \r\n */</font></i>
<a name='L414'>            <b>if</b> (r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>+bytelen &lt;= r-&gt;len) <font color='red'>{</font>
<a name='L415'>                <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createString)
<a name='L416'>                    obj = r-&gt;fn-&gt;createString(cur,s+2,len);
<a name='L417'>                <b>else</b>
<a name='L418'>                    obj = (<b>void</b>*)<a href='../S/121.html#L82' title='Defined at 82 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STRING</a>;
<a name='L419'>                success = 1;
<a name='L420'>            <font color='red'>}</font>
<a name='L421'>        <font color='red'>}</font>
<a name='L422'>
<a name='L423'>        <i><font color='green'>/* Proceed when obj was created. */</font></i>
<a name='L424'>        <b>if</b> (success) <font color='red'>{</font>
<a name='L425'>            <b>if</b> (obj == NULL) <font color='red'>{</font>
<a name='L426'>                <a href='../S/120.html#L245' title='Defined at 245 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorOOM</a>(r);
<a name='L427'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L428'>            <font color='red'>}</font>
<a name='L429'>
<a name='L430'>            r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += bytelen;
<a name='L431'>
<a name='L432'>            <i><font color='green'>/* Set reply if this is the root object. */</font></i>
<a name='L433'>            <b>if</b> (r-&gt;ridx == 0) r-&gt;reply = obj;
<a name='L434'>            <a href='../S/120.html#L330' title='Defined at 330 in deps/hiredis/hiredis.c.'>moveToNextTask</a>(r);
<a name='L435'>            <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L436'>        <font color='red'>}</font>
<a name='L437'>    <font color='red'>}</font>
<a name='L438'>
<a name='L439'>    <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L440'><font color='red'>}</font>
<a name='L441'>
<a name='L442'><b>static</b> <b>int</b> <a href='../S/120.html#L549' title='Refered from 549 in deps/hiredis/hiredis.c.'>processMultiBulkItem</a>(redisReader *r) <font color='red'>{</font>
<a name='L443'>    <a href='../D/3849.html' title='Multiple defined in 2 places.'>redisReadTask</a> *cur = &amp;(r-&gt;rstack[r-&gt;ridx]);
<a name='L444'>    <b>void</b> *obj;
<a name='L445'>    <b>char</b> *p;
<a name='L446'>    <b>long</b> elements;
<a name='L447'>    <b>int</b> root = 0;
<a name='L448'>
<a name='L449'>    <i><font color='green'>/* Set error for nested multi bulks with depth &gt; 7 */</font></i>
<a name='L450'>    <b>if</b> (r-&gt;ridx == 8) <font color='red'>{</font>
<a name='L451'>        <a href='../S/120.html#L186' title='Defined at 186 in deps/hiredis/hiredis.c.'>__redisReaderSetError</a>(r,<a href='../S/121.html#L51' title='Defined at 51 in deps/hiredis/hiredis.h.'>REDIS_ERR_PROTOCOL</a>,
<a name='L452'>            "No support for nested multi bulk replies with depth &gt; 7");
<a name='L453'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L454'>    <font color='red'>}</font>
<a name='L455'>
<a name='L456'>    <b>if</b> ((p = <a href='../S/120.html#L315' title='Defined at 315 in deps/hiredis/hiredis.c.'>readLine</a>(r,NULL)) != NULL) <font color='red'>{</font>
<a name='L457'>        elements = <a href='../S/120.html#L288' title='Defined at 288 in deps/hiredis/hiredis.c.'>readLongLong</a>(p);
<a name='L458'>        root = (r-&gt;ridx == 0);
<a name='L459'>
<a name='L460'>        <b>if</b> (elements == -1) <font color='red'>{</font>
<a name='L461'>            <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createNil)
<a name='L462'>                obj = r-&gt;fn-&gt;createNil(cur);
<a name='L463'>            <b>else</b>
<a name='L464'>                obj = (<b>void</b>*)<a href='../S/121.html#L85' title='Defined at 85 in deps/hiredis/hiredis.h.'>REDIS_REPLY_NIL</a>;
<a name='L465'>
<a name='L466'>            <b>if</b> (obj == NULL) <font color='red'>{</font>
<a name='L467'>                <a href='../S/120.html#L245' title='Defined at 245 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorOOM</a>(r);
<a name='L468'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L469'>            <font color='red'>}</font>
<a name='L470'>
<a name='L471'>            <a href='../S/120.html#L330' title='Defined at 330 in deps/hiredis/hiredis.c.'>moveToNextTask</a>(r);
<a name='L472'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L473'>            <b>if</b> (r-&gt;fn &amp;&amp; r-&gt;fn-&gt;createArray)
<a name='L474'>                obj = r-&gt;fn-&gt;createArray(cur,elements);
<a name='L475'>            <b>else</b>
<a name='L476'>                obj = (<b>void</b>*)<a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>;
<a name='L477'>
<a name='L478'>            <b>if</b> (obj == NULL) <font color='red'>{</font>
<a name='L479'>                <a href='../S/120.html#L245' title='Defined at 245 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorOOM</a>(r);
<a name='L480'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L481'>            <font color='red'>}</font>
<a name='L482'>
<a name='L483'>            <i><font color='green'>/* Modify task stack when there are more than 0 elements. */</font></i>
<a name='L484'>            <b>if</b> (elements &gt; 0) <font color='red'>{</font>
<a name='L485'>                cur-&gt;elements = elements;
<a name='L486'>                cur-&gt;obj = obj;
<a name='L487'>                r-&gt;ridx++;
<a name='L488'>                r-&gt;rstack[r-&gt;ridx].type = -1;
<a name='L489'>                r-&gt;rstack[r-&gt;ridx].elements = -1;
<a name='L490'>                r-&gt;rstack[r-&gt;ridx].idx = 0;
<a name='L491'>                r-&gt;rstack[r-&gt;ridx].obj = NULL;
<a name='L492'>                r-&gt;rstack[r-&gt;ridx].parent = cur;
<a name='L493'>                r-&gt;rstack[r-&gt;ridx].privdata = r-&gt;privdata;
<a name='L494'>            <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L495'>                <a href='../S/120.html#L330' title='Defined at 330 in deps/hiredis/hiredis.c.'>moveToNextTask</a>(r);
<a name='L496'>            <font color='red'>}</font>
<a name='L497'>        <font color='red'>}</font>
<a name='L498'>
<a name='L499'>        <i><font color='green'>/* Set reply if this is the root object. */</font></i>
<a name='L500'>        <b>if</b> (root) r-&gt;reply = obj;
<a name='L501'>        <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L502'>    <font color='red'>}</font>
<a name='L503'>
<a name='L504'>    <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L505'><font color='red'>}</font>
<a name='L506'>
<a name='L507'><b>static</b> <b>int</b> <a href='../S/120.html#L643' title='Refered from 643 in deps/hiredis/hiredis.c.'>processItem</a>(redisReader *r) <font color='red'>{</font>
<a name='L508'>    <a href='../D/3849.html' title='Multiple defined in 2 places.'>redisReadTask</a> *cur = &amp;(r-&gt;rstack[r-&gt;ridx]);
<a name='L509'>    <b>char</b> *p;
<a name='L510'>
<a name='L511'>    <i><font color='green'>/* check if we need to read type */</font></i>
<a name='L512'>    <b>if</b> (cur-&gt;type &lt; 0) <font color='red'>{</font>
<a name='L513'>        <b>if</b> ((p = <a href='../D/3731.html' title='Multiple defined in 3 places.'>readBytes</a>(r,1)) != NULL) <font color='red'>{</font>
<a name='L514'>            <b>switch</b> (p[0]) <font color='red'>{</font>
<a name='L515'>            <b>case</b> '-':
<a name='L516'>                cur-&gt;type = <a href='../S/121.html#L87' title='Defined at 87 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ERROR</a>;
<a name='L517'>                <b>break</b>;
<a name='L518'>            <b>case</b> '+':
<a name='L519'>                cur-&gt;type = <a href='../S/121.html#L86' title='Defined at 86 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STATUS</a>;
<a name='L520'>                <b>break</b>;
<a name='L521'>            <b>case</b> ':':
<a name='L522'>                cur-&gt;type = <a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>;
<a name='L523'>                <b>break</b>;
<a name='L524'>            <b>case</b> '$':
<a name='L525'>                cur-&gt;type = <a href='../S/121.html#L82' title='Defined at 82 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STRING</a>;
<a name='L526'>                <b>break</b>;
<a name='L527'>            <b>case</b> '*':
<a name='L528'>                cur-&gt;type = <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>;
<a name='L529'>                <b>break</b>;
<a name='L530'>            <b>default</b>:
<a name='L531'>                <a href='../S/120.html#L236' title='Defined at 236 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorProtocolByte</a>(r,*p);
<a name='L532'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L533'>            <font color='red'>}</font>
<a name='L534'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L535'>            <i><font color='green'>/* could not consume 1 byte */</font></i>
<a name='L536'>            <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L537'>        <font color='red'>}</font>
<a name='L538'>    <font color='red'>}</font>
<a name='L539'>
<a name='L540'>    <i><font color='green'>/* process typed item */</font></i>
<a name='L541'>    <b>switch</b>(cur-&gt;type) <font color='red'>{</font>
<a name='L542'>    <b>case</b> <a href='../S/121.html#L87' title='Defined at 87 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ERROR</a>:
<a name='L543'>    <b>case</b> <a href='../S/121.html#L86' title='Defined at 86 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STATUS</a>:
<a name='L544'>    <b>case</b> <a href='../S/121.html#L84' title='Defined at 84 in deps/hiredis/hiredis.h.'>REDIS_REPLY_INTEGER</a>:
<a name='L545'>        <b>return</b> <a href='../S/120.html#L355' title='Defined at 355 in deps/hiredis/hiredis.c.'>processLineItem</a>(r);
<a name='L546'>    <b>case</b> <a href='../S/121.html#L82' title='Defined at 82 in deps/hiredis/hiredis.h.'>REDIS_REPLY_STRING</a>:
<a name='L547'>        <b>return</b> <a href='../S/120.html#L389' title='Defined at 389 in deps/hiredis/hiredis.c.'>processBulkItem</a>(r);
<a name='L548'>    <b>case</b> <a href='../S/121.html#L83' title='Defined at 83 in deps/hiredis/hiredis.h.'>REDIS_REPLY_ARRAY</a>:
<a name='L549'>        <b>return</b> <a href='../S/120.html#L442' title='Defined at 442 in deps/hiredis/hiredis.c.'>processMultiBulkItem</a>(r);
<a name='L550'>    <b>default</b>:
<a name='L551'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(NULL);
<a name='L552'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>; <i><font color='green'>/* Avoid warning. */</font></i>
<a name='L553'>    <font color='red'>}</font>
<a name='L554'><font color='red'>}</font>
<a name='L555'>
<a name='L556'><a href='../D/3850.html' title='Multiple defined in 2 places.'>redisReader</a> *<a href='../R/3488.html' title='Multiple refered from 11 places.'>redisReaderCreate</a>(<b>void</b>) <font color='red'>{</font>
<a name='L557'>    <a href='../D/3850.html' title='Multiple defined in 2 places.'>redisReader</a> *r;
<a name='L558'>
<a name='L559'>    r = <a href='../D/1797.html' title='Multiple defined in 2 places.'>calloc</a>(<b>sizeof</b>(<a href='../D/3850.html' title='Multiple defined in 2 places.'>redisReader</a>),1);
<a name='L560'>    <b>if</b> (r == NULL)
<a name='L561'>        <b>return</b> NULL;
<a name='L562'>
<a name='L563'>    r-&gt;err = 0;
<a name='L564'>    r-&gt;errstr[0] = '\0';
<a name='L565'>    r-&gt;fn = &amp;defaultFunctions;
<a name='L566'>    r-&gt;buf = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L567'>    r-&gt;maxbuf = <a href='../S/121.html#L89' title='Defined at 89 in deps/hiredis/hiredis.h.'>REDIS_READER_MAX_BUF</a>;
<a name='L568'>    <b>if</b> (r-&gt;buf == NULL) <font color='red'>{</font>
<a name='L569'>        <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(r);
<a name='L570'>        <b>return</b> NULL;
<a name='L571'>    <font color='red'>}</font>
<a name='L572'>
<a name='L573'>    r-&gt;ridx = -1;
<a name='L574'>    <b>return</b> r;
<a name='L575'><font color='red'>}</font>
<a name='L576'>
<a name='L577'><b>void</b> <a href='../R/3490.html' title='Multiple refered from 11 places.'>redisReaderFree</a>(redisReader *r) <font color='red'>{</font>
<a name='L578'>    <b>if</b> (r-&gt;reply != NULL &amp;&amp; r-&gt;fn &amp;&amp; r-&gt;fn-&gt;freeObject)
<a name='L579'>        r-&gt;fn-&gt;freeObject(r-&gt;reply);
<a name='L580'>    <b>if</b> (r-&gt;buf != NULL)
<a name='L581'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(r-&gt;buf);
<a name='L582'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(r);
<a name='L583'><font color='red'>}</font>
<a name='L584'>
<a name='L585'><b>int</b> <a href='../R/3489.html' title='Multiple refered from 17 places.'>redisReaderFeed</a>(redisReader *r, <b>const</b> <b>char</b> *buf, size_t len) <font color='red'>{</font>
<a name='L586'>    <a href='../D/3987.html' title='Multiple defined in 2 places.'>sds</a> newbuf;
<a name='L587'>
<a name='L588'>    <i><font color='green'>/* Return early when this reader is in an erroneous state. */</font></i>
<a name='L589'>    <b>if</b> (r-&gt;err)
<a name='L590'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L591'>
<a name='L592'>    <i><font color='green'>/* Copy the provided buffer. */</font></i>
<a name='L593'>    <b>if</b> (buf != NULL &amp;&amp; len &gt;= 1) <font color='red'>{</font>
<a name='L594'>        <i><font color='green'>/* Destroy internal buffer when it is empty and is quite large. */</font></i>
<a name='L595'>        <b>if</b> (r-&gt;len == 0 &amp;&amp; r-&gt;maxbuf != 0 &amp;&amp; <a href='../D/3993.html' title='Multiple defined in 2 places.'>sdsavail</a>(r-&gt;buf) &gt; r-&gt;maxbuf) <font color='red'>{</font>
<a name='L596'>            <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(r-&gt;buf);
<a name='L597'>            r-&gt;buf = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L598'>            r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = 0;
<a name='L599'>
<a name='L600'>            <i><font color='green'>/* r-&gt;buf should not be NULL since we just free'd a larger one. */</font></i>
<a name='L601'>            <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(r-&gt;buf != NULL);
<a name='L602'>        <font color='red'>}</font>
<a name='L603'>
<a name='L604'>        newbuf = <a href='../D/3995.html' title='Multiple defined in 2 places.'>sdscatlen</a>(r-&gt;buf,buf,len);
<a name='L605'>        <b>if</b> (newbuf == NULL) <font color='red'>{</font>
<a name='L606'>            <a href='../S/120.html#L245' title='Defined at 245 in deps/hiredis/hiredis.c.'>__redisReaderSetErrorOOM</a>(r);
<a name='L607'>            <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L608'>        <font color='red'>}</font>
<a name='L609'>
<a name='L610'>        r-&gt;buf = newbuf;
<a name='L611'>        r-&gt;len = <a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(r-&gt;buf);
<a name='L612'>    <font color='red'>}</font>
<a name='L613'>
<a name='L614'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L615'><font color='red'>}</font>
<a name='L616'>
<a name='L617'><b>int</b> <a href='../R/3491.html' title='Multiple refered from 13 places.'>redisReaderGetReply</a>(redisReader *r, <b>void</b> **reply) <font color='red'>{</font>
<a name='L618'>    <i><font color='green'>/* Default target pointer to NULL. */</font></i>
<a name='L619'>    <b>if</b> (reply != NULL)
<a name='L620'>        *reply = NULL;
<a name='L621'>
<a name='L622'>    <i><font color='green'>/* Return early when this reader is in an erroneous state. */</font></i>
<a name='L623'>    <b>if</b> (r-&gt;err)
<a name='L624'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L625'>
<a name='L626'>    <i><font color='green'>/* When the buffer is empty, there will never be a reply. */</font></i>
<a name='L627'>    <b>if</b> (r-&gt;len == 0)
<a name='L628'>        <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L629'>
<a name='L630'>    <i><font color='green'>/* Set first item to process when the stack is empty. */</font></i>
<a name='L631'>    <b>if</b> (r-&gt;ridx == -1) <font color='red'>{</font>
<a name='L632'>        r-&gt;rstack[0].type = -1;
<a name='L633'>        r-&gt;rstack[0].elements = -1;
<a name='L634'>        r-&gt;rstack[0].idx = -1;
<a name='L635'>        r-&gt;rstack[0].obj = NULL;
<a name='L636'>        r-&gt;rstack[0].parent = NULL;
<a name='L637'>        r-&gt;rstack[0].privdata = r-&gt;privdata;
<a name='L638'>        r-&gt;ridx = 0;
<a name='L639'>    <font color='red'>}</font>
<a name='L640'>
<a name='L641'>    <i><font color='green'>/* Process items in reply. */</font></i>
<a name='L642'>    <b>while</b> (r-&gt;ridx &gt;= 0)
<a name='L643'>        <b>if</b> (<a href='../S/120.html#L507' title='Defined at 507 in deps/hiredis/hiredis.c.'>processItem</a>(r) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>)
<a name='L644'>            <b>break</b>;
<a name='L645'>
<a name='L646'>    <i><font color='green'>/* Return ASAP when an error occurred. */</font></i>
<a name='L647'>    <b>if</b> (r-&gt;err)
<a name='L648'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L649'>
<a name='L650'>    <i><font color='green'>/* Discard part of the buffer when we've consumed at least 1k, to avoid</font></i>
<a name='L651'><i><font color='green'>     * doing unnecessary calls to memmove() in sds.c. */</font></i>
<a name='L652'>    <b>if</b> (r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> &gt;= 1024) <font color='red'>{</font>
<a name='L653'>        r-&gt;buf = <a href='../D/4015.html' title='Multiple defined in 2 places.'>sdsrange</a>(r-&gt;buf,r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>,-1);
<a name='L654'>        r-&gt;<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = 0;
<a name='L655'>        r-&gt;len = <a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(r-&gt;buf);
<a name='L656'>    <font color='red'>}</font>
<a name='L657'>
<a name='L658'>    <i><font color='green'>/* Emit a reply when there is one. */</font></i>
<a name='L659'>    <b>if</b> (r-&gt;ridx == -1) <font color='red'>{</font>
<a name='L660'>        <b>if</b> (reply != NULL)
<a name='L661'>            *reply = r-&gt;reply;
<a name='L662'>        r-&gt;reply = NULL;
<a name='L663'>    <font color='red'>}</font>
<a name='L664'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L665'><font color='red'>}</font>
<a name='L666'>
<a name='L667'><i><font color='green'>/* Calculate the number of bytes needed to represent an integer as string. */</font></i>
<a name='L668'><b>static</b> <b>int</b> <a href='../R/2214.html' title='Multiple refered from 3 places.'>intlen</a>(<b>int</b> i) <font color='red'>{</font>
<a name='L669'>    <b>int</b> len = 0;
<a name='L670'>    <b>if</b> (i &lt; 0) <font color='red'>{</font>
<a name='L671'>        len++;
<a name='L672'>        i = -i;
<a name='L673'>    <font color='red'>}</font>
<a name='L674'>    <b>do</b> <font color='red'>{</font>
<a name='L675'>        len++;
<a name='L676'>        i /= 10;
<a name='L677'>    <font color='red'>}</font> <b>while</b>(i);
<a name='L678'>    <b>return</b> len;
<a name='L679'><font color='red'>}</font>
<a name='L680'>
<a name='L681'><i><font color='green'>/* Helper that calculates the bulk length given a certain string length. */</font></i>
<a name='L682'><b>static</b> size_t <a href='../R/1507.html' title='Multiple refered from 23 places.'>bulklen</a>(size_t len) <font color='red'>{</font>
<a name='L683'>    <b>return</b> 1+<a href='../S/120.html#L668' title='Defined at 668 in deps/hiredis/hiredis.c.'>intlen</a>(len)+2+len+2;
<a name='L684'><font color='red'>}</font>
<a name='L685'>
<a name='L686'><b>int</b> <a href='../R/3509.html' title='Multiple refered from 4 places.'>redisvFormatCommand</a>(<b>char</b> **target, <b>const</b> <b>char</b> *format, va_list ap) <font color='red'>{</font>
<a name='L687'>    <b>const</b> <b>char</b> *c = format;
<a name='L688'>    <b>char</b> *cmd = NULL; <i><font color='green'>/* final command */</font></i>
<a name='L689'>    <b>int</b> <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>; <i><font color='green'>/* position in final command */</font></i>
<a name='L690'>    <a href='../D/3987.html' title='Multiple defined in 2 places.'>sds</a> curarg, newarg; <i><font color='green'>/* current argument */</font></i>
<a name='L691'>    <b>int</b> touched = 0; <i><font color='green'>/* was the current argument touched? */</font></i>
<a name='L692'>    <b>char</b> **curargv = NULL, **newargv = NULL;
<a name='L693'>    <b>int</b> argc = 0;
<a name='L694'>    <b>int</b> totlen = 0;
<a name='L695'>    <b>int</b> j;
<a name='L696'>
<a name='L697'>    <i><font color='green'>/* Abort if there is not target to set */</font></i>
<a name='L698'>    <b>if</b> (target == NULL)
<a name='L699'>        <b>return</b> -1;
<a name='L700'>
<a name='L701'>    <i><font color='green'>/* Build the command string accordingly to protocol */</font></i>
<a name='L702'>    curarg = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L703'>    <b>if</b> (curarg == NULL)
<a name='L704'>        <b>return</b> -1;
<a name='L705'>
<a name='L706'>    <b>while</b>(*c != '\0') <font color='red'>{</font>
<a name='L707'>        <b>if</b> (*c != '%' || c[1] == '\0') <font color='red'>{</font>
<a name='L708'>            <b>if</b> (*c == ' ') <font color='red'>{</font>
<a name='L709'>                <b>if</b> (touched) <font color='red'>{</font>
<a name='L710'>                    newargv = <a href='../D/3747.html' title='Multiple defined in 2 places.'>realloc</a>(curargv,<b>sizeof</b>(<b>char</b>*)*(argc+1));
<a name='L711'>                    <b>if</b> (newargv == NULL) <b>goto</b> err;
<a name='L712'>                    curargv = newargv;
<a name='L713'>                    curargv[argc++] = curarg;
<a name='L714'>                    totlen += <a href='../S/120.html#L682' title='Defined at 682 in deps/hiredis/hiredis.c.'>bulklen</a>(<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(curarg));
<a name='L715'>
<a name='L716'>                    <i><font color='green'>/* curarg is put in argv so it can be overwritten. */</font></i>
<a name='L717'>                    curarg = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L718'>                    <b>if</b> (curarg == NULL) <b>goto</b> err;
<a name='L719'>                    touched = 0;
<a name='L720'>                <font color='red'>}</font>
<a name='L721'>            <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L722'>                newarg = <a href='../D/3995.html' title='Multiple defined in 2 places.'>sdscatlen</a>(curarg,c,1);
<a name='L723'>                <b>if</b> (newarg == NULL) <b>goto</b> err;
<a name='L724'>                curarg = newarg;
<a name='L725'>                touched = 1;
<a name='L726'>            <font color='red'>}</font>
<a name='L727'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L728'>            <b>char</b> *arg;
<a name='L729'>            size_t size;
<a name='L730'>
<a name='L731'>            <i><font color='green'>/* Set newarg so it can be checked even if it is not touched. */</font></i>
<a name='L732'>            newarg = curarg;
<a name='L733'>
<a name='L734'>            <b>switch</b>(c[1]) <font color='red'>{</font>
<a name='L735'>            <b>case</b> 's':
<a name='L736'>                arg = va_arg(ap,<b>char</b>*);
<a name='L737'>                size = strlen(arg);
<a name='L738'>                <b>if</b> (size &gt; 0)
<a name='L739'>                    newarg = <a href='../D/3995.html' title='Multiple defined in 2 places.'>sdscatlen</a>(curarg,arg,size);
<a name='L740'>                <b>break</b>;
<a name='L741'>            <b>case</b> 'b':
<a name='L742'>                arg = va_arg(ap,<b>char</b>*);
<a name='L743'>                size = va_arg(ap,size_t);
<a name='L744'>                <b>if</b> (size &gt; 0)
<a name='L745'>                    newarg = <a href='../D/3995.html' title='Multiple defined in 2 places.'>sdscatlen</a>(curarg,arg,size);
<a name='L746'>                <b>break</b>;
<a name='L747'>            <b>case</b> '%':
<a name='L748'>                newarg = <a href='../D/3994.html' title='Multiple defined in 2 places.'>sdscat</a>(curarg,"%");
<a name='L749'>                <b>break</b>;
<a name='L750'>            <b>default</b>:
<a name='L751'>                <i><font color='green'>/* Try to detect printf format */</font></i>
<a name='L752'>                <font color='red'>{</font>
<a name='L753'>                    <b>static</b> <b>const</b> <b>char</b> intfmts[] = "diouxX";
<a name='L754'>                    <b>char</b> _format[16];
<a name='L755'>                    <b>const</b> <b>char</b> *_p = c+1;
<a name='L756'>                    size_t _l = 0;
<a name='L757'>                    va_list _cpy;
<a name='L758'>
<a name='L759'>                    <i><font color='green'>/* Flags */</font></i>
<a name='L760'>                    <b>if</b> (*_p != '\0' &amp;&amp; *_p == '#') _p++;
<a name='L761'>                    <b>if</b> (*_p != '\0' &amp;&amp; *_p == '0') _p++;
<a name='L762'>                    <b>if</b> (*_p != '\0' &amp;&amp; *_p == '-') _p++;
<a name='L763'>                    <b>if</b> (*_p != '\0' &amp;&amp; *_p == ' ') _p++;
<a name='L764'>                    <b>if</b> (*_p != '\0' &amp;&amp; *_p == '+') _p++;
<a name='L765'>
<a name='L766'>                    <i><font color='green'>/* Field width */</font></i>
<a name='L767'>                    <b>while</b> (*_p != '\0' &amp;&amp; isdigit(*_p)) _p++;
<a name='L768'>
<a name='L769'>                    <i><font color='green'>/* Precision */</font></i>
<a name='L770'>                    <b>if</b> (*_p == '.') <font color='red'>{</font>
<a name='L771'>                        _p++;
<a name='L772'>                        <b>while</b> (*_p != '\0' &amp;&amp; isdigit(*_p)) _p++;
<a name='L773'>                    <font color='red'>}</font>
<a name='L774'>
<a name='L775'>                    <i><font color='green'>/* Copy va_list before consuming with va_arg */</font></i>
<a name='L776'>                    va_copy(_cpy,ap);
<a name='L777'>
<a name='L778'>                    <i><font color='green'>/* Integer conversion (without modifiers) */</font></i>
<a name='L779'>                    <b>if</b> (strchr(intfmts,*_p) != NULL) <font color='red'>{</font>
<a name='L780'>                        va_arg(ap,<b>int</b>);
<a name='L781'>                        <b>goto</b> fmt_valid;
<a name='L782'>                    <font color='red'>}</font>
<a name='L783'>
<a name='L784'>                    <i><font color='green'>/* Double conversion (without modifiers) */</font></i>
<a name='L785'>                    <b>if</b> (strchr("eEfFgGaA",*_p) != NULL) <font color='red'>{</font>
<a name='L786'>                        va_arg(ap,<b>double</b>);
<a name='L787'>                        <b>goto</b> fmt_valid;
<a name='L788'>                    <font color='red'>}</font>
<a name='L789'>
<a name='L790'>                    <i><font color='green'>/* Size: char */</font></i>
<a name='L791'>                    <b>if</b> (_p[0] == 'h' &amp;&amp; _p[1] == 'h') <font color='red'>{</font>
<a name='L792'>                        _p += 2;
<a name='L793'>                        <b>if</b> (*_p != '\0' &amp;&amp; strchr(intfmts,*_p) != NULL) <font color='red'>{</font>
<a name='L794'>                            va_arg(ap,<b>int</b>); <i><font color='green'>/* char gets promoted to int */</font></i>
<a name='L795'>                            <b>goto</b> fmt_valid;
<a name='L796'>                        <font color='red'>}</font>
<a name='L797'>                        <b>goto</b> fmt_invalid;
<a name='L798'>                    <font color='red'>}</font>
<a name='L799'>
<a name='L800'>                    <i><font color='green'>/* Size: short */</font></i>
<a name='L801'>                    <b>if</b> (_p[0] == 'h') <font color='red'>{</font>
<a name='L802'>                        _p += 1;
<a name='L803'>                        <b>if</b> (*_p != '\0' &amp;&amp; strchr(intfmts,*_p) != NULL) <font color='red'>{</font>
<a name='L804'>                            va_arg(ap,<b>int</b>); <i><font color='green'>/* short gets promoted to int */</font></i>
<a name='L805'>                            <b>goto</b> fmt_valid;
<a name='L806'>                        <font color='red'>}</font>
<a name='L807'>                        <b>goto</b> fmt_invalid;
<a name='L808'>                    <font color='red'>}</font>
<a name='L809'>
<a name='L810'>                    <i><font color='green'>/* Size: long long */</font></i>
<a name='L811'>                    <b>if</b> (_p[0] == 'l' &amp;&amp; _p[1] == 'l') <font color='red'>{</font>
<a name='L812'>                        _p += 2;
<a name='L813'>                        <b>if</b> (*_p != '\0' &amp;&amp; strchr(intfmts,*_p) != NULL) <font color='red'>{</font>
<a name='L814'>                            va_arg(ap,<b>long</b> <b>long</b>);
<a name='L815'>                            <b>goto</b> fmt_valid;
<a name='L816'>                        <font color='red'>}</font>
<a name='L817'>                        <b>goto</b> fmt_invalid;
<a name='L818'>                    <font color='red'>}</font>
<a name='L819'>
<a name='L820'>                    <i><font color='green'>/* Size: long */</font></i>
<a name='L821'>                    <b>if</b> (_p[0] == 'l') <font color='red'>{</font>
<a name='L822'>                        _p += 1;
<a name='L823'>                        <b>if</b> (*_p != '\0' &amp;&amp; strchr(intfmts,*_p) != NULL) <font color='red'>{</font>
<a name='L824'>                            va_arg(ap,<b>long</b>);
<a name='L825'>                            <b>goto</b> fmt_valid;
<a name='L826'>                        <font color='red'>}</font>
<a name='L827'>                        <b>goto</b> fmt_invalid;
<a name='L828'>                    <font color='red'>}</font>
<a name='L829'>
<a name='L830'>                fmt_invalid:
<a name='L831'>                    va_end(_cpy);
<a name='L832'>                    <b>goto</b> err;
<a name='L833'>
<a name='L834'>                fmt_valid:
<a name='L835'>                    _l = (_p+1)-c;
<a name='L836'>                    <b>if</b> (_l &lt; <b>sizeof</b>(_format)-2) <font color='red'>{</font>
<a name='L837'>                        memcpy(_format,c,_l);
<a name='L838'>                        _format[_l] = '\0';
<a name='L839'>                        newarg = <a href='../D/3999.html' title='Multiple defined in 2 places.'>sdscatvprintf</a>(curarg,_format,_cpy);
<a name='L840'>
<a name='L841'>                        <i><font color='green'>/* Update current position (note: outer blocks</font></i>
<a name='L842'><i><font color='green'>                         * increment c twice so compensate here) */</font></i>
<a name='L843'>                        c = _p-1;
<a name='L844'>                    <font color='red'>}</font>
<a name='L845'>
<a name='L846'>                    va_end(_cpy);
<a name='L847'>                    <b>break</b>;
<a name='L848'>                <font color='red'>}</font>
<a name='L849'>            <font color='red'>}</font>
<a name='L850'>
<a name='L851'>            <b>if</b> (newarg == NULL) <b>goto</b> err;
<a name='L852'>            curarg = newarg;
<a name='L853'>
<a name='L854'>            touched = 1;
<a name='L855'>            c++;
<a name='L856'>        <font color='red'>}</font>
<a name='L857'>        c++;
<a name='L858'>    <font color='red'>}</font>
<a name='L859'>
<a name='L860'>    <i><font color='green'>/* Add the last argument if needed */</font></i>
<a name='L861'>    <b>if</b> (touched) <font color='red'>{</font>
<a name='L862'>        newargv = <a href='../D/3747.html' title='Multiple defined in 2 places.'>realloc</a>(curargv,<b>sizeof</b>(<b>char</b>*)*(argc+1));
<a name='L863'>        <b>if</b> (newargv == NULL) <b>goto</b> err;
<a name='L864'>        curargv = newargv;
<a name='L865'>        curargv[argc++] = curarg;
<a name='L866'>        totlen += <a href='../S/120.html#L682' title='Defined at 682 in deps/hiredis/hiredis.c.'>bulklen</a>(<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(curarg));
<a name='L867'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L868'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(curarg);
<a name='L869'>    <font color='red'>}</font>
<a name='L870'>
<a name='L871'>    <i><font color='green'>/* Clear curarg because it was put in curargv or was free'd. */</font></i>
<a name='L872'>    curarg = NULL;
<a name='L873'>
<a name='L874'>    <i><font color='green'>/* Add bytes needed to hold multi bulk count */</font></i>
<a name='L875'>    totlen += 1+<a href='../S/120.html#L668' title='Defined at 668 in deps/hiredis/hiredis.c.'>intlen</a>(argc)+2;
<a name='L876'>
<a name='L877'>    <i><font color='green'>/* Build the command at protocol level */</font></i>
<a name='L878'>    cmd = <a href='../D/3259.html' title='Multiple defined in 2 places.'>malloc</a>(totlen+1);
<a name='L879'>    <b>if</b> (cmd == NULL) <b>goto</b> err;
<a name='L880'>
<a name='L881'>    <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = sprintf(cmd,"*%d\r\n",argc);
<a name='L882'>    <b>for</b> (j = 0; j &lt; argc; j++) <font color='red'>{</font>
<a name='L883'>        <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += sprintf(cmd+<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>,"$%zu\r\n",<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(curargv[j]));
<a name='L884'>        memcpy(cmd+<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>,curargv[j],<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(curargv[j]));
<a name='L885'>        <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += <a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(curargv[j]);
<a name='L886'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(curargv[j]);
<a name='L887'>        cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++] = '\r';
<a name='L888'>        cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++] = '\n';
<a name='L889'>    <font color='red'>}</font>
<a name='L890'>    <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> == totlen);
<a name='L891'>    cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>] = '\0';
<a name='L892'>
<a name='L893'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(curargv);
<a name='L894'>    *target = cmd;
<a name='L895'>    <b>return</b> totlen;
<a name='L896'>
<a name='L897'>err:
<a name='L898'>    <b>while</b>(argc--)
<a name='L899'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(curargv[argc]);
<a name='L900'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(curargv);
<a name='L901'>
<a name='L902'>    <b>if</b> (curarg != NULL)
<a name='L903'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(curarg);
<a name='L904'>
<a name='L905'>    <i><font color='green'>/* No need to check cmd since it is the last statement that can fail,</font></i>
<a name='L906'><i><font color='green'>     * but do it anyway to be as defensive as possible. */</font></i>
<a name='L907'>    <b>if</b> (cmd != NULL)
<a name='L908'>        <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(cmd);
<a name='L909'>
<a name='L910'>    <b>return</b> -1;
<a name='L911'><font color='red'>}</font>
<a name='L912'>
<a name='L913'><i><font color='green'>/* Format a command according to the Redis protocol. This function</font></i>
<a name='L914'><i><font color='green'> * takes a format similar to printf:</font></i>
<a name='L915'><i><font color='green'> *</font></i>
<a name='L916'><i><font color='green'> * %s represents a C null terminated string you want to interpolate</font></i>
<a name='L917'><i><font color='green'> * %b represents a binary safe string</font></i>
<a name='L918'><i><font color='green'> *</font></i>
<a name='L919'><i><font color='green'> * When using %b you need to provide both the pointer to the string</font></i>
<a name='L920'><i><font color='green'> * and the length in bytes. Examples:</font></i>
<a name='L921'><i><font color='green'> *</font></i>
<a name='L922'><i><font color='green'> * len = redisFormatCommand(target, "GET %s", mykey);</font></i>
<a name='L923'><i><font color='green'> * len = redisFormatCommand(target, "SET %s %b", mykey, myval, myvallen);</font></i>
<a name='L924'><i><font color='green'> */</font></i>
<a name='L925'><b>int</b> <a href='../R/3440.html' title='Multiple refered from 24 places.'>redisFormatCommand</a>(<b>char</b> **target, <b>const</b> <b>char</b> *format, ...) <font color='red'>{</font>
<a name='L926'>    va_list ap;
<a name='L927'>    <b>int</b> len;
<a name='L928'>    va_start(ap,format);
<a name='L929'>    len = <a href='../S/120.html#L686' title='Defined at 686 in deps/hiredis/hiredis.c.'>redisvFormatCommand</a>(target,format,ap);
<a name='L930'>    va_end(ap);
<a name='L931'>    <b>return</b> len;
<a name='L932'><font color='red'>}</font>
<a name='L933'>
<a name='L934'><i><font color='green'>/* Format a command according to the Redis protocol. This function takes the</font></i>
<a name='L935'><i><font color='green'> * number of arguments, an array with arguments and an array with their</font></i>
<a name='L936'><i><font color='green'> * lengths. If the latter is set to NULL, strlen will be used to compute the</font></i>
<a name='L937'><i><font color='green'> * argument lengths.</font></i>
<a name='L938'><i><font color='green'> */</font></i>
<a name='L939'><b>int</b> <a href='../R/3441.html' title='Multiple refered from 7 places.'>redisFormatCommandArgv</a>(<b>char</b> **target, <b>int</b> argc, <b>const</b> <b>char</b> **argv, <b>const</b> size_t *argvlen) <font color='red'>{</font>
<a name='L940'>    <b>char</b> *cmd = NULL; <i><font color='green'>/* final command */</font></i>
<a name='L941'>    <b>int</b> <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>; <i><font color='green'>/* position in final command */</font></i>
<a name='L942'>    size_t len;
<a name='L943'>    <b>int</b> totlen, j;
<a name='L944'>
<a name='L945'>    <i><font color='green'>/* Calculate number of bytes needed for the command */</font></i>
<a name='L946'>    totlen = 1+<a href='../S/120.html#L668' title='Defined at 668 in deps/hiredis/hiredis.c.'>intlen</a>(argc)+2;
<a name='L947'>    <b>for</b> (j = 0; j &lt; argc; j++) <font color='red'>{</font>
<a name='L948'>        len = argvlen ? argvlen[j] : strlen(argv[j]);
<a name='L949'>        totlen += <a href='../S/120.html#L682' title='Defined at 682 in deps/hiredis/hiredis.c.'>bulklen</a>(len);
<a name='L950'>    <font color='red'>}</font>
<a name='L951'>
<a name='L952'>    <i><font color='green'>/* Build the command at protocol level */</font></i>
<a name='L953'>    cmd = <a href='../D/3259.html' title='Multiple defined in 2 places.'>malloc</a>(totlen+1);
<a name='L954'>    <b>if</b> (cmd == NULL)
<a name='L955'>        <b>return</b> -1;
<a name='L956'>
<a name='L957'>    <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> = sprintf(cmd,"*%d\r\n",argc);
<a name='L958'>    <b>for</b> (j = 0; j &lt; argc; j++) <font color='red'>{</font>
<a name='L959'>        len = argvlen ? argvlen[j] : strlen(argv[j]);
<a name='L960'>        <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += sprintf(cmd+<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>,"$%zu\r\n",len);
<a name='L961'>        memcpy(cmd+<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>,argv[j],len);
<a name='L962'>        <a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> += len;
<a name='L963'>        cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++] = '\r';
<a name='L964'>        cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>++] = '\n';
<a name='L965'>    <font color='red'>}</font>
<a name='L966'>    <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a> == totlen);
<a name='L967'>    cmd[<a href='../S/55.html#L107' title='Defined at 107 in src/redis-check-dump.c.'>pos</a>] = '\0';
<a name='L968'>
<a name='L969'>    *target = cmd;
<a name='L970'>    <b>return</b> totlen;
<a name='L971'><font color='red'>}</font>
<a name='L972'>
<a name='L973'><b>void</b> <a href='../R/1145.html' title='Multiple refered from 12 places.'>__redisSetError</a>(redisContext *c, <b>int</b> type, <b>const</b> <b>char</b> *str) <font color='red'>{</font>
<a name='L974'>    size_t len;
<a name='L975'>
<a name='L976'>    c-&gt;err = type;
<a name='L977'>    <b>if</b> (str != NULL) <font color='red'>{</font>
<a name='L978'>        len = strlen(str);
<a name='L979'>        len = len &lt; (<b>sizeof</b>(c-&gt;errstr)-1) ? len : (<b>sizeof</b>(c-&gt;errstr)-1);
<a name='L980'>        memcpy(c-&gt;errstr,str,len);
<a name='L981'>        c-&gt;errstr[len] = '\0';
<a name='L982'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L983'>        <i><font color='green'>/* Only REDIS_ERR_IO may lack a description! */</font></i>
<a name='L984'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(type == <a href='../S/121.html#L49' title='Defined at 49 in deps/hiredis/hiredis.h.'>REDIS_ERR_IO</a>);
<a name='L985'>        strerror_r(errno,c-&gt;errstr,<b>sizeof</b>(c-&gt;errstr));
<a name='L986'>    <font color='red'>}</font>
<a name='L987'><font color='red'>}</font>
<a name='L988'>
<a name='L989'><b>static</b> <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3435.html' title='Multiple refered from 6 places.'>redisContextInit</a>(<b>void</b>) <font color='red'>{</font>
<a name='L990'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c;
<a name='L991'>
<a name='L992'>    c = <a href='../D/1797.html' title='Multiple defined in 2 places.'>calloc</a>(1,<b>sizeof</b>(<a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a>));
<a name='L993'>    <b>if</b> (c == NULL)
<a name='L994'>        <b>return</b> NULL;
<a name='L995'>
<a name='L996'>    c-&gt;err = 0;
<a name='L997'>    c-&gt;errstr[0] = '\0';
<a name='L998'>    c-&gt;obuf = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L999'>    c-&gt;reader = <a href='../S/120.html#L556' title='Defined at 556 in deps/hiredis/hiredis.c.'>redisReaderCreate</a>();
<a name='L1000'>    <b>return</b> c;
<a name='L1001'><font color='red'>}</font>
<a name='L1002'>
<a name='L1003'><b>void</b> <a href='../R/3442.html' title='Multiple refered from 11 places.'>redisFree</a>(redisContext *c) <font color='red'>{</font>
<a name='L1004'>    <b>if</b> (c-&gt;fd &gt; 0)
<a name='L1005'>        close(c-&gt;fd);
<a name='L1006'>    <b>if</b> (c-&gt;obuf != NULL)
<a name='L1007'>        <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(c-&gt;obuf);
<a name='L1008'>    <b>if</b> (c-&gt;reader != NULL)
<a name='L1009'>        <a href='../S/120.html#L577' title='Defined at 577 in deps/hiredis/hiredis.c.'>redisReaderFree</a>(c-&gt;reader);
<a name='L1010'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(c);
<a name='L1011'><font color='red'>}</font>
<a name='L1012'>
<a name='L1013'><i><font color='green'>/* Connect to a Redis instance. On error the field error in the returned</font></i>
<a name='L1014'><i><font color='green'> * context will be set to the return value of the error function.</font></i>
<a name='L1015'><i><font color='green'> * When no set of reply functions is given, the default set will be used. */</font></i>
<a name='L1016'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3426.html' title='Multiple refered from 5 places.'>redisConnect</a>(<b>const</b> <b>char</b> *ip, <b>int</b> port) <font color='red'>{</font>
<a name='L1017'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1018'>    c-&gt;flags |= <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1019'>    <a href='../S/113.html#L207' title='Defined at 207 in deps/hiredis/net.c.'>redisContextConnectTcp</a>(c,ip,port,NULL);
<a name='L1020'>    <b>return</b> c;
<a name='L1021'><font color='red'>}</font>
<a name='L1022'>
<a name='L1023'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3431.html' title='Multiple refered from 2 places.'>redisConnectWithTimeout</a>(<b>const</b> <b>char</b> *ip, <b>int</b> port, <b>struct</b> timeval tv) <font color='red'>{</font>
<a name='L1024'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1025'>    c-&gt;flags |= <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1026'>    <a href='../S/113.html#L207' title='Defined at 207 in deps/hiredis/net.c.'>redisContextConnectTcp</a>(c,ip,port,&amp;tv);
<a name='L1027'>    <b>return</b> c;
<a name='L1028'><font color='red'>}</font>
<a name='L1029'>
<a name='L1030'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3427.html' title='Multiple refered from 3 places.'>redisConnectNonBlock</a>(<b>const</b> <b>char</b> *ip, <b>int</b> port) <font color='red'>{</font>
<a name='L1031'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1032'>    c-&gt;flags &amp;= ~<a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1033'>    <a href='../S/113.html#L207' title='Defined at 207 in deps/hiredis/net.c.'>redisContextConnectTcp</a>(c,ip,port,NULL);
<a name='L1034'>    <b>return</b> c;
<a name='L1035'><font color='red'>}</font>
<a name='L1036'>
<a name='L1037'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3428.html' title='Multiple refered from 4 places.'>redisConnectUnix</a>(<b>const</b> <b>char</b> *path) <font color='red'>{</font>
<a name='L1038'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1039'>    c-&gt;flags |= <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1040'>    <a href='../S/113.html#L263' title='Defined at 263 in deps/hiredis/net.c.'>redisContextConnectUnix</a>(c,path,NULL);
<a name='L1041'>    <b>return</b> c;
<a name='L1042'><font color='red'>}</font>
<a name='L1043'>
<a name='L1044'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../S/121.html#L177' title='Refered from 177 in deps/hiredis/hiredis.h.'>redisConnectUnixWithTimeout</a>(<b>const</b> <b>char</b> *path, <b>struct</b> timeval tv) <font color='red'>{</font>
<a name='L1045'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1046'>    c-&gt;flags |= <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1047'>    <a href='../S/113.html#L263' title='Defined at 263 in deps/hiredis/net.c.'>redisContextConnectUnix</a>(c,path,&amp;tv);
<a name='L1048'>    <b>return</b> c;
<a name='L1049'><font color='red'>}</font>
<a name='L1050'>
<a name='L1051'><a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *<a href='../R/3429.html' title='Multiple refered from 3 places.'>redisConnectUnixNonBlock</a>(<b>const</b> <b>char</b> *path) <font color='red'>{</font>
<a name='L1052'>    <a href='../D/3791.html' title='Multiple defined in 2 places.'>redisContext</a> *c = <a href='../S/120.html#L989' title='Defined at 989 in deps/hiredis/hiredis.c.'>redisContextInit</a>();
<a name='L1053'>    c-&gt;flags &amp;= ~<a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>;
<a name='L1054'>    <a href='../S/113.html#L263' title='Defined at 263 in deps/hiredis/net.c.'>redisContextConnectUnix</a>(c,path,NULL);
<a name='L1055'>    <b>return</b> c;
<a name='L1056'><font color='red'>}</font>
<a name='L1057'>
<a name='L1058'><i><font color='green'>/* Set read/write timeout on a blocking socket. */</font></i>
<a name='L1059'><b>int</b> <a href='../R/3498.html' title='Multiple refered from 2 places.'>redisSetTimeout</a>(redisContext *c, <b>struct</b> timeval tv) <font color='red'>{</font>
<a name='L1060'>    <b>if</b> (c-&gt;flags &amp; <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>)
<a name='L1061'>        <b>return</b> <a href='../S/113.html#L195' title='Defined at 195 in deps/hiredis/net.c.'>redisContextSetTimeout</a>(c,tv);
<a name='L1062'>    <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1063'><font color='red'>}</font>
<a name='L1064'>
<a name='L1065'><i><font color='green'>/* Use this function to handle a read event on the descriptor. It will try</font></i>
<a name='L1066'><i><font color='green'> * and read some bytes from the socket and feed them to the reply parser.</font></i>
<a name='L1067'><i><font color='green'> *</font></i>
<a name='L1068'><i><font color='green'> * After this function is called, you may use redisContextReadReply to</font></i>
<a name='L1069'><i><font color='green'> * see if there is a reply available. */</font></i>
<a name='L1070'><b>int</b> <a href='../R/3417.html' title='Multiple refered from 4 places.'>redisBufferRead</a>(redisContext *c) <font color='red'>{</font>
<a name='L1071'>    <b>char</b> buf[1024*16];
<a name='L1072'>    <b>int</b> nread;
<a name='L1073'>
<a name='L1074'>    <i><font color='green'>/* Return early when the context has seen an error. */</font></i>
<a name='L1075'>    <b>if</b> (c-&gt;err)
<a name='L1076'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1077'>
<a name='L1078'>    nread = read(c-&gt;fd,buf,<b>sizeof</b>(buf));
<a name='L1079'>    <b>if</b> (nread == -1) <font color='red'>{</font>
<a name='L1080'>        <b>if</b> (errno == EAGAIN &amp;&amp; !(c-&gt;flags &amp; <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>)) <font color='red'>{</font>
<a name='L1081'>            <i><font color='green'>/* Try again later */</font></i>
<a name='L1082'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1083'>            <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L49' title='Defined at 49 in deps/hiredis/hiredis.h.'>REDIS_ERR_IO</a>,NULL);
<a name='L1084'>            <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1085'>        <font color='red'>}</font>
<a name='L1086'>    <font color='red'>}</font> <b>else</b> <b>if</b> (nread == 0) <font color='red'>{</font>
<a name='L1087'>        <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L50' title='Defined at 50 in deps/hiredis/hiredis.h.'>REDIS_ERR_EOF</a>,"Server closed the connection");
<a name='L1088'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1089'>    <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1090'>        <b>if</b> (<a href='../S/120.html#L585' title='Defined at 585 in deps/hiredis/hiredis.c.'>redisReaderFeed</a>(c-&gt;reader,buf,nread) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>) <font color='red'>{</font>
<a name='L1091'>            <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,c-&gt;reader-&gt;err,c-&gt;reader-&gt;errstr);
<a name='L1092'>            <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1093'>        <font color='red'>}</font>
<a name='L1094'>    <font color='red'>}</font>
<a name='L1095'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1096'><font color='red'>}</font>
<a name='L1097'>
<a name='L1098'><i><font color='green'>/* Write the output buffer to the socket.</font></i>
<a name='L1099'><i><font color='green'> *</font></i>
<a name='L1100'><i><font color='green'> * Returns REDIS_OK when the buffer is empty, or (a part of) the buffer was</font></i>
<a name='L1101'><i><font color='green'> * succesfully written to the socket. When the buffer is empty after the</font></i>
<a name='L1102'><i><font color='green'> * write operation, "done" is set to 1 (if given).</font></i>
<a name='L1103'><i><font color='green'> *</font></i>
<a name='L1104'><i><font color='green'> * Returns REDIS_ERR if an error occured trying to write and sets</font></i>
<a name='L1105'><i><font color='green'> * c-&gt;errstr to hold the appropriate error string.</font></i>
<a name='L1106'><i><font color='green'> */</font></i>
<a name='L1107'><b>int</b> <a href='../R/3418.html' title='Multiple refered from 3 places.'>redisBufferWrite</a>(redisContext *c, <b>int</b> *done) <font color='red'>{</font>
<a name='L1108'>    <b>int</b> nwritten;
<a name='L1109'>
<a name='L1110'>    <i><font color='green'>/* Return early when the context has seen an error. */</font></i>
<a name='L1111'>    <b>if</b> (c-&gt;err)
<a name='L1112'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1113'>
<a name='L1114'>    <b>if</b> (<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(c-&gt;obuf) &gt; 0) <font color='red'>{</font>
<a name='L1115'>        nwritten = write(c-&gt;fd,c-&gt;obuf,<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(c-&gt;obuf));
<a name='L1116'>        <b>if</b> (nwritten == -1) <font color='red'>{</font>
<a name='L1117'>            <b>if</b> (errno == EAGAIN &amp;&amp; !(c-&gt;flags &amp; <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>)) <font color='red'>{</font>
<a name='L1118'>                <i><font color='green'>/* Try again later */</font></i>
<a name='L1119'>            <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1120'>                <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L49' title='Defined at 49 in deps/hiredis/hiredis.h.'>REDIS_ERR_IO</a>,NULL);
<a name='L1121'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1122'>            <font color='red'>}</font>
<a name='L1123'>        <font color='red'>}</font> <b>else</b> <b>if</b> (nwritten &gt; 0) <font color='red'>{</font>
<a name='L1124'>            <b>if</b> (nwritten == (<b>signed</b>)<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(c-&gt;obuf)) <font color='red'>{</font>
<a name='L1125'>                <a href='../D/4006.html' title='Multiple defined in 2 places.'>sdsfree</a>(c-&gt;obuf);
<a name='L1126'>                c-&gt;obuf = <a href='../D/4005.html' title='Multiple defined in 2 places.'>sdsempty</a>();
<a name='L1127'>            <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1128'>                c-&gt;obuf = <a href='../D/4015.html' title='Multiple defined in 2 places.'>sdsrange</a>(c-&gt;obuf,nwritten,-1);
<a name='L1129'>            <font color='red'>}</font>
<a name='L1130'>        <font color='red'>}</font>
<a name='L1131'>    <font color='red'>}</font>
<a name='L1132'>    <b>if</b> (done != NULL) *done = (<a href='../D/4011.html' title='Multiple defined in 2 places.'>sdslen</a>(c-&gt;obuf) == 0);
<a name='L1133'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1134'><font color='red'>}</font>
<a name='L1135'>
<a name='L1136'><i><font color='green'>/* Internal helper function to try and get a reply from the reader,</font></i>
<a name='L1137'><i><font color='green'> * or set an error in the context otherwise. */</font></i>
<a name='L1138'><b>int</b> <a href='../R/3445.html' title='Multiple refered from 3 places.'>redisGetReplyFromReader</a>(redisContext *c, <b>void</b> **reply) <font color='red'>{</font>
<a name='L1139'>    <b>if</b> (<a href='../S/120.html#L617' title='Defined at 617 in deps/hiredis/hiredis.c.'>redisReaderGetReply</a>(c-&gt;reader,reply) == <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>) <font color='red'>{</font>
<a name='L1140'>        <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,c-&gt;reader-&gt;err,c-&gt;reader-&gt;errstr);
<a name='L1141'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1142'>    <font color='red'>}</font>
<a name='L1143'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1144'><font color='red'>}</font>
<a name='L1145'>
<a name='L1146'><b>int</b> <a href='../R/3444.html' title='Multiple refered from 9 places.'>redisGetReply</a>(redisContext *c, <b>void</b> **reply) <font color='red'>{</font>
<a name='L1147'>    <b>int</b> wdone = 0;
<a name='L1148'>    <b>void</b> *aux = NULL;
<a name='L1149'>
<a name='L1150'>    <i><font color='green'>/* Try to read pending replies */</font></i>
<a name='L1151'>    <b>if</b> (<a href='../S/120.html#L1138' title='Defined at 1138 in deps/hiredis/hiredis.c.'>redisGetReplyFromReader</a>(c,&amp;aux) == <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>)
<a name='L1152'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1153'>
<a name='L1154'>    <i><font color='green'>/* For the blocking context, flush output buffer and read reply */</font></i>
<a name='L1155'>    <b>if</b> (aux == NULL &amp;&amp; c-&gt;flags &amp; <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>) <font color='red'>{</font>
<a name='L1156'>        <i><font color='green'>/* Write until done */</font></i>
<a name='L1157'>        <b>do</b> <font color='red'>{</font>
<a name='L1158'>            <b>if</b> (<a href='../S/120.html#L1107' title='Defined at 1107 in deps/hiredis/hiredis.c.'>redisBufferWrite</a>(c,&amp;wdone) == <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>)
<a name='L1159'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1160'>        <font color='red'>}</font> <b>while</b> (!wdone);
<a name='L1161'>
<a name='L1162'>        <i><font color='green'>/* Read until there is a reply */</font></i>
<a name='L1163'>        <b>do</b> <font color='red'>{</font>
<a name='L1164'>            <b>if</b> (<a href='../S/120.html#L1070' title='Defined at 1070 in deps/hiredis/hiredis.c.'>redisBufferRead</a>(c) == <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>)
<a name='L1165'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1166'>            <b>if</b> (<a href='../S/120.html#L1138' title='Defined at 1138 in deps/hiredis/hiredis.c.'>redisGetReplyFromReader</a>(c,&amp;aux) == <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>)
<a name='L1167'>                <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1168'>        <font color='red'>}</font> <b>while</b> (aux == NULL);
<a name='L1169'>    <font color='red'>}</font>
<a name='L1170'>
<a name='L1171'>    <i><font color='green'>/* Set reply object */</font></i>
<a name='L1172'>    <b>if</b> (reply != NULL) *reply = aux;
<a name='L1173'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1174'><font color='red'>}</font>
<a name='L1175'>
<a name='L1176'>
<a name='L1177'><i><font color='green'>/* Helper function for the redisAppendCommand* family of functions.</font></i>
<a name='L1178'><i><font color='green'> *</font></i>
<a name='L1179'><i><font color='green'> * Write a formatted command to the output buffer. When this family</font></i>
<a name='L1180'><i><font color='green'> * is used, you need to call redisGetReply yourself to retrieve</font></i>
<a name='L1181'><i><font color='green'> * the reply (or replies in pub/sub).</font></i>
<a name='L1182'><i><font color='green'> */</font></i>
<a name='L1183'><b>int</b> <a href='../R/1132.html' title='Multiple refered from 4 places.'>__redisAppendCommand</a>(redisContext *c, <b>char</b> *cmd, size_t len) <font color='red'>{</font>
<a name='L1184'>    <a href='../D/3987.html' title='Multiple defined in 2 places.'>sds</a> newbuf;
<a name='L1185'>
<a name='L1186'>    newbuf = <a href='../D/3995.html' title='Multiple defined in 2 places.'>sdscatlen</a>(c-&gt;obuf,cmd,len);
<a name='L1187'>    <b>if</b> (newbuf == NULL) <font color='red'>{</font>
<a name='L1188'>        <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L52' title='Defined at 52 in deps/hiredis/hiredis.h.'>REDIS_ERR_OOM</a>,"Out of memory");
<a name='L1189'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1190'>    <font color='red'>}</font>
<a name='L1191'>
<a name='L1192'>    c-&gt;obuf = newbuf;
<a name='L1193'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1194'><font color='red'>}</font>
<a name='L1195'>
<a name='L1196'><b>int</b> <a href='../R/3506.html' title='Multiple refered from 3 places.'>redisvAppendCommand</a>(redisContext *c, <b>const</b> <b>char</b> *format, va_list ap) <font color='red'>{</font>
<a name='L1197'>    <b>char</b> *cmd;
<a name='L1198'>    <b>int</b> len;
<a name='L1199'>
<a name='L1200'>    len = <a href='../S/120.html#L686' title='Defined at 686 in deps/hiredis/hiredis.c.'>redisvFormatCommand</a>(&amp;cmd,format,ap);
<a name='L1201'>    <b>if</b> (len == -1) <font color='red'>{</font>
<a name='L1202'>        <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L52' title='Defined at 52 in deps/hiredis/hiredis.h.'>REDIS_ERR_OOM</a>,"Out of memory");
<a name='L1203'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1204'>    <font color='red'>}</font>
<a name='L1205'>
<a name='L1206'>    <b>if</b> (<a href='../S/120.html#L1183' title='Defined at 1183 in deps/hiredis/hiredis.c.'>__redisAppendCommand</a>(c,cmd,len) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>) <font color='red'>{</font>
<a name='L1207'>        <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(cmd);
<a name='L1208'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1209'>    <font color='red'>}</font>
<a name='L1210'>
<a name='L1211'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(cmd);
<a name='L1212'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1213'><font color='red'>}</font>
<a name='L1214'>
<a name='L1215'><b>int</b> <a href='../R/3400.html' title='Multiple refered from 3 places.'>redisAppendCommand</a>(redisContext *c, <b>const</b> <b>char</b> *format, ...) <font color='red'>{</font>
<a name='L1216'>    va_list ap;
<a name='L1217'>    <b>int</b> ret;
<a name='L1218'>
<a name='L1219'>    va_start(ap,format);
<a name='L1220'>    ret = <a href='../S/120.html#L1196' title='Defined at 1196 in deps/hiredis/hiredis.c.'>redisvAppendCommand</a>(c,format,ap);
<a name='L1221'>    va_end(ap);
<a name='L1222'>    <b>return</b> ret;
<a name='L1223'><font color='red'>}</font>
<a name='L1224'>
<a name='L1225'><b>int</b> <a href='../R/3401.html' title='Multiple refered from 3 places.'>redisAppendCommandArgv</a>(redisContext *c, <b>int</b> argc, <b>const</b> <b>char</b> **argv, <b>const</b> size_t *argvlen) <font color='red'>{</font>
<a name='L1226'>    <b>char</b> *cmd;
<a name='L1227'>    <b>int</b> len;
<a name='L1228'>
<a name='L1229'>    len = <a href='../S/120.html#L939' title='Defined at 939 in deps/hiredis/hiredis.c.'>redisFormatCommandArgv</a>(&amp;cmd,argc,argv,argvlen);
<a name='L1230'>    <b>if</b> (len == -1) <font color='red'>{</font>
<a name='L1231'>        <a href='../S/120.html#L973' title='Defined at 973 in deps/hiredis/hiredis.c.'>__redisSetError</a>(c,<a href='../S/121.html#L52' title='Defined at 52 in deps/hiredis/hiredis.h.'>REDIS_ERR_OOM</a>,"Out of memory");
<a name='L1232'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1233'>    <font color='red'>}</font>
<a name='L1234'>
<a name='L1235'>    <b>if</b> (<a href='../S/120.html#L1183' title='Defined at 1183 in deps/hiredis/hiredis.c.'>__redisAppendCommand</a>(c,cmd,len) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>) <font color='red'>{</font>
<a name='L1236'>        <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(cmd);
<a name='L1237'>        <b>return</b> <a href='../D/794.html' title='Multiple defined in 2 places.'>REDIS_ERR</a>;
<a name='L1238'>    <font color='red'>}</font>
<a name='L1239'>
<a name='L1240'>    <a href='../D/2271.html' title='Multiple defined in 2 places.'>free</a>(cmd);
<a name='L1241'>    <b>return</b> <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>;
<a name='L1242'><font color='red'>}</font>
<a name='L1243'>
<a name='L1244'><i><font color='green'>/* Helper function for the redisCommand* family of functions.</font></i>
<a name='L1245'><i><font color='green'> *</font></i>
<a name='L1246'><i><font color='green'> * Write a formatted command to the output buffer. If the given context is</font></i>
<a name='L1247'><i><font color='green'> * blocking, immediately read the reply into the "reply" pointer. When the</font></i>
<a name='L1248'><i><font color='green'> * context is non-blocking, the "reply" pointer will not be used and the</font></i>
<a name='L1249'><i><font color='green'> * command is simply appended to the write buffer.</font></i>
<a name='L1250'><i><font color='green'> *</font></i>
<a name='L1251'><i><font color='green'> * Returns the reply when a reply was succesfully retrieved. Returns NULL</font></i>
<a name='L1252'><i><font color='green'> * otherwise. When NULL is returned in a blocking context, the error field</font></i>
<a name='L1253'><i><font color='green'> * in the context will be set.</font></i>
<a name='L1254'><i><font color='green'> */</font></i>
<a name='L1255'><b>static</b> <b>void</b> *<a href='../R/1138.html' title='Multiple refered from 2 places.'>__redisBlockForReply</a>(redisContext *c) <font color='red'>{</font>
<a name='L1256'>    <b>void</b> *reply;
<a name='L1257'>
<a name='L1258'>    <b>if</b> (c-&gt;flags &amp; <a href='../S/121.html#L57' title='Defined at 57 in deps/hiredis/hiredis.h.'>REDIS_BLOCK</a>) <font color='red'>{</font>
<a name='L1259'>        <b>if</b> (<a href='../S/120.html#L1146' title='Defined at 1146 in deps/hiredis/hiredis.c.'>redisGetReply</a>(c,&amp;reply) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>)
<a name='L1260'>            <b>return</b> NULL;
<a name='L1261'>        <b>return</b> reply;
<a name='L1262'>    <font color='red'>}</font>
<a name='L1263'>    <b>return</b> NULL;
<a name='L1264'><font color='red'>}</font>
<a name='L1265'>
<a name='L1266'><b>void</b> *<a href='../R/3508.html' title='Multiple refered from 2 places.'>redisvCommand</a>(redisContext *c, <b>const</b> <b>char</b> *format, va_list ap) <font color='red'>{</font>
<a name='L1267'>    <b>if</b> (<a href='../S/120.html#L1196' title='Defined at 1196 in deps/hiredis/hiredis.c.'>redisvAppendCommand</a>(c,format,ap) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>)
<a name='L1268'>        <b>return</b> NULL;
<a name='L1269'>    <b>return</b> <a href='../S/120.html#L1255' title='Defined at 1255 in deps/hiredis/hiredis.c.'>__redisBlockForReply</a>(c);
<a name='L1270'><font color='red'>}</font>
<a name='L1271'>
<a name='L1272'><b>void</b> *<a href='../R/3423.html' title='Multiple refered from 63 places.'>redisCommand</a>(redisContext *c, <b>const</b> <b>char</b> *format, ...) <font color='red'>{</font>
<a name='L1273'>    va_list ap;
<a name='L1274'>    <b>void</b> *reply = NULL;
<a name='L1275'>    va_start(ap,format);
<a name='L1276'>    reply = <a href='../S/120.html#L1266' title='Defined at 1266 in deps/hiredis/hiredis.c.'>redisvCommand</a>(c,format,ap);
<a name='L1277'>    va_end(ap);
<a name='L1278'>    <b>return</b> reply;
<a name='L1279'><font color='red'>}</font>
<a name='L1280'>
<a name='L1281'><b>void</b> *<a href='../S/121.html#L204' title='Refered from 204 in deps/hiredis/hiredis.h.'>redisCommandArgv</a>(redisContext *c, <b>int</b> argc, <b>const</b> <b>char</b> **argv, <b>const</b> size_t *argvlen) <font color='red'>{</font>
<a name='L1282'>    <b>if</b> (<a href='../S/120.html#L1225' title='Defined at 1225 in deps/hiredis/hiredis.c.'>redisAppendCommandArgv</a>(c,argc,argv,argvlen) != <a href='../D/848.html' title='Multiple defined in 2 places.'>REDIS_OK</a>)
<a name='L1283'>        <b>return</b> NULL;
<a name='L1284'>    <b>return</b> <a href='../S/120.html#L1255' title='Defined at 1255 in deps/hiredis/hiredis.c.'>__redisBlockForReply</a>(c);
<a name='L1285'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L61'>[^]</a><a href='#L1281'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
