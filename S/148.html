<html>
<head>
<title>deps/jemalloc/include/jemalloc/internal/atomic.h</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/387.html'>deps</a>/<a href='../files/390.html'>jemalloc</a>/<a href='../files/391.html'>include</a>/<a href='../files/392.html'>jemalloc</a>/<a href='../files/393.html'>internal</a>/atomic.h</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L38'>[^]</a><a href='#L289'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L38' title='Defined at 38.'>atomic_add_uint64</a>
<li><a href='#L45' title='Defined at 45.'>atomic_sub_uint64</a>
<li><a href='#L52' title='Defined at 52.'>atomic_add_uint64</a>
<li><a href='#L59' title='Defined at 59.'>atomic_sub_uint64</a>
<li><a href='#L66' title='Defined at 66.'>atomic_add_uint64</a>
<li><a href='#L73' title='Defined at 73.'>atomic_sub_uint64</a>
<li><a href='#L80' title='Defined at 80.'>atomic_add_uint64</a>
<li><a href='#L93' title='Defined at 93.'>atomic_sub_uint64</a>
<li><a href='#L107' title='Defined at 107.'>atomic_add_uint64</a>
<li><a href='#L120' title='Defined at 120.'>atomic_sub_uint64</a>
<li><a href='#L129' title='Defined at 129.'>atomic_add_uint64</a>
<li><a href='#L136' title='Defined at 136.'>atomic_sub_uint64</a>
<li><a href='#L150' title='Defined at 150.'>atomic_add_uint32</a>
<li><a href='#L157' title='Defined at 157.'>atomic_sub_uint32</a>
<li><a href='#L164' title='Defined at 164.'>atomic_add_uint32</a>
<li><a href='#L171' title='Defined at 171.'>atomic_sub_uint32</a>
<li><a href='#L178' title='Defined at 178.'>atomic_add_uint32</a>
<li><a href='#L185' title='Defined at 185.'>atomic_sub_uint32</a>
<li><a href='#L192' title='Defined at 192.'>atomic_add_uint32</a>
<li><a href='#L205' title='Defined at 205.'>atomic_sub_uint32</a>
<li><a href='#L219' title='Defined at 219.'>atomic_add_uint32</a>
<li><a href='#L226' title='Defined at 226.'>atomic_sub_uint32</a>
<li><a href='#L233' title='Defined at 233.'>atomic_add_uint32</a>
<li><a href='#L240' title='Defined at 240.'>atomic_sub_uint32</a>
<li><a href='#L252' title='Defined at 252.'>atomic_add_z</a>
<li><a href='#L263' title='Defined at 263.'>atomic_sub_z</a>
<li><a href='#L278' title='Defined at 278.'>atomic_add_u</a>
<li><a href='#L289' title='Defined at 289.'>atomic_sub_u</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L2'><font color='darkred'>#ifdef</font> JEMALLOC_H_TYPES
<a name='L3'>
<a name='L4'><font color='darkred'>#endif</font> <i><font color='green'>/* JEMALLOC_H_TYPES */</font></i>
<a name='L5'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L6'><font color='darkred'>#ifdef</font> JEMALLOC_H_STRUCTS
<a name='L7'>
<a name='L8'><font color='darkred'>#endif</font> <i><font color='green'>/* JEMALLOC_H_STRUCTS */</font></i>
<a name='L9'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L10'><font color='darkred'>#ifdef</font> JEMALLOC_H_EXTERNS
<a name='L11'>
<a name='L12'><font color='darkred'>#define</font> atomic_read_uint64(p)   <a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>(p, 0)
<a name='L13'><font color='darkred'>#define</font> atomic_read_uint32(p)   <a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>(p, 0)
<a name='L14'><font color='darkred'>#define</font> <a href='../R/1422.html' title='Multiple refered from 2 places.'>atomic_read_z</a>(p)        <a href='../D/1692.html' title='Multiple defined in 2 places.'>atomic_add_z</a>(p, 0)
<a name='L15'><font color='darkred'>#define</font> atomic_read_u(p)        <a href='../D/1689.html' title='Multiple defined in 2 places.'>atomic_add_u</a>(p, 0)
<a name='L16'>
<a name='L17'><font color='darkred'>#endif</font> <i><font color='green'>/* JEMALLOC_H_EXTERNS */</font></i>
<a name='L18'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L19'><font color='darkred'>#ifdef</font> JEMALLOC_H_INLINES
<a name='L20'>
<a name='L21'><font color='darkred'>#ifndef</font> JEMALLOC_ENABLE_INLINE
<a name='L22'><a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>        <a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x);
<a name='L23'><a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>        <a href='../D/1699.html' title='Multiple defined in 7 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x);
<a name='L24'><a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>        <a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x);
<a name='L25'><a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>        <a href='../D/1698.html' title='Multiple defined in 7 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x);
<a name='L26'>size_t  <a href='../D/1692.html' title='Multiple defined in 2 places.'>atomic_add_z</a>(size_t *p, size_t x);
<a name='L27'>size_t  <a href='../D/1700.html' title='Multiple defined in 2 places.'>atomic_sub_z</a>(size_t *p, size_t x);
<a name='L28'><b>unsigned</b>        <a href='../D/1689.html' title='Multiple defined in 2 places.'>atomic_add_u</a>(<b>unsigned</b> *p, <b>unsigned</b> x);
<a name='L29'><b>unsigned</b>        <a href='../D/1697.html' title='Multiple defined in 2 places.'>atomic_sub_u</a>(<b>unsigned</b> *p, <b>unsigned</b> x);
<a name='L30'><font color='darkred'>#endif</font>
<a name='L31'>
<a name='L32'><font color='darkred'>#if</font> (<b>defined</b>(JEMALLOC_ENABLE_INLINE) || <b>defined</b>(<a href='../S/208.html#L1' title='Defined at 1 in deps/jemalloc/src/atomic.c.'>JEMALLOC_ATOMIC_C_</a>))
<a name='L33'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L34'><i><font color='green'>/* 64-bit operations. */</font></i>
<a name='L35'><font color='darkred'>#if</font> (LG_SIZEOF_PTR == 3 || LG_SIZEOF_INT == 3)
<a name='L36'><font color='darkred'>#  ifdef</font> __GCC_HAVE_SYNC_COMPARE_AND_SWAP_8
<a name='L37'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L38'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L39'><font color='red'>{</font>
<a name='L40'>
<a name='L41'>        <b>return</b> (__sync_add_and_fetch(p, x));
<a name='L42'><font color='red'>}</font>
<a name='L43'>
<a name='L44'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L45'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L46'><font color='red'>{</font>
<a name='L47'>
<a name='L48'>        <b>return</b> (__sync_sub_and_fetch(p, x));
<a name='L49'><font color='red'>}</font>
<a name='L50'><font color='darkred'>#elif</font> (<b>defined</b>(_MSC_VER))
<a name='L51'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L52'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L53'><font color='red'>{</font>
<a name='L54'>
<a name='L55'>        <b>return</b> (InterlockedExchangeAdd64(p, x));
<a name='L56'><font color='red'>}</font>
<a name='L57'>
<a name='L58'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L59'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L60'><font color='red'>{</font>
<a name='L61'>
<a name='L62'>        <b>return</b> (InterlockedExchangeAdd64(p, -((<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x)));
<a name='L63'><font color='red'>}</font>
<a name='L64'><font color='darkred'>#elif</font> (<b>defined</b>(JEMALLOC_OSATOMIC))
<a name='L65'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L66'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L67'><font color='red'>{</font>
<a name='L68'>
<a name='L69'>        <b>return</b> (OSAtomicAdd64((<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x, (<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a> *)p));
<a name='L70'><font color='red'>}</font>
<a name='L71'>
<a name='L72'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L73'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L74'><font color='red'>{</font>
<a name='L75'>
<a name='L76'>        <b>return</b> (OSAtomicAdd64(-((<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x), (<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a> *)p));
<a name='L77'><font color='red'>}</font>
<a name='L78'><font color='darkred'>#  elif</font> (<b>defined</b>(__amd64__) || <b>defined</b>(__x86_64__))
<a name='L79'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L80'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L81'><font color='red'>{</font>
<a name='L82'>
<a name='L83'>        <b>asm</b> <b>volatile</b> (
<a name='L84'>            "lock; xaddq %0, %1;"
<a name='L85'>            : "+r" (x), "=m" (*p) <i><font color='green'>/* Outputs. */</font></i>
<a name='L86'>            : "m" (*p) <i><font color='green'>/* Inputs. */</font></i>
<a name='L87'>            );
<a name='L88'>
<a name='L89'>        <b>return</b> (x);
<a name='L90'><font color='red'>}</font>
<a name='L91'>
<a name='L92'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L93'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L94'><font color='red'>{</font>
<a name='L95'>
<a name='L96'>        x = (<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>)(-(<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x);
<a name='L97'>        <b>asm</b> <b>volatile</b> (
<a name='L98'>            "lock; xaddq %0, %1;"
<a name='L99'>            : "+r" (x), "=m" (*p) <i><font color='green'>/* Outputs. */</font></i>
<a name='L100'>            : "m" (*p) <i><font color='green'>/* Inputs. */</font></i>
<a name='L101'>            );
<a name='L102'>
<a name='L103'>        <b>return</b> (x);
<a name='L104'><font color='red'>}</font>
<a name='L105'><font color='darkred'>#  elif</font> (<b>defined</b>(JEMALLOC_ATOMIC9))
<a name='L106'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L107'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L108'><font color='red'>{</font>
<a name='L109'>
<a name='L110'>        <i><font color='green'>/*</font></i>
<a name='L111'><i><font color='green'>         * atomic_fetchadd_64() doesn't exist, but we only ever use this</font></i>
<a name='L112'><i><font color='green'>         * function on LP64 systems, so atomic_fetchadd_long() will do.</font></i>
<a name='L113'><i><font color='green'>         */</font></i>
<a name='L114'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<b>sizeof</b>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>) == <b>sizeof</b>(<b>unsigned</b> <b>long</b>));
<a name='L115'>
<a name='L116'>        <b>return</b> (atomic_fetchadd_long(p, (<b>unsigned</b> <b>long</b>)x) + x);
<a name='L117'><font color='red'>}</font>
<a name='L118'>
<a name='L119'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L120'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L121'><font color='red'>{</font>
<a name='L122'>
<a name='L123'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<b>sizeof</b>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>) == <b>sizeof</b>(<b>unsigned</b> <b>long</b>));
<a name='L124'>
<a name='L125'>        <b>return</b> (atomic_fetchadd_long(p, (<b>unsigned</b> <b>long</b>)(-(<b>long</b>)x)) - x);
<a name='L126'><font color='red'>}</font>
<a name='L127'><font color='darkred'>#  elif</font> (<b>defined</b>(JE_FORCE_SYNC_COMPARE_AND_SWAP_8))
<a name='L128'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L129'><a href='../R/1420.html' title='Multiple refered from 7 places.'>atomic_add_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L130'><font color='red'>{</font>
<a name='L131'>
<a name='L132'>        <b>return</b> (__sync_add_and_fetch(p, x));
<a name='L133'><font color='red'>}</font>
<a name='L134'>
<a name='L135'>JEMALLOC_INLINE <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>
<a name='L136'><a href='../R/1425.html' title='Multiple refered from 2 places.'>atomic_sub_uint64</a>(<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *p, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> x)
<a name='L137'><font color='red'>{</font>
<a name='L138'>
<a name='L139'>        <b>return</b> (__sync_sub_and_fetch(p, x));
<a name='L140'><font color='red'>}</font>
<a name='L141'><font color='darkred'>#  else</font>
<a name='L142'><font color='darkred'>#    error</font> "Missing implementation for 64-bit atomic operations"
<a name='L143'><font color='darkred'>#  endif</font>
<a name='L144'><font color='darkred'>#endif</font>
<a name='L145'>
<a name='L146'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L147'><i><font color='green'>/* 32-bit operations. */</font></i>
<a name='L148'><font color='darkred'>#ifdef</font> __GCC_HAVE_SYNC_COMPARE_AND_SWAP_4
<a name='L149'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L150'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L151'><font color='red'>{</font>
<a name='L152'>
<a name='L153'>        <b>return</b> (__sync_add_and_fetch(p, x));
<a name='L154'><font color='red'>}</font>
<a name='L155'>
<a name='L156'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L157'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L158'><font color='red'>{</font>
<a name='L159'>
<a name='L160'>        <b>return</b> (__sync_sub_and_fetch(p, x));
<a name='L161'><font color='red'>}</font>
<a name='L162'><font color='darkred'>#elif</font> (<b>defined</b>(_MSC_VER))
<a name='L163'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L164'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L165'><font color='red'>{</font>
<a name='L166'>
<a name='L167'>        <b>return</b> (InterlockedExchangeAdd(p, x));
<a name='L168'><font color='red'>}</font>
<a name='L169'>
<a name='L170'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L171'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L172'><font color='red'>{</font>
<a name='L173'>
<a name='L174'>        <b>return</b> (InterlockedExchangeAdd(p, -((<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x)));
<a name='L175'><font color='red'>}</font>
<a name='L176'><font color='darkred'>#elif</font> (<b>defined</b>(JEMALLOC_OSATOMIC))
<a name='L177'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L178'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L179'><font color='red'>{</font>
<a name='L180'>
<a name='L181'>        <b>return</b> (OSAtomicAdd32((<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x, (<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a> *)p));
<a name='L182'><font color='red'>}</font>
<a name='L183'>
<a name='L184'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L185'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L186'><font color='red'>{</font>
<a name='L187'>
<a name='L188'>        <b>return</b> (OSAtomicAdd32(-((<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x), (<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a> *)p));
<a name='L189'><font color='red'>}</font>
<a name='L190'><font color='darkred'>#elif</font> (<b>defined</b>(__i386__) || <b>defined</b>(__amd64__) || <b>defined</b>(__x86_64__))
<a name='L191'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L192'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L193'><font color='red'>{</font>
<a name='L194'>
<a name='L195'>        <b>asm</b> <b>volatile</b> (
<a name='L196'>            "lock; xaddl %0, %1;"
<a name='L197'>            : "+r" (x), "=m" (*p) <i><font color='green'>/* Outputs. */</font></i>
<a name='L198'>            : "m" (*p) <i><font color='green'>/* Inputs. */</font></i>
<a name='L199'>            );
<a name='L200'>
<a name='L201'>        <b>return</b> (x);
<a name='L202'><font color='red'>}</font>
<a name='L203'>
<a name='L204'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L205'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L206'><font color='red'>{</font>
<a name='L207'>
<a name='L208'>        x = (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)(-(<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x);
<a name='L209'>        <b>asm</b> <b>volatile</b> (
<a name='L210'>            "lock; xaddl %0, %1;"
<a name='L211'>            : "+r" (x), "=m" (*p) <i><font color='green'>/* Outputs. */</font></i>
<a name='L212'>            : "m" (*p) <i><font color='green'>/* Inputs. */</font></i>
<a name='L213'>            );
<a name='L214'>
<a name='L215'>        <b>return</b> (x);
<a name='L216'><font color='red'>}</font>
<a name='L217'><font color='darkred'>#elif</font> (<b>defined</b>(JEMALLOC_ATOMIC9))
<a name='L218'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L219'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L220'><font color='red'>{</font>
<a name='L221'>
<a name='L222'>        <b>return</b> (atomic_fetchadd_32(p, x) + x);
<a name='L223'><font color='red'>}</font>
<a name='L224'>
<a name='L225'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L226'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L227'><font color='red'>{</font>
<a name='L228'>
<a name='L229'>        <b>return</b> (atomic_fetchadd_32(p, (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)(-(<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x)) - x);
<a name='L230'><font color='red'>}</font>
<a name='L231'><font color='darkred'>#elif</font> (<b>defined</b>(JE_FORCE_SYNC_COMPARE_AND_SWAP_4))
<a name='L232'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L233'><a href='../R/1419.html' title='Multiple refered from 7 places.'>atomic_add_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L234'><font color='red'>{</font>
<a name='L235'>
<a name='L236'>        <b>return</b> (__sync_add_and_fetch(p, x));
<a name='L237'><font color='red'>}</font>
<a name='L238'>
<a name='L239'>JEMALLOC_INLINE <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>
<a name='L240'><a href='../R/1424.html' title='Multiple refered from 2 places.'>atomic_sub_uint32</a>(<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *p, <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> x)
<a name='L241'><font color='red'>{</font>
<a name='L242'>
<a name='L243'>        <b>return</b> (__sync_sub_and_fetch(p, x));
<a name='L244'><font color='red'>}</font>
<a name='L245'><font color='darkred'>#else</font>
<a name='L246'><font color='darkred'>#  error</font> "Missing implementation for 32-bit atomic operations"
<a name='L247'><font color='darkred'>#endif</font>
<a name='L248'>
<a name='L249'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L250'><i><font color='green'>/* size_t operations. */</font></i>
<a name='L251'>JEMALLOC_INLINE size_t
<a name='L252'><a href='../R/1421.html' title='Multiple refered from 4 places.'>atomic_add_z</a>(size_t *p, size_t x)
<a name='L253'><font color='red'>{</font>
<a name='L254'>
<a name='L255'><font color='darkred'>#if</font> (LG_SIZEOF_PTR == 3)
<a name='L256'>        <b>return</b> ((size_t)<a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>((<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *)p, (<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>)x));
<a name='L257'><font color='darkred'>#elif</font> (LG_SIZEOF_PTR == 2)
<a name='L258'>        <b>return</b> ((size_t)<a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>((<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *)p, (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)x));
<a name='L259'><font color='darkred'>#endif</font>
<a name='L260'><font color='red'>}</font>
<a name='L261'>
<a name='L262'>JEMALLOC_INLINE size_t
<a name='L263'><a href='../R/1426.html' title='Multiple refered from 3 places.'>atomic_sub_z</a>(size_t *p, size_t x)
<a name='L264'><font color='red'>{</font>
<a name='L265'>
<a name='L266'><font color='darkred'>#if</font> (LG_SIZEOF_PTR == 3)
<a name='L267'>        <b>return</b> ((size_t)<a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>((<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *)p,
<a name='L268'>            (<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>)-((<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x)));
<a name='L269'><font color='darkred'>#elif</font> (LG_SIZEOF_PTR == 2)
<a name='L270'>        <b>return</b> ((size_t)<a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>((<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *)p,
<a name='L271'>            (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)-((<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x)));
<a name='L272'><font color='darkred'>#endif</font>
<a name='L273'><font color='red'>}</font>
<a name='L274'>
<a name='L275'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L276'><i><font color='green'>/* unsigned operations. */</font></i>
<a name='L277'>JEMALLOC_INLINE <b>unsigned</b>
<a name='L278'><a href='../R/1418.html' title='Multiple refered from 4 places.'>atomic_add_u</a>(<b>unsigned</b> *p, <b>unsigned</b> x)
<a name='L279'><font color='red'>{</font>
<a name='L280'>
<a name='L281'><font color='darkred'>#if</font> (LG_SIZEOF_INT == 3)
<a name='L282'>        <b>return</b> ((<b>unsigned</b>)<a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>((<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *)p, (<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>)x));
<a name='L283'><font color='darkred'>#elif</font> (LG_SIZEOF_INT == 2)
<a name='L284'>        <b>return</b> ((<b>unsigned</b>)<a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>((<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *)p, (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)x));
<a name='L285'><font color='darkred'>#endif</font>
<a name='L286'><font color='red'>}</font>
<a name='L287'>
<a name='L288'>JEMALLOC_INLINE <b>unsigned</b>
<a name='L289'><a href='../R/1423.html' title='Multiple refered from 2 places.'>atomic_sub_u</a>(<b>unsigned</b> *p, <b>unsigned</b> x)
<a name='L290'><font color='red'>{</font>
<a name='L291'>
<a name='L292'><font color='darkred'>#if</font> (LG_SIZEOF_INT == 3)
<a name='L293'>        <b>return</b> ((<b>unsigned</b>)<a href='../D/1691.html' title='Multiple defined in 7 places.'>atomic_add_uint64</a>((<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> *)p,
<a name='L294'>            (<a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>)-((<a href='../S/160.html#L89' title='Defined at 89 in deps/jemalloc/include/msvc_compat/stdint.h.'>int64_t</a>)x)));
<a name='L295'><font color='darkred'>#elif</font> (LG_SIZEOF_INT == 2)
<a name='L296'>        <b>return</b> ((<b>unsigned</b>)<a href='../D/1690.html' title='Multiple defined in 7 places.'>atomic_add_uint32</a>((<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> *)p,
<a name='L297'>            (<a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a>)-((<a href='../D/2493.html' title='Multiple defined in 2 places.'>int32_t</a>)x)));
<a name='L298'><font color='darkred'>#endif</font>
<a name='L299'><font color='red'>}</font>
<a name='L300'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L301'><font color='darkred'>#endif</font>
<a name='L302'>
<a name='L303'><font color='darkred'>#endif</font> <i><font color='green'>/* JEMALLOC_H_INLINES */</font></i>
<a name='L304'><i><font color='green'>/******************************************************************************/</font></i>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L38'>[^]</a><a href='#L289'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
