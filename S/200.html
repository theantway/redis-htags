<html>
<head>
<title>deps/jemalloc/src/ckh.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/387.html'>deps</a>/<a href='../files/390.html'>jemalloc</a>/<a href='../files/395.html'>src</a>/ckh.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L53'>[^]</a><a href='#L605'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L53' title='Defined at 53.'>ckh_bucket_search</a>
<li><a href='#L71' title='Defined at 71.'>ckh_isearch</a>
<li><a href='#L92' title='Defined at 92.'>ckh_try_bucket_insert</a>
<li><a href='#L124' title='Defined at 124.'>ckh_evict_reloc_insert</a>
<li><a href='#L193' title='Defined at 193.'>ckh_try_insert</a>
<li><a href='#L222' title='Defined at 222.'>ckh_rebuild</a>
<li><a href='#L245' title='Defined at 245.'>ckh_grow</a>
<li><a href='#L300' title='Defined at 300.'>ckh_shrink</a>
<li><a href='#L347' title='Defined at 347.'>ckh_new</a>
<li><a href='#L402' title='Defined at 402.'>ckh_delete</a>
<li><a href='#L426' title='Defined at 426.'>ckh_count</a>
<li><a href='#L435' title='Defined at 435.'>ckh_iter</a>
<li><a href='#L455' title='Defined at 455.'>ckh_insert</a>
<li><a href='#L479' title='Defined at 479.'>ckh_remove</a>
<li><a href='#L510' title='Defined at 510.'>ckh_search</a>
<li><a href='#L529' title='Defined at 529.'>ckh_string_hash</a>
<li><a href='#L557' title='Defined at 557.'>ckh_string_keycomp</a>
<li><a href='#L567' title='Defined at 567.'>ckh_pointer_hash</a>
<li><a href='#L605' title='Defined at 605.'>ckh_pointer_keycomp</a>
</ol>
<hr>
<pre>
<a name='L1'><i><font color='green'>/*</font></i>
<a name='L2'><i><font color='green'> *******************************************************************************</font></i>
<a name='L3'><i><font color='green'> * Implementation of (2^1+,2) cuckoo hashing, where 2^1+ indicates that each</font></i>
<a name='L4'><i><font color='green'> * hash bucket contains 2^n cells, for n &gt;= 1, and 2 indicates that two hash</font></i>
<a name='L5'><i><font color='green'> * functions are employed.  The original cuckoo hashing algorithm was described</font></i>
<a name='L6'><i><font color='green'> * in:</font></i>
<a name='L7'><i><font color='green'> *</font></i>
<a name='L8'><i><font color='green'> *   Pagh, R., F.F. Rodler (2004) Cuckoo Hashing.  Journal of Algorithms</font></i>
<a name='L9'><i><font color='green'> *     51(2):122-144.</font></i>
<a name='L10'><i><font color='green'> *</font></i>
<a name='L11'><i><font color='green'> * Generalization of cuckoo hashing was discussed in:</font></i>
<a name='L12'><i><font color='green'> *</font></i>
<a name='L13'><i><font color='green'> *   Erlingsson, U., M. Manasse, F. McSherry (2006) A cool and practical</font></i>
<a name='L14'><i><font color='green'> *     alternative to traditional hash tables.  In Proceedings of the 7th</font></i>
<a name='L15'><i><font color='green'> *     Workshop on Distributed Data and Structures (WDAS'06), Santa Clara, CA,</font></i>
<a name='L16'><i><font color='green'> *     January 2006.</font></i>
<a name='L17'><i><font color='green'> *</font></i>
<a name='L18'><i><font color='green'> * This implementation uses precisely two hash functions because that is the</font></i>
<a name='L19'><i><font color='green'> * fewest that can work, and supporting multiple hashes is an implementation</font></i>
<a name='L20'><i><font color='green'> * burden.  Here is a reproduction of Figure 1 from Erlingsson et al. (2006)</font></i>
<a name='L21'><i><font color='green'> * that shows approximate expected maximum load factors for various</font></i>
<a name='L22'><i><font color='green'> * configurations:</font></i>
<a name='L23'><i><font color='green'> *</font></i>
<a name='L24'><i><font color='green'> *           |         #cells/bucket         |</font></i>
<a name='L25'><i><font color='green'> *   #hashes |   1   |   2   |   4   |   8   |</font></i>
<a name='L26'><i><font color='green'> *   --------+-------+-------+-------+-------+</font></i>
<a name='L27'><i><font color='green'> *         1 | 0.006 | 0.006 | 0.03  | 0.12  |</font></i>
<a name='L28'><i><font color='green'> *         2 | 0.49  | 0.86  |&gt;0.93&lt; |&gt;0.96&lt; |</font></i>
<a name='L29'><i><font color='green'> *         3 | 0.91  | 0.97  | 0.98  | 0.999 |</font></i>
<a name='L30'><i><font color='green'> *         4 | 0.97  | 0.99  | 0.999 |       |</font></i>
<a name='L31'><i><font color='green'> *</font></i>
<a name='L32'><i><font color='green'> * The number of cells per bucket is chosen such that a bucket fits in one cache</font></i>
<a name='L33'><i><font color='green'> * line.  So, on 32- and 64-bit systems, we use (8,2) and (4,2) cuckoo hashing,</font></i>
<a name='L34'><i><font color='green'> * respectively.</font></i>
<a name='L35'><i><font color='green'> *</font></i>
<a name='L36'><i><font color='green'> ******************************************************************************/</font></i>
<a name='L37'><font color='darkred'>#define</font> JEMALLOC_CKH_C_
<a name='L38'><font color='darkred'>#include</font> "jemalloc/internal/jemalloc_internal.h"
<a name='L39'>
<a name='L40'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L41'><i><font color='green'>/* Function prototypes for non-inline static functions. */</font></i>
<a name='L42'>
<a name='L43'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>     <a href='../S/200.html#L245' title='Defined at 245 in deps/jemalloc/src/ckh.c.'>ckh_grow</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh);
<a name='L44'><b>static</b> <b>void</b>     <a href='../S/200.html#L300' title='Defined at 300 in deps/jemalloc/src/ckh.c.'>ckh_shrink</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh);
<a name='L45'>
<a name='L46'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L47'>
<a name='L48'><i><font color='green'>/*</font></i>
<a name='L49'><i><font color='green'> * Search bucket for key and return the cell number if found; SIZE_T_MAX</font></i>
<a name='L50'><i><font color='green'> * otherwise.</font></i>
<a name='L51'><i><font color='green'> */</font></i>
<a name='L52'>JEMALLOC_INLINE size_t
<a name='L53'><a href='../R/1593.html' title='Multiple refered from 3 places.'>ckh_bucket_search</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, size_t bucket, <b>const</b> <b>void</b> *key)
<a name='L54'><font color='red'>{</font>
<a name='L55'>        <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *cell;
<a name='L56'>        <b>unsigned</b> i;
<a name='L57'>
<a name='L58'>        <b>for</b> (i = 0; i &lt; (ZU(1) &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>); i++) <font color='red'>{</font>
<a name='L59'>                cell = &amp;ckh-&gt;tab[(bucket &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>) + i];
<a name='L60'>                <b>if</b> (cell-&gt;key != NULL &amp;&amp; ckh-&gt;keycomp(key, cell-&gt;key))
<a name='L61'>                        <b>return</b> ((bucket &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>) + i);
<a name='L62'>        <font color='red'>}</font>
<a name='L63'>
<a name='L64'>        <b>return</b> (SIZE_T_MAX);
<a name='L65'><font color='red'>}</font>
<a name='L66'>
<a name='L67'><i><font color='green'>/*</font></i>
<a name='L68'><i><font color='green'> * Search table for key and return cell number if found; SIZE_T_MAX otherwise.</font></i>
<a name='L69'><i><font color='green'> */</font></i>
<a name='L70'>JEMALLOC_INLINE size_t
<a name='L71'><a href='../R/1600.html' title='Multiple refered from 3 places.'>ckh_isearch</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <b>const</b> <b>void</b> *key)
<a name='L72'><font color='red'>{</font>
<a name='L73'>        size_t hash1, hash2, bucket, cell;
<a name='L74'>
<a name='L75'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L76'>
<a name='L77'>        ckh-&gt;<a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(key, ckh-&gt;lg_curbuckets, &amp;hash1, &amp;hash2);
<a name='L78'>
<a name='L79'>        <i><font color='green'>/* Search primary bucket. */</font></i>
<a name='L80'>        bucket = hash1 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L81'>        cell = <a href='../D/1868.html' title='Multiple defined in 2 places.'>ckh_bucket_search</a>(ckh, bucket, key);
<a name='L82'>        <b>if</b> (cell != SIZE_T_MAX)
<a name='L83'>                <b>return</b> (cell);
<a name='L84'>
<a name='L85'>        <i><font color='green'>/* Search secondary bucket. */</font></i>
<a name='L86'>        bucket = hash2 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L87'>        cell = <a href='../D/1868.html' title='Multiple defined in 2 places.'>ckh_bucket_search</a>(ckh, bucket, key);
<a name='L88'>        <b>return</b> (cell);
<a name='L89'><font color='red'>}</font>
<a name='L90'>
<a name='L91'>JEMALLOC_INLINE <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L92'><a href='../R/1614.html' title='Multiple refered from 4 places.'>ckh_try_bucket_insert</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, size_t bucket, <b>const</b> <b>void</b> *key,
<a name='L93'>    <b>const</b> <b>void</b> *data)
<a name='L94'><font color='red'>{</font>
<a name='L95'>        <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *cell;
<a name='L96'>        <b>unsigned</b> offset, i;
<a name='L97'>
<a name='L98'>        <i><font color='green'>/*</font></i>
<a name='L99'><i><font color='green'>         * Cycle through the cells in the bucket, starting at a random position.</font></i>
<a name='L100'><i><font color='green'>         * The randomness avoids worst-case search overhead as buckets fill up.</font></i>
<a name='L101'><i><font color='green'>         */</font></i>
<a name='L102'>        <a href='../S/152.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/prng.h.'>prng32</a>(offset, <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>, ckh-&gt;prng_state, <a href='../S/134.html#L43' title='Defined at 43 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>CKH_A</a>, <a href='../S/134.html#L44' title='Defined at 44 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>CKH_C</a>);
<a name='L103'>        <b>for</b> (i = 0; i &lt; (ZU(1) &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>); i++) <font color='red'>{</font>
<a name='L104'>                cell = &amp;ckh-&gt;tab[(bucket &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>) +
<a name='L105'>                    ((i + offset) &amp; ((ZU(1) &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>) - 1))];
<a name='L106'>                <b>if</b> (cell-&gt;key == NULL) <font color='red'>{</font>
<a name='L107'>                        cell-&gt;key = key;
<a name='L108'>                        cell-&gt;data = data;
<a name='L109'>                        ckh-&gt;count++;
<a name='L110'>                        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L111'>                <font color='red'>}</font>
<a name='L112'>        <font color='red'>}</font>
<a name='L113'>
<a name='L114'>        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L115'><font color='red'>}</font>
<a name='L116'>
<a name='L117'><i><font color='green'>/*</font></i>
<a name='L118'><i><font color='green'> * No space is available in bucket.  Randomly evict an item, then try to find an</font></i>
<a name='L119'><i><font color='green'> * alternate location for that item.  Iteratively repeat this</font></i>
<a name='L120'><i><font color='green'> * eviction/relocation procedure until either success or detection of an</font></i>
<a name='L121'><i><font color='green'> * eviction/relocation bucket cycle.</font></i>
<a name='L122'><i><font color='green'> */</font></i>
<a name='L123'>JEMALLOC_INLINE <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L124'><a href='../R/1596.html' title='Multiple refered from 2 places.'>ckh_evict_reloc_insert</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, size_t argbucket, <b>void</b> <b>const</b> **argkey,
<a name='L125'>    <b>void</b> <b>const</b> **argdata)
<a name='L126'><font color='red'>{</font>
<a name='L127'>        <b>const</b> <b>void</b> *key, *data, *tkey, *tdata;
<a name='L128'>        <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *cell;
<a name='L129'>        size_t hash1, hash2, bucket, tbucket;
<a name='L130'>        <b>unsigned</b> i;
<a name='L131'>
<a name='L132'>        bucket = argbucket;
<a name='L133'>        key = *argkey;
<a name='L134'>        data = *argdata;
<a name='L135'>        <b>while</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>) <font color='red'>{</font>
<a name='L136'>                <i><font color='green'>/*</font></i>
<a name='L137'><i><font color='green'>                 * Choose a random item within the bucket to evict.  This is</font></i>
<a name='L138'><i><font color='green'>                 * critical to correct function, because without (eventually)</font></i>
<a name='L139'><i><font color='green'>                 * evicting all items within a bucket during iteration, it</font></i>
<a name='L140'><i><font color='green'>                 * would be possible to get stuck in an infinite loop if there</font></i>
<a name='L141'><i><font color='green'>                 * were an item for which both hashes indicated the same</font></i>
<a name='L142'><i><font color='green'>                 * bucket.</font></i>
<a name='L143'><i><font color='green'>                 */</font></i>
<a name='L144'>                <a href='../S/152.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/prng.h.'>prng32</a>(i, <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>, ckh-&gt;prng_state, <a href='../S/134.html#L43' title='Defined at 43 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>CKH_A</a>, <a href='../S/134.html#L44' title='Defined at 44 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>CKH_C</a>);
<a name='L145'>                cell = &amp;ckh-&gt;tab[(bucket &lt;&lt; <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>) + i];
<a name='L146'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(cell-&gt;key != NULL);
<a name='L147'>
<a name='L148'>                <i><font color='green'>/* Swap cell-&gt;{key,data} and {key,data} (evict). */</font></i>
<a name='L149'>                tkey = cell-&gt;key; tdata = cell-&gt;data;
<a name='L150'>                cell-&gt;key = key; cell-&gt;data = data;
<a name='L151'>                key = tkey; data = tdata;
<a name='L152'>
<a name='L153'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L154'>                ckh-&gt;nrelocs++;
<a name='L155'><font color='darkred'>#endif</font>
<a name='L156'>
<a name='L157'>                <i><font color='green'>/* Find the alternate bucket for the evicted item. */</font></i>
<a name='L158'>                ckh-&gt;<a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(key, ckh-&gt;lg_curbuckets, &amp;hash1, &amp;hash2);
<a name='L159'>                tbucket = hash2 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L160'>                <b>if</b> (tbucket == bucket) <font color='red'>{</font>
<a name='L161'>                        tbucket = hash1 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L162'>                        <i><font color='green'>/*</font></i>
<a name='L163'><i><font color='green'>                         * It may be that (tbucket == bucket) still, if the</font></i>
<a name='L164'><i><font color='green'>                         * item's hashes both indicate this bucket.  However,</font></i>
<a name='L165'><i><font color='green'>                         * we are guaranteed to eventually escape this bucket</font></i>
<a name='L166'><i><font color='green'>                         * during iteration, assuming pseudo-random item</font></i>
<a name='L167'><i><font color='green'>                         * selection (true randomness would make infinite</font></i>
<a name='L168'><i><font color='green'>                         * looping a remote possibility).  The reason we can</font></i>
<a name='L169'><i><font color='green'>                         * never get trapped forever is that there are two</font></i>
<a name='L170'><i><font color='green'>                         * cases:</font></i>
<a name='L171'><i><font color='green'>                         *</font></i>
<a name='L172'><i><font color='green'>                         * 1) This bucket == argbucket, so we will quickly</font></i>
<a name='L173'><i><font color='green'>                         *    detect an eviction cycle and terminate.</font></i>
<a name='L174'><i><font color='green'>                         * 2) An item was evicted to this bucket from another,</font></i>
<a name='L175'><i><font color='green'>                         *    which means that at least one item in this bucket</font></i>
<a name='L176'><i><font color='green'>                         *    has hashes that indicate distinct buckets.</font></i>
<a name='L177'><i><font color='green'>                         */</font></i>
<a name='L178'>                <font color='red'>}</font>
<a name='L179'>                <i><font color='green'>/* Check for a cycle. */</font></i>
<a name='L180'>                <b>if</b> (tbucket == argbucket) <font color='red'>{</font>
<a name='L181'>                        *argkey = key;
<a name='L182'>                        *argdata = data;
<a name='L183'>                        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L184'>                <font color='red'>}</font>
<a name='L185'>
<a name='L186'>                bucket = tbucket;
<a name='L187'>                <b>if</b> (<a href='../D/1889.html' title='Multiple defined in 2 places.'>ckh_try_bucket_insert</a>(ckh, bucket, key, data) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>)
<a name='L188'>                        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L189'>        <font color='red'>}</font>
<a name='L190'><font color='red'>}</font>
<a name='L191'>
<a name='L192'>JEMALLOC_INLINE <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L193'><a href='../R/1615.html' title='Multiple refered from 3 places.'>ckh_try_insert</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <b>void</b> <b>const</b>**argkey, <b>void</b> <b>const</b>**argdata)
<a name='L194'><font color='red'>{</font>
<a name='L195'>        size_t hash1, hash2, bucket;
<a name='L196'>        <b>const</b> <b>void</b> *key = *argkey;
<a name='L197'>        <b>const</b> <b>void</b> *data = *argdata;
<a name='L198'>
<a name='L199'>        ckh-&gt;<a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(key, ckh-&gt;lg_curbuckets, &amp;hash1, &amp;hash2);
<a name='L200'>
<a name='L201'>        <i><font color='green'>/* Try to insert in primary bucket. */</font></i>
<a name='L202'>        bucket = hash1 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L203'>        <b>if</b> (<a href='../D/1889.html' title='Multiple defined in 2 places.'>ckh_try_bucket_insert</a>(ckh, bucket, key, data) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>)
<a name='L204'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L205'>
<a name='L206'>        <i><font color='green'>/* Try to insert in secondary bucket. */</font></i>
<a name='L207'>        bucket = hash2 &amp; ((ZU(1) &lt;&lt; ckh-&gt;lg_curbuckets) - 1);
<a name='L208'>        <b>if</b> (<a href='../D/1889.html' title='Multiple defined in 2 places.'>ckh_try_bucket_insert</a>(ckh, bucket, key, data) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>)
<a name='L209'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L210'>
<a name='L211'>        <i><font color='green'>/*</font></i>
<a name='L212'><i><font color='green'>         * Try to find a place for this item via iterative eviction/relocation.</font></i>
<a name='L213'><i><font color='green'>         */</font></i>
<a name='L214'>        <b>return</b> (<a href='../D/1871.html' title='Multiple defined in 2 places.'>ckh_evict_reloc_insert</a>(ckh, bucket, argkey, argdata));
<a name='L215'><font color='red'>}</font>
<a name='L216'>
<a name='L217'><i><font color='green'>/*</font></i>
<a name='L218'><i><font color='green'> * Try to rebuild the hash table from scratch by inserting all items from the</font></i>
<a name='L219'><i><font color='green'> * old table into the new.</font></i>
<a name='L220'><i><font color='green'> */</font></i>
<a name='L221'>JEMALLOC_INLINE <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L222'><a href='../R/1606.html' title='Multiple refered from 3 places.'>ckh_rebuild</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *aTab)
<a name='L223'><font color='red'>{</font>
<a name='L224'>        size_t count, i, nins;
<a name='L225'>        <b>const</b> <b>void</b> *key, *data;
<a name='L226'>
<a name='L227'>        count = ckh-&gt;count;
<a name='L228'>        ckh-&gt;count = 0;
<a name='L229'>        <b>for</b> (i = nins = 0; nins &lt; count; i++) <font color='red'>{</font>
<a name='L230'>                <b>if</b> (aTab[i].key != NULL) <font color='red'>{</font>
<a name='L231'>                        key = aTab[i].key;
<a name='L232'>                        data = aTab[i].data;
<a name='L233'>                        <b>if</b> (<a href='../D/1890.html' title='Multiple defined in 2 places.'>ckh_try_insert</a>(ckh, &amp;key, &amp;data)) <font color='red'>{</font>
<a name='L234'>                                ckh-&gt;count = count;
<a name='L235'>                                <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L236'>                        <font color='red'>}</font>
<a name='L237'>                        nins++;
<a name='L238'>                <font color='red'>}</font>
<a name='L239'>        <font color='red'>}</font>
<a name='L240'>
<a name='L241'>        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L242'><font color='red'>}</font>
<a name='L243'>
<a name='L244'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L245'><a href='../R/1597.html' title='Multiple refered from 2 places.'>ckh_grow</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh)
<a name='L246'><font color='red'>{</font>
<a name='L247'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret;
<a name='L248'>        <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *tab, *ttab;
<a name='L249'>        size_t lg_curcells;
<a name='L250'>        <b>unsigned</b> lg_prevbuckets;
<a name='L251'>
<a name='L252'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L253'>        ckh-&gt;ngrows++;
<a name='L254'><font color='darkred'>#endif</font>
<a name='L255'>
<a name='L256'>        <i><font color='green'>/*</font></i>
<a name='L257'><i><font color='green'>         * It is possible (though unlikely, given well behaved hashes) that the</font></i>
<a name='L258'><i><font color='green'>         * table will have to be doubled more than once in order to create a</font></i>
<a name='L259'><i><font color='green'>         * usable table.</font></i>
<a name='L260'><i><font color='green'>         */</font></i>
<a name='L261'>        lg_prevbuckets = ckh-&gt;lg_curbuckets;
<a name='L262'>        lg_curcells = ckh-&gt;lg_curbuckets + <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L263'>        <b>while</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>) <font color='red'>{</font>
<a name='L264'>                size_t usize;
<a name='L265'>
<a name='L266'>                lg_curcells++;
<a name='L267'>                usize = <a href='../S/138.html#L310' title='Defined at 310 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>sa2u</a>(<b>sizeof</b>(<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a>) &lt;&lt; lg_curcells, CACHELINE);
<a name='L268'>                <b>if</b> (usize == 0) <font color='red'>{</font>
<a name='L269'>                        ret = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L270'>                        <b>goto</b> label_return;
<a name='L271'>                <font color='red'>}</font>
<a name='L272'>                tab = (<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *)<a href='../S/138.html#L200' title='Defined at 200 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>ipalloc</a>(usize, CACHELINE, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L273'>                <b>if</b> (tab == NULL) <font color='red'>{</font>
<a name='L274'>                        ret = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L275'>                        <b>goto</b> label_return;
<a name='L276'>                <font color='red'>}</font>
<a name='L277'>                <i><font color='green'>/* Swap in new table. */</font></i>
<a name='L278'>                ttab = ckh-&gt;tab;
<a name='L279'>                ckh-&gt;tab = tab;
<a name='L280'>                tab = ttab;
<a name='L281'>                ckh-&gt;lg_curbuckets = lg_curcells - <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L282'>
<a name='L283'>                <b>if</b> (<a href='../D/1881.html' title='Multiple defined in 2 places.'>ckh_rebuild</a>(ckh, tab) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L284'>                        <a href='../S/138.html#L196' title='Defined at 196 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>idalloc</a>(tab);
<a name='L285'>                        <b>break</b>;
<a name='L286'>                <font color='red'>}</font>
<a name='L287'>
<a name='L288'>                <i><font color='green'>/* Rebuilding failed, so back out partially rebuilt table. */</font></i>
<a name='L289'>                <a href='../S/138.html#L196' title='Defined at 196 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>idalloc</a>(ckh-&gt;tab);
<a name='L290'>                ckh-&gt;tab = tab;
<a name='L291'>                ckh-&gt;lg_curbuckets = lg_prevbuckets;
<a name='L292'>        <font color='red'>}</font>
<a name='L293'>
<a name='L294'>        ret = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L295'>label_return:
<a name='L296'>        <b>return</b> (ret);
<a name='L297'><font color='red'>}</font>
<a name='L298'>
<a name='L299'><b>static</b> <b>void</b>
<a name='L300'><a href='../R/1610.html' title='Multiple refered from 2 places.'>ckh_shrink</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh)
<a name='L301'><font color='red'>{</font>
<a name='L302'>        <a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *tab, *ttab;
<a name='L303'>        size_t lg_curcells, usize;
<a name='L304'>        <b>unsigned</b> lg_prevbuckets;
<a name='L305'>
<a name='L306'>        <i><font color='green'>/*</font></i>
<a name='L307'><i><font color='green'>         * It is possible (though unlikely, given well behaved hashes) that the</font></i>
<a name='L308'><i><font color='green'>         * table rebuild will fail.</font></i>
<a name='L309'><i><font color='green'>         */</font></i>
<a name='L310'>        lg_prevbuckets = ckh-&gt;lg_curbuckets;
<a name='L311'>        lg_curcells = ckh-&gt;lg_curbuckets + <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a> - 1;
<a name='L312'>        usize = <a href='../S/138.html#L310' title='Defined at 310 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>sa2u</a>(<b>sizeof</b>(<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a>) &lt;&lt; lg_curcells, CACHELINE);
<a name='L313'>        <b>if</b> (usize == 0)
<a name='L314'>                <b>return</b>;
<a name='L315'>        tab = (<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *)<a href='../S/138.html#L200' title='Defined at 200 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>ipalloc</a>(usize, CACHELINE, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L316'>        <b>if</b> (tab == NULL) <font color='red'>{</font>
<a name='L317'>                <i><font color='green'>/*</font></i>
<a name='L318'><i><font color='green'>                 * An OOM error isn't worth propagating, since it doesn't</font></i>
<a name='L319'><i><font color='green'>                 * prevent this or future operations from proceeding.</font></i>
<a name='L320'><i><font color='green'>                 */</font></i>
<a name='L321'>                <b>return</b>;
<a name='L322'>        <font color='red'>}</font>
<a name='L323'>        <i><font color='green'>/* Swap in new table. */</font></i>
<a name='L324'>        ttab = ckh-&gt;tab;
<a name='L325'>        ckh-&gt;tab = tab;
<a name='L326'>        tab = ttab;
<a name='L327'>        ckh-&gt;lg_curbuckets = lg_curcells - <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L328'>
<a name='L329'>        <b>if</b> (<a href='../D/1881.html' title='Multiple defined in 2 places.'>ckh_rebuild</a>(ckh, tab) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L330'>                <a href='../S/138.html#L196' title='Defined at 196 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>idalloc</a>(tab);
<a name='L331'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L332'>                ckh-&gt;nshrinks++;
<a name='L333'><font color='darkred'>#endif</font>
<a name='L334'>                <b>return</b>;
<a name='L335'>        <font color='red'>}</font>
<a name='L336'>
<a name='L337'>        <i><font color='green'>/* Rebuilding failed, so back out partially rebuilt table. */</font></i>
<a name='L338'>        <a href='../S/138.html#L196' title='Defined at 196 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>idalloc</a>(ckh-&gt;tab);
<a name='L339'>        ckh-&gt;tab = tab;
<a name='L340'>        ckh-&gt;lg_curbuckets = lg_prevbuckets;
<a name='L341'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L342'>        ckh-&gt;nshrinkfails++;
<a name='L343'><font color='darkred'>#endif</font>
<a name='L344'><font color='red'>}</font>
<a name='L345'>
<a name='L346'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L347'><a href='../R/1603.html' title='Multiple refered from 4 places.'>ckh_new</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, size_t minitems, <a href='../S/134.html#L8' title='Defined at 8 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_hash_t</a> *hash, <a href='../S/134.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_keycomp_t</a> *keycomp)
<a name='L348'><font color='red'>{</font>
<a name='L349'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret;
<a name='L350'>        size_t mincells, usize;
<a name='L351'>        <b>unsigned</b> lg_mincells;
<a name='L352'>
<a name='L353'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(minitems &gt; 0);
<a name='L354'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a> != NULL);
<a name='L355'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(keycomp != NULL);
<a name='L356'>
<a name='L357'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L358'>        ckh-&gt;ngrows = 0;
<a name='L359'>        ckh-&gt;nshrinks = 0;
<a name='L360'>        ckh-&gt;nshrinkfails = 0;
<a name='L361'>        ckh-&gt;ninserts = 0;
<a name='L362'>        ckh-&gt;nrelocs = 0;
<a name='L363'><font color='darkred'>#endif</font>
<a name='L364'>        ckh-&gt;prng_state = 42; <i><font color='green'>/* Value doesn't really matter. */</font></i>
<a name='L365'>        ckh-&gt;count = 0;
<a name='L366'>
<a name='L367'>        <i><font color='green'>/*</font></i>
<a name='L368'><i><font color='green'>         * Find the minimum power of 2 that is large enough to fit aBaseCount</font></i>
<a name='L369'><i><font color='green'>         * entries.  We are using (2+,2) cuckoo hashing, which has an expected</font></i>
<a name='L370'><i><font color='green'>         * maximum load factor of at least ~0.86, so 0.75 is a conservative load</font></i>
<a name='L371'><i><font color='green'>         * factor that will typically allow 2^aLgMinItems to fit without ever</font></i>
<a name='L372'><i><font color='green'>         * growing the table.</font></i>
<a name='L373'><i><font color='green'>         */</font></i>
<a name='L374'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a> &gt; 0);
<a name='L375'>        mincells = ((minitems + (3 - (minitems % 3))) / 3) &lt;&lt; 2;
<a name='L376'>        <b>for</b> (lg_mincells = <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L377'>            (ZU(1) &lt;&lt; lg_mincells) &lt; mincells;
<a name='L378'>            lg_mincells++)
<a name='L379'>                ; <i><font color='green'>/* Do nothing. */</font></i>
<a name='L380'>        ckh-&gt;lg_minbuckets = lg_mincells - <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L381'>        ckh-&gt;lg_curbuckets = lg_mincells - <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>;
<a name='L382'>        ckh-&gt;<a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a> = <a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>;
<a name='L383'>        ckh-&gt;keycomp = keycomp;
<a name='L384'>
<a name='L385'>        usize = <a href='../S/138.html#L310' title='Defined at 310 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>sa2u</a>(<b>sizeof</b>(<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a>) &lt;&lt; lg_mincells, CACHELINE);
<a name='L386'>        <b>if</b> (usize == 0) <font color='red'>{</font>
<a name='L387'>                ret = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L388'>                <b>goto</b> label_return;
<a name='L389'>        <font color='red'>}</font>
<a name='L390'>        ckh-&gt;tab = (<a href='../S/134.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckhc_t</a> *)<a href='../S/138.html#L200' title='Defined at 200 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>ipalloc</a>(usize, CACHELINE, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L391'>        <b>if</b> (ckh-&gt;tab == NULL) <font color='red'>{</font>
<a name='L392'>                ret = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L393'>                <b>goto</b> label_return;
<a name='L394'>        <font color='red'>}</font>
<a name='L395'>
<a name='L396'>        ret = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L397'>label_return:
<a name='L398'>        <b>return</b> (ret);
<a name='L399'><font color='red'>}</font>
<a name='L400'>
<a name='L401'><b>void</b>
<a name='L402'><a href='../R/1595.html' title='Multiple refered from 4 places.'>ckh_delete</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh)
<a name='L403'><font color='red'>{</font>
<a name='L404'>
<a name='L405'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L406'>
<a name='L407'><font color='darkred'>#ifdef</font> CKH_VERBOSE
<a name='L408'>        <a href='../S/138.html#L219' title='Defined at 219 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>malloc_printf</a>(
<a name='L409'>            "%s(%p): ngrows: %"<a href='../S/158.html#L140' title='Defined at 140 in deps/jemalloc/include/msvc_compat/inttypes.h.'>PRIu64</a>", nshrinks: %"<a href='../S/158.html#L140' title='Defined at 140 in deps/jemalloc/include/msvc_compat/inttypes.h.'>PRIu64</a>","
<a name='L410'>            " nshrinkfails: %"<a href='../S/158.html#L140' title='Defined at 140 in deps/jemalloc/include/msvc_compat/inttypes.h.'>PRIu64</a>", ninserts: %"<a href='../S/158.html#L140' title='Defined at 140 in deps/jemalloc/include/msvc_compat/inttypes.h.'>PRIu64</a>","
<a name='L411'>            " nrelocs: %"<a href='../S/158.html#L140' title='Defined at 140 in deps/jemalloc/include/msvc_compat/inttypes.h.'>PRIu64</a>"\n", __func__, ckh,
<a name='L412'>            (<b>unsigned</b> <b>long</b> <b>long</b>)ckh-&gt;ngrows,
<a name='L413'>            (<b>unsigned</b> <b>long</b> <b>long</b>)ckh-&gt;nshrinks,
<a name='L414'>            (<b>unsigned</b> <b>long</b> <b>long</b>)ckh-&gt;nshrinkfails,
<a name='L415'>            (<b>unsigned</b> <b>long</b> <b>long</b>)ckh-&gt;ninserts,
<a name='L416'>            (<b>unsigned</b> <b>long</b> <b>long</b>)ckh-&gt;nrelocs);
<a name='L417'><font color='darkred'>#endif</font>
<a name='L418'>
<a name='L419'>        <a href='../S/138.html#L196' title='Defined at 196 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>idalloc</a>(ckh-&gt;tab);
<a name='L420'><font color='darkred'>#ifdef</font> JEMALLOC_DEBUG
<a name='L421'>        memset(ckh, 0x5a, <b>sizeof</b>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a>));
<a name='L422'><font color='darkred'>#endif</font>
<a name='L423'><font color='red'>}</font>
<a name='L424'>
<a name='L425'>size_t
<a name='L426'><a href='../R/1594.html' title='Multiple refered from 5 places.'>ckh_count</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh)
<a name='L427'><font color='red'>{</font>
<a name='L428'>
<a name='L429'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L430'>
<a name='L431'>        <b>return</b> (ckh-&gt;count);
<a name='L432'><font color='red'>}</font>
<a name='L433'>
<a name='L434'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L435'><a href='../R/1601.html' title='Multiple refered from 4 places.'>ckh_iter</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, size_t *tabind, <b>void</b> **key, <b>void</b> **data)
<a name='L436'><font color='red'>{</font>
<a name='L437'>        size_t i, ncells;
<a name='L438'>
<a name='L439'>        <b>for</b> (i = *tabind, ncells = (ZU(1) &lt;&lt; (ckh-&gt;lg_curbuckets +
<a name='L440'>            <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a>)); i &lt; ncells; i++) <font color='red'>{</font>
<a name='L441'>                <b>if</b> (ckh-&gt;tab[i].key != NULL) <font color='red'>{</font>
<a name='L442'>                        <b>if</b> (key != NULL)
<a name='L443'>                                *key = (<b>void</b> *)ckh-&gt;tab[i].key;
<a name='L444'>                        <b>if</b> (data != NULL)
<a name='L445'>                                *data = (<b>void</b> *)ckh-&gt;tab[i].data;
<a name='L446'>                        *tabind = i + 1;
<a name='L447'>                        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L448'>                <font color='red'>}</font>
<a name='L449'>        <font color='red'>}</font>
<a name='L450'>
<a name='L451'>        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L452'><font color='red'>}</font>
<a name='L453'>
<a name='L454'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L455'><a href='../R/1599.html' title='Multiple refered from 4 places.'>ckh_insert</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <b>const</b> <b>void</b> *key, <b>const</b> <b>void</b> *data)
<a name='L456'><font color='red'>{</font>
<a name='L457'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret;
<a name='L458'>
<a name='L459'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L460'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1884.html' title='Multiple defined in 2 places.'>ckh_search</a>(ckh, key, NULL, NULL));
<a name='L461'>
<a name='L462'><font color='darkred'>#ifdef</font> CKH_COUNT
<a name='L463'>        ckh-&gt;ninserts++;
<a name='L464'><font color='darkred'>#endif</font>
<a name='L465'>
<a name='L466'>        <b>while</b> (<a href='../D/1890.html' title='Multiple defined in 2 places.'>ckh_try_insert</a>(ckh, &amp;key, &amp;data)) <font color='red'>{</font>
<a name='L467'>                <b>if</b> (<a href='../S/200.html#L245' title='Defined at 245 in deps/jemalloc/src/ckh.c.'>ckh_grow</a>(ckh)) <font color='red'>{</font>
<a name='L468'>                        ret = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L469'>                        <b>goto</b> label_return;
<a name='L470'>                <font color='red'>}</font>
<a name='L471'>        <font color='red'>}</font>
<a name='L472'>
<a name='L473'>        ret = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L474'>label_return:
<a name='L475'>        <b>return</b> (ret);
<a name='L476'><font color='red'>}</font>
<a name='L477'>
<a name='L478'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L479'><a href='../R/1607.html' title='Multiple refered from 4 places.'>ckh_remove</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <b>const</b> <b>void</b> *searchkey, <b>void</b> **key, <b>void</b> **data)
<a name='L480'><font color='red'>{</font>
<a name='L481'>        size_t cell;
<a name='L482'>
<a name='L483'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L484'>
<a name='L485'>        cell = <a href='../D/1875.html' title='Multiple defined in 2 places.'>ckh_isearch</a>(ckh, searchkey);
<a name='L486'>        <b>if</b> (cell != SIZE_T_MAX) <font color='red'>{</font>
<a name='L487'>                <b>if</b> (key != NULL)
<a name='L488'>                        *key = (<b>void</b> *)ckh-&gt;tab[cell].key;
<a name='L489'>                <b>if</b> (data != NULL)
<a name='L490'>                        *data = (<b>void</b> *)ckh-&gt;tab[cell].data;
<a name='L491'>                ckh-&gt;tab[cell].key = NULL;
<a name='L492'>                ckh-&gt;tab[cell].data = NULL; <i><font color='green'>/* Not necessary. */</font></i>
<a name='L493'>
<a name='L494'>                ckh-&gt;count--;
<a name='L495'>                <i><font color='green'>/* Try to halve the table if it is less than 1/4 full. */</font></i>
<a name='L496'>                <b>if</b> (ckh-&gt;count &lt; (ZU(1) &lt;&lt; (ckh-&gt;lg_curbuckets
<a name='L497'>                    + <a href='../S/134.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>LG_CKH_BUCKET_CELLS</a> - 2)) &amp;&amp; ckh-&gt;lg_curbuckets
<a name='L498'>                    &gt; ckh-&gt;lg_minbuckets) <font color='red'>{</font>
<a name='L499'>                        <i><font color='green'>/* Ignore error due to OOM. */</font></i>
<a name='L500'>                        <a href='../S/200.html#L300' title='Defined at 300 in deps/jemalloc/src/ckh.c.'>ckh_shrink</a>(ckh);
<a name='L501'>                <font color='red'>}</font>
<a name='L502'>
<a name='L503'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L504'>        <font color='red'>}</font>
<a name='L505'>
<a name='L506'>        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L507'><font color='red'>}</font>
<a name='L508'>
<a name='L509'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L510'><a href='../R/1609.html' title='Multiple refered from 5 places.'>ckh_search</a>(<a href='../S/134.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ckh.h.'>ckh_t</a> *ckh, <b>const</b> <b>void</b> *searchkey, <b>void</b> **key, <b>void</b> **data)
<a name='L511'><font color='red'>{</font>
<a name='L512'>        size_t cell;
<a name='L513'>
<a name='L514'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ckh != NULL);
<a name='L515'>
<a name='L516'>        cell = <a href='../D/1875.html' title='Multiple defined in 2 places.'>ckh_isearch</a>(ckh, searchkey);
<a name='L517'>        <b>if</b> (cell != SIZE_T_MAX) <font color='red'>{</font>
<a name='L518'>                <b>if</b> (key != NULL)
<a name='L519'>                        *key = (<b>void</b> *)ckh-&gt;tab[cell].key;
<a name='L520'>                <b>if</b> (data != NULL)
<a name='L521'>                        *data = (<b>void</b> *)ckh-&gt;tab[cell].data;
<a name='L522'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L523'>        <font color='red'>}</font>
<a name='L524'>
<a name='L525'>        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L526'><font color='red'>}</font>
<a name='L527'>
<a name='L528'><b>void</b>
<a name='L529'><a href='../R/1611.html' title='Multiple refered from 2 places.'>ckh_string_hash</a>(<b>const</b> <b>void</b> *key, <b>unsigned</b> minbits, size_t *hash1, size_t *hash2)
<a name='L530'><font color='red'>{</font>
<a name='L531'>        size_t ret1, ret2;
<a name='L532'>        <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> h;
<a name='L533'>
<a name='L534'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(minbits &lt;= 32 || (SIZEOF_PTR == 8 &amp;&amp; minbits &lt;= 64));
<a name='L535'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(hash1 != NULL);
<a name='L536'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(hash2 != NULL);
<a name='L537'>
<a name='L538'>        h = <a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(key, strlen((<b>const</b> <b>char</b> *)key), <a href='../S/160.html#L238' title='Defined at 238 in deps/jemalloc/include/msvc_compat/stdint.h.'>UINT64_C</a>(0x94122f335b332aea));
<a name='L539'>        <b>if</b> (minbits &lt;= 32) <font color='red'>{</font>
<a name='L540'>                <i><font color='green'>/*</font></i>
<a name='L541'><i><font color='green'>                 * Avoid doing multiple hashes, since a single hash provides</font></i>
<a name='L542'><i><font color='green'>                 * enough bits.</font></i>
<a name='L543'><i><font color='green'>                 */</font></i>
<a name='L544'>                ret1 = h &amp; ZU(0xffffffffU);
<a name='L545'>                ret2 = h &gt;&gt; 32;
<a name='L546'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L547'>                ret1 = h;
<a name='L548'>                ret2 = <a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(key, strlen((<b>const</b> <b>char</b> *)key),
<a name='L549'>                    <a href='../S/160.html#L238' title='Defined at 238 in deps/jemalloc/include/msvc_compat/stdint.h.'>UINT64_C</a>(0x8432a476666bbc13));
<a name='L550'>        <font color='red'>}</font>
<a name='L551'>
<a name='L552'>        *hash1 = ret1;
<a name='L553'>        *hash2 = ret2;
<a name='L554'><font color='red'>}</font>
<a name='L555'>
<a name='L556'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L557'><a href='../R/1612.html' title='Multiple refered from 2 places.'>ckh_string_keycomp</a>(<b>const</b> <b>void</b> *k1, <b>const</b> <b>void</b> *k2)
<a name='L558'><font color='red'>{</font>
<a name='L559'>
<a name='L560'>    <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(k1 != NULL);
<a name='L561'>    <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(k2 != NULL);
<a name='L562'>
<a name='L563'>    <b>return</b> (strcmp((<b>char</b> *)k1, (<b>char</b> *)k2) ? <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> : <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L564'><font color='red'>}</font>
<a name='L565'>
<a name='L566'><b>void</b>
<a name='L567'><a href='../R/1604.html' title='Multiple refered from 2 places.'>ckh_pointer_hash</a>(<b>const</b> <b>void</b> *key, <b>unsigned</b> minbits, size_t *hash1,
<a name='L568'>    size_t *hash2)
<a name='L569'><font color='red'>{</font>
<a name='L570'>        size_t ret1, ret2;
<a name='L571'>        <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> h;
<a name='L572'>        <b>union</b> <font color='red'>{</font>
<a name='L573'>                <b>const</b> <b>void</b>      *v;
<a name='L574'>                <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a>        i;
<a name='L575'>        <font color='red'>}</font> u;
<a name='L576'>
<a name='L577'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(minbits &lt;= 32 || (SIZEOF_PTR == 8 &amp;&amp; minbits &lt;= 64));
<a name='L578'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(hash1 != NULL);
<a name='L579'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(hash2 != NULL);
<a name='L580'>
<a name='L581'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<b>sizeof</b>(u.v) == <b>sizeof</b>(u.i));
<a name='L582'><font color='darkred'>#if</font> (LG_SIZEOF_PTR != LG_SIZEOF_INT)
<a name='L583'>        u.i = 0;
<a name='L584'><font color='darkred'>#endif</font>
<a name='L585'>        u.v = key;
<a name='L586'>        h = <a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(&amp;u.i, <b>sizeof</b>(u.i), <a href='../S/160.html#L238' title='Defined at 238 in deps/jemalloc/include/msvc_compat/stdint.h.'>UINT64_C</a>(0xd983396e68886082));
<a name='L587'>        <b>if</b> (minbits &lt;= 32) <font color='red'>{</font>
<a name='L588'>                <i><font color='green'>/*</font></i>
<a name='L589'><i><font color='green'>                 * Avoid doing multiple hashes, since a single hash provides</font></i>
<a name='L590'><i><font color='green'>                 * enough bits.</font></i>
<a name='L591'><i><font color='green'>                 */</font></i>
<a name='L592'>                ret1 = h &amp; ZU(0xffffffffU);
<a name='L593'>                ret2 = h &gt;&gt; 32;
<a name='L594'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L595'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(SIZEOF_PTR == 8);
<a name='L596'>                ret1 = h;
<a name='L597'>                ret2 = <a href='../D/2394.html' title='Multiple defined in 2 places.'>hash</a>(&amp;u.i, <b>sizeof</b>(u.i), <a href='../S/160.html#L238' title='Defined at 238 in deps/jemalloc/include/msvc_compat/stdint.h.'>UINT64_C</a>(0x5e2be9aff8709a5d));
<a name='L598'>        <font color='red'>}</font>
<a name='L599'>
<a name='L600'>        *hash1 = ret1;
<a name='L601'>        *hash2 = ret2;
<a name='L602'><font color='red'>}</font>
<a name='L603'>
<a name='L604'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L605'><a href='../R/1605.html' title='Multiple refered from 2 places.'>ckh_pointer_keycomp</a>(<b>const</b> <b>void</b> *k1, <b>const</b> <b>void</b> *k2)
<a name='L606'><font color='red'>{</font>
<a name='L607'>
<a name='L608'>        <b>return</b> ((k1 == k2) ? <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a> : <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L609'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L53'>[^]</a><a href='#L605'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
