<html>
<head>
<title>deps/jemalloc/src/arena.c</title>
<meta name='robots' content='noindex,nofollow'>
<meta name='generator' content='GLOBAL-5.7.1'>
</head>
<body text='#191970' bgcolor='#f5f5dc' vlink='gray'>
<a name='TOP'><h2><a href='../mains.html'>root</a>/<a href='../files/387.html'>deps</a>/<a href='../files/390.html'>jemalloc</a>/<a href='../files/395.html'>src</a>/arena.c</h2>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L91'>[^]</a><a href='#L2369'>[v]</a>[top]<a href='#BOTTOM'>[bottom]</a><a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
<hr>
<h2>DEFINITIONS</h2>
This source file includes following definitions.
<ol>
<li><a href='#L91' title='Defined at 91.'>arena_run_comp</a>
<li><a href='#L103' title='Defined at 103.'>rb_gen</a>
<li><a href='#L135' title='Defined at 135.'>rb_gen</a>
<li><a href='#L205' title='Defined at 205.'>rb_gen</a>
<li><a href='#L224' title='Defined at 224.'>arena_avail_adjac_succ</a>
<li><a href='#L240' title='Defined at 240.'>arena_avail_adjac</a>
<li><a href='#L248' title='Defined at 248.'>arena_avail_insert</a>
<li><a href='#L281' title='Defined at 281.'>arena_avail_remove</a>
<li><a href='#L315' title='Defined at 315.'>arena_run_reg_alloc</a>
<li><a href='#L336' title='Defined at 336.'>arena_run_reg_dalloc</a>
<li><a href='#L362' title='Defined at 362.'>arena_chunk_validate_zeroed</a>
<li><a href='#L372' title='Defined at 372.'>arena_run_split</a>
<li><a href='#L514' title='Defined at 514.'>arena_chunk_alloc</a>
<li><a href='#L589' title='Defined at 589.'>arena_chunk_dealloc</a>
<li><a href='#L621' title='Defined at 621.'>arena_run_alloc_helper</a>
<li><a href='#L645' title='Defined at 645.'>arena_run_alloc</a>
<li><a href='#L680' title='Defined at 680.'>arena_maybe_purge</a>
<li><a href='#L703' title='Defined at 703.'>arena_chunk_purge</a>
<li><a href='#L851' title='Defined at 851.'>chunks_dirty_iter_cb</a>
<li><a href='#L861' title='Defined at 861.'>arena_purge</a>
<li><a href='#L952' title='Defined at 952.'>arena_purge_all</a>
<li><a href='#L961' title='Defined at 961.'>arena_run_dalloc</a>
<li><a href='#L1097' title='Defined at 1097.'>arena_run_trim_head</a>
<li><a href='#L1129' title='Defined at 1129.'>arena_run_trim_tail</a>
<li><a href='#L1162' title='Defined at 1162.'>arena_bin_runs_first</a>
<li><a href='#L1183' title='Defined at 1183.'>arena_bin_runs_insert</a>
<li><a href='#L1195' title='Defined at 1195.'>arena_bin_runs_remove</a>
<li><a href='#L1207' title='Defined at 1207.'>arena_bin_nonfull_run_tryget</a>
<li><a href='#L1219' title='Defined at 1219.'>arena_bin_nonfull_run_get</a>
<li><a href='#L1276' title='Defined at 1276.'>arena_bin_malloc_hard</a>
<li><a href='#L1325' title='Defined at 1325.'>arena_prof_accum</a>
<li><a href='#L1340' title='Defined at 1340.'>arena_tcache_fill_small</a>
<li><a href='#L1384' title='Defined at 1384.'>arena_alloc_junk_small</a>
<li><a href='#L1400' title='Defined at 1400.'>arena_dalloc_junk_small</a>
<li><a href='#L1433' title='Defined at 1433.'>arena_malloc_small</a>
<li><a href='#L1489' title='Defined at 1489.'>arena_malloc_large</a>
<li><a href='#L1527' title='Defined at 1527.'>arena_palloc</a>
<li><a href='#L1581' title='Defined at 1581.'>arena_prof_promoted</a>
<li><a href='#L1604' title='Defined at 1604.'>arena_dissociate_bin_run</a>
<li><a href='#L1627' title='Defined at 1627.'>arena_dalloc_bin_run</a>
<li><a href='#L1678' title='Defined at 1678.'>arena_bin_lower_run</a>
<li><a href='#L1699' title='Defined at 1699.'>arena_dalloc_bin_locked</a>
<li><a href='#L1734' title='Defined at 1734.'>arena_dalloc_bin</a>
<li><a href='#L1749' title='Defined at 1749.'>arena_dalloc_small</a>
<li><a href='#L1764' title='Defined at 1764.'>arena_dalloc_large_locked</a>
<li><a href='#L1785' title='Defined at 1785.'>arena_dalloc_large</a>
<li><a href='#L1794' title='Defined at 1794.'>arena_ralloc_large_shrink</a>
<li><a href='#L1824' title='Defined at 1824.'>arena_ralloc_large_grow</a>
<li><a href='#L1894' title='Defined at 1894.'>arena_ralloc_large</a>
<li><a href='#L1938' title='Defined at 1938.'>arena_ralloc_no_move</a>
<li><a href='#L1974' title='Defined at 1974.'>arena_ralloc</a>
<li><a href='#L2030' title='Defined at 2030.'>arena_dss_prec_get</a>
<li><a href='#L2041' title='Defined at 2041.'>arena_dss_prec_set</a>
<li><a href='#L2050' title='Defined at 2050.'>arena_stats_merge</a>
<li><a href='#L2098' title='Defined at 2098.'>arena_new</a>
<li><a href='#L2163' title='Defined at 2163.'>bin_info_run_size_calc</a>
<li><a href='#L2302' title='Defined at 2302.'>bin_info_init</a>
<li><a href='#L2317' title='Defined at 2317.'>arena_boot</a>
<li><a href='#L2349' title='Defined at 2349.'>arena_prefork</a>
<li><a href='#L2359' title='Defined at 2359.'>arena_postfork_parent</a>
<li><a href='#L2369' title='Defined at 2369.'>arena_postfork_child</a>
</ol>
<hr>
<pre>
<a name='L1'><font color='darkred'>#define</font> <a href='../S/146.html#L479' title='Refered from 479 in deps/jemalloc/include/jemalloc/internal/arena.h.'>JEMALLOC_ARENA_C_</a>
<a name='L2'><font color='darkred'>#include</font> "jemalloc/internal/jemalloc_internal.h"
<a name='L3'>
<a name='L4'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L5'><i><font color='green'>/* Data. */</font></i>
<a name='L6'>
<a name='L7'>ssize_t         <a href='../S/138.html#L241' title='Defined at 241 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_lg_dirty_mult</a> = <a href='../S/146.html#L44' title='Defined at 44 in deps/jemalloc/include/jemalloc/internal/arena.h.'>LG_DIRTY_MULT_DEFAULT</a>;
<a name='L8'><a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a>        <a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[NBINS];
<a name='L9'>
<a name='L10'>JEMALLOC_ALIGNED(CACHELINE)
<a name='L11'><b>const</b> <a href='../D/4431.html' title='Multiple defined in 2 places.'>uint8_t</a>   small_size2bin[] = <font color='red'>{</font>
<a name='L12'><font color='darkred'>#define</font> <a href='../S/203.html#L13' title='Refered from 13 in deps/jemalloc/src/arena.c.'>S2B_8</a>(i)        i,
<a name='L13'><font color='darkred'>#define</font> <a href='../S/203.html#L14' title='Refered from 14 in deps/jemalloc/src/arena.c.'>S2B_16</a>(i)       <a href='../D/963.html' title='Multiple defined in 2 places.'>S2B_8</a>(i) <a href='../D/963.html' title='Multiple defined in 2 places.'>S2B_8</a>(i)
<a name='L14'><font color='darkred'>#define</font> <a href='../S/203.html#L15' title='Refered from 15 in deps/jemalloc/src/arena.c.'>S2B_32</a>(i)       <a href='../D/956.html' title='Multiple defined in 2 places.'>S2B_16</a>(i) <a href='../D/956.html' title='Multiple defined in 2 places.'>S2B_16</a>(i)
<a name='L15'><font color='darkred'>#define</font> <a href='../S/203.html#L16' title='Refered from 16 in deps/jemalloc/src/arena.c.'>S2B_64</a>(i)       <a href='../D/959.html' title='Multiple defined in 2 places.'>S2B_32</a>(i) <a href='../D/959.html' title='Multiple defined in 2 places.'>S2B_32</a>(i)
<a name='L16'><font color='darkred'>#define</font> <a href='../S/203.html#L17' title='Refered from 17 in deps/jemalloc/src/arena.c.'>S2B_128</a>(i)      <a href='../D/962.html' title='Multiple defined in 2 places.'>S2B_64</a>(i) <a href='../D/962.html' title='Multiple defined in 2 places.'>S2B_64</a>(i)
<a name='L17'><font color='darkred'>#define</font> <a href='../S/203.html#L18' title='Refered from 18 in deps/jemalloc/src/arena.c.'>S2B_256</a>(i)      <a href='../D/955.html' title='Multiple defined in 2 places.'>S2B_128</a>(i) <a href='../D/955.html' title='Multiple defined in 2 places.'>S2B_128</a>(i)
<a name='L18'><font color='darkred'>#define</font> <a href='../S/203.html#L19' title='Refered from 19 in deps/jemalloc/src/arena.c.'>S2B_512</a>(i)      <a href='../D/958.html' title='Multiple defined in 2 places.'>S2B_256</a>(i) <a href='../D/958.html' title='Multiple defined in 2 places.'>S2B_256</a>(i)
<a name='L19'><font color='darkred'>#define</font> <a href='../S/203.html#L20' title='Refered from 20 in deps/jemalloc/src/arena.c.'>S2B_1024</a>(i)     <a href='../D/961.html' title='Multiple defined in 2 places.'>S2B_512</a>(i) <a href='../D/961.html' title='Multiple defined in 2 places.'>S2B_512</a>(i)
<a name='L20'><font color='darkred'>#define</font> <a href='../S/203.html#L21' title='Refered from 21 in deps/jemalloc/src/arena.c.'>S2B_2048</a>(i)     <a href='../D/954.html' title='Multiple defined in 2 places.'>S2B_1024</a>(i) <a href='../D/954.html' title='Multiple defined in 2 places.'>S2B_1024</a>(i)
<a name='L21'><font color='darkred'>#define</font> <a href='../S/203.html#L22' title='Refered from 22 in deps/jemalloc/src/arena.c.'>S2B_4096</a>(i)     <a href='../D/957.html' title='Multiple defined in 2 places.'>S2B_2048</a>(i) <a href='../D/957.html' title='Multiple defined in 2 places.'>S2B_2048</a>(i)
<a name='L22'><font color='darkred'>#define</font> S2B_8192(i)     <a href='../D/960.html' title='Multiple defined in 2 places.'>S2B_4096</a>(i) <a href='../D/960.html' title='Multiple defined in 2 places.'>S2B_4096</a>(i)
<a name='L23'><font color='darkred'>#define</font> SIZE_CLASS(bin, delta, size)                                    \
<a name='L24'>        S2B_##delta(bin)
<a name='L25'>        SIZE_CLASSES
<a name='L26'><font color='darkred'>#undef</font> <a href='../S/203.html#L13' title='Refered from 13 in deps/jemalloc/src/arena.c.'>S2B_8</a>
<a name='L27'><font color='darkred'>#undef</font> <a href='../S/203.html#L14' title='Refered from 14 in deps/jemalloc/src/arena.c.'>S2B_16</a>
<a name='L28'><font color='darkred'>#undef</font> <a href='../S/203.html#L15' title='Refered from 15 in deps/jemalloc/src/arena.c.'>S2B_32</a>
<a name='L29'><font color='darkred'>#undef</font> <a href='../S/203.html#L16' title='Refered from 16 in deps/jemalloc/src/arena.c.'>S2B_64</a>
<a name='L30'><font color='darkred'>#undef</font> <a href='../S/203.html#L17' title='Refered from 17 in deps/jemalloc/src/arena.c.'>S2B_128</a>
<a name='L31'><font color='darkred'>#undef</font> <a href='../S/203.html#L18' title='Refered from 18 in deps/jemalloc/src/arena.c.'>S2B_256</a>
<a name='L32'><font color='darkred'>#undef</font> <a href='../S/203.html#L19' title='Refered from 19 in deps/jemalloc/src/arena.c.'>S2B_512</a>
<a name='L33'><font color='darkred'>#undef</font> <a href='../S/203.html#L20' title='Refered from 20 in deps/jemalloc/src/arena.c.'>S2B_1024</a>
<a name='L34'><font color='darkred'>#undef</font> <a href='../S/203.html#L21' title='Refered from 21 in deps/jemalloc/src/arena.c.'>S2B_2048</a>
<a name='L35'><font color='darkred'>#undef</font> <a href='../S/203.html#L22' title='Refered from 22 in deps/jemalloc/src/arena.c.'>S2B_4096</a>
<a name='L36'><font color='darkred'>#undef</font> S2B_8192
<a name='L37'><font color='darkred'>#undef</font> SIZE_CLASS
<a name='L38'><font color='red'>}</font>;
<a name='L39'>
<a name='L40'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L41'><i><font color='green'>/* Function prototypes for non-inline static functions. */</font></i>
<a name='L42'>
<a name='L43'><b>static</b> <b>void</b>     <a href='../S/203.html#L248' title='Defined at 248 in deps/jemalloc/src/arena.c.'>arena_avail_insert</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L44'>    size_t pageind, size_t npages, bool maybe_adjac_pred,
<a name='L45'>    bool maybe_adjac_succ);
<a name='L46'><b>static</b> <b>void</b>     <a href='../S/203.html#L281' title='Defined at 281 in deps/jemalloc/src/arena.c.'>arena_avail_remove</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L47'>    size_t pageind, size_t npages, bool maybe_adjac_pred,
<a name='L48'>    bool maybe_adjac_succ);
<a name='L49'><b>static</b> <b>void</b>     <a href='../S/203.html#L372' title='Defined at 372 in deps/jemalloc/src/arena.c.'>arena_run_split</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, size_t size,
<a name='L50'>    bool large, size_t binind, bool zero);
<a name='L51'><b>static</b> <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/203.html#L514' title='Defined at 514 in deps/jemalloc/src/arena.c.'>arena_chunk_alloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena);
<a name='L52'><b>static</b> <b>void</b>     <a href='../S/203.html#L589' title='Defined at 589 in deps/jemalloc/src/arena.c.'>arena_chunk_dealloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk);
<a name='L53'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>      *<a href='../S/203.html#L621' title='Defined at 621 in deps/jemalloc/src/arena.c.'>arena_run_alloc_helper</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size,
<a name='L54'>    bool large, size_t binind, bool zero);
<a name='L55'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *<a href='../S/203.html#L645' title='Defined at 645 in deps/jemalloc/src/arena.c.'>arena_run_alloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, bool large,
<a name='L56'>    size_t binind, bool zero);
<a name='L57'><b>static</b> <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a>    *<a href='../S/203.html#L851' title='Defined at 851 in deps/jemalloc/src/arena.c.'>chunks_dirty_iter_cb</a>(<a href='../S/146.html#L192' title='Defined at 192 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_tree_t</a> *tree,
<a name='L58'>    <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *arg);
<a name='L59'><b>static</b> <b>void</b>     <a href='../S/203.html#L861' title='Defined at 861 in deps/jemalloc/src/arena.c.'>arena_purge</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, bool all);
<a name='L60'><b>static</b> <b>void</b>     <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, bool dirty,
<a name='L61'>    bool cleaned);
<a name='L62'><b>static</b> <b>void</b>     <a href='../S/203.html#L1097' title='Defined at 1097 in deps/jemalloc/src/arena.c.'>arena_run_trim_head</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L63'>    <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, size_t oldsize, size_t newsize);
<a name='L64'><b>static</b> <b>void</b>     <a href='../S/203.html#L1129' title='Defined at 1129 in deps/jemalloc/src/arena.c.'>arena_run_trim_tail</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L65'>    <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, size_t oldsize, size_t newsize, bool dirty);
<a name='L66'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>      *<a href='../S/203.html#L1162' title='Defined at 1162 in deps/jemalloc/src/arena.c.'>arena_bin_runs_first</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L67'><b>static</b> <b>void</b>     <a href='../S/203.html#L1183' title='Defined at 1183 in deps/jemalloc/src/arena.c.'>arena_bin_runs_insert</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run);
<a name='L68'><b>static</b> <b>void</b>     <a href='../S/203.html#L1195' title='Defined at 1195 in deps/jemalloc/src/arena.c.'>arena_bin_runs_remove</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run);
<a name='L69'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *<a href='../S/203.html#L1207' title='Defined at 1207 in deps/jemalloc/src/arena.c.'>arena_bin_nonfull_run_tryget</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L70'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *<a href='../S/203.html#L1219' title='Defined at 1219 in deps/jemalloc/src/arena.c.'>arena_bin_nonfull_run_get</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L71'><b>static</b> <b>void</b>     *<a href='../S/203.html#L1276' title='Defined at 1276 in deps/jemalloc/src/arena.c.'>arena_bin_malloc_hard</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L72'><b>static</b> <b>void</b>     <a href='../S/203.html#L1604' title='Defined at 1604 in deps/jemalloc/src/arena.c.'>arena_dissociate_bin_run</a>(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L73'>    <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L74'><b>static</b> <b>void</b>     <a href='../S/203.html#L1627' title='Defined at 1627 in deps/jemalloc/src/arena.c.'>arena_dalloc_bin_run</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L75'>    <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L76'><b>static</b> <b>void</b>     <a href='../S/203.html#L1678' title='Defined at 1678 in deps/jemalloc/src/arena.c.'>arena_bin_lower_run</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L77'>    <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin);
<a name='L78'><b>static</b> <b>void</b>     <a href='../S/203.html#L1794' title='Defined at 1794 in deps/jemalloc/src/arena.c.'>arena_ralloc_large_shrink</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L79'>    <b>void</b> *ptr, size_t oldsize, size_t size);
<a name='L80'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>     <a href='../S/203.html#L1824' title='Defined at 1824 in deps/jemalloc/src/arena.c.'>arena_ralloc_large_grow</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk,
<a name='L81'>    <b>void</b> *ptr, size_t oldsize, size_t size, size_t extra, bool zero);
<a name='L82'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>     <a href='../S/203.html#L1894' title='Defined at 1894 in deps/jemalloc/src/arena.c.'>arena_ralloc_large</a>(<b>void</b> *ptr, size_t oldsize, size_t size,
<a name='L83'>    size_t extra, bool zero);
<a name='L84'><b>static</b> size_t   <a href='../S/203.html#L2163' title='Defined at 2163 in deps/jemalloc/src/arena.c.'>bin_info_run_size_calc</a>(<a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info,
<a name='L85'>    size_t min_run_size);
<a name='L86'><b>static</b> <b>void</b>     <a href='../S/203.html#L2302' title='Defined at 2302 in deps/jemalloc/src/arena.c.'>bin_info_init</a>(<b>void</b>);
<a name='L87'>
<a name='L88'><i><font color='green'>/******************************************************************************/</font></i>
<a name='L89'>
<a name='L90'><b>static</b> <b>inline</b> <b>int</b>
<a name='L91'>arena_run_comp(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *a, <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *b)
<a name='L92'><font color='red'>{</font>
<a name='L93'>        <a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a> a_mapelm = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)a;
<a name='L94'>        <a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a> b_mapelm = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)b;
<a name='L95'>
<a name='L96'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(a != NULL);
<a name='L97'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(b != NULL);
<a name='L98'>
<a name='L99'>        <b>return</b> ((a_mapelm &gt; b_mapelm) - (a_mapelm &lt; b_mapelm));
<a name='L100'><font color='red'>}</font>
<a name='L101'>
<a name='L102'><i><font color='green'>/* Generate red-black tree functions. */</font></i>
<a name='L103'><a href='../S/197.html#L38' title='Refered from 38 in deps/jemalloc/src/extent.c.'>rb_gen</a>(<b>static</b> <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a>, arena_run_tree_, <a href='../S/146.html#L160' title='Defined at 160 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_tree_t</a>, <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>,
<a name='L104'>    u.rb_link, arena_run_comp)
<a name='L105'>
<a name='L106'><b>static</b> <b>inline</b> <b>int</b>
<a name='L107'>arena_avail_comp(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *a, <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *b)
<a name='L108'><font color='red'>{</font>
<a name='L109'>        <b>int</b> ret;
<a name='L110'>        size_t a_size = a-&gt;bits &amp; ~PAGE_MASK;
<a name='L111'>        size_t b_size = b-&gt;bits &amp; ~PAGE_MASK;
<a name='L112'>
<a name='L113'>        ret = (a_size &gt; b_size) - (a_size &lt; b_size);
<a name='L114'>        <b>if</b> (ret == 0) <font color='red'>{</font>
<a name='L115'>                <a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a> a_mapelm, b_mapelm;
<a name='L116'>
<a name='L117'>                <b>if</b> ((a-&gt;bits &amp; <a href='../S/146.html#L157' title='Defined at 157 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_KEY</a>) != <a href='../S/146.html#L157' title='Defined at 157 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_KEY</a>)
<a name='L118'>                        a_mapelm = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)a;
<a name='L119'>                <b>else</b> <font color='red'>{</font>
<a name='L120'>                        <i><font color='green'>/*</font></i>
<a name='L121'><i><font color='green'>                         * Treat keys as though they are lower than anything</font></i>
<a name='L122'><i><font color='green'>                         * else.</font></i>
<a name='L123'><i><font color='green'>                         */</font></i>
<a name='L124'>                        a_mapelm = 0;
<a name='L125'>                <font color='red'>}</font>
<a name='L126'>                b_mapelm = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)b;
<a name='L127'>
<a name='L128'>                ret = (a_mapelm &gt; b_mapelm) - (a_mapelm &lt; b_mapelm);
<a name='L129'>        <font color='red'>}</font>
<a name='L130'>
<a name='L131'>        <b>return</b> (ret);
<a name='L132'><font color='red'>}</font>
<a name='L133'>
<a name='L134'><i><font color='green'>/* Generate red-black tree functions. */</font></i>
<a name='L135'><a href='../S/197.html#L38' title='Refered from 38 in deps/jemalloc/src/extent.c.'>rb_gen</a>(<b>static</b> <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a>, arena_avail_tree_, <a href='../S/146.html#L159' title='Defined at 159 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_avail_tree_t</a>, <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>,
<a name='L136'>    u.rb_link, arena_avail_comp)
<a name='L137'>
<a name='L138'><b>static</b> <b>inline</b> <b>int</b>
<a name='L139'>arena_chunk_dirty_comp(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *a, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *b)
<a name='L140'><font color='red'>{</font>
<a name='L141'>
<a name='L142'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(a != NULL);
<a name='L143'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(b != NULL);
<a name='L144'>
<a name='L145'>        <i><font color='green'>/*</font></i>
<a name='L146'><i><font color='green'>         * Short-circuit for self comparison.  The following comparison code</font></i>
<a name='L147'><i><font color='green'>         * would come to the same result, but at the cost of executing the slow</font></i>
<a name='L148'><i><font color='green'>         * path.</font></i>
<a name='L149'><i><font color='green'>         */</font></i>
<a name='L150'>        <b>if</b> (a == b)
<a name='L151'>                <b>return</b> (0);
<a name='L152'>
<a name='L153'>        <i><font color='green'>/*</font></i>
<a name='L154'><i><font color='green'>         * Order such that chunks with higher fragmentation are "less than"</font></i>
<a name='L155'><i><font color='green'>         * those with lower fragmentation -- purging order is from "least" to</font></i>
<a name='L156'><i><font color='green'>         * "greatest".  Fragmentation is measured as:</font></i>
<a name='L157'><i><font color='green'>         *</font></i>
<a name='L158'><i><font color='green'>         *     mean current avail run size</font></i>
<a name='L159'><i><font color='green'>         *   --------------------------------</font></i>
<a name='L160'><i><font color='green'>         *   mean defragmented avail run size</font></i>
<a name='L161'><i><font color='green'>         *</font></i>
<a name='L162'><i><font color='green'>         *            navail</font></i>
<a name='L163'><i><font color='green'>         *         -----------</font></i>
<a name='L164'><i><font color='green'>         *         nruns_avail           nruns_avail-nruns_adjac</font></i>
<a name='L165'><i><font color='green'>         * = ========================= = -----------------------</font></i>
<a name='L166'><i><font color='green'>         *            navail                  nruns_avail</font></i>
<a name='L167'><i><font color='green'>         *    -----------------------</font></i>
<a name='L168'><i><font color='green'>         *    nruns_avail-nruns_adjac</font></i>
<a name='L169'><i><font color='green'>         *</font></i>
<a name='L170'><i><font color='green'>         * The following code multiplies away the denominator prior to</font></i>
<a name='L171'><i><font color='green'>         * comparison, in order to avoid division.</font></i>
<a name='L172'><i><font color='green'>         *</font></i>
<a name='L173'><i><font color='green'>         */</font></i>
<a name='L174'>        <font color='red'>{</font>
<a name='L175'>                size_t a_val = (a-&gt;nruns_avail - a-&gt;nruns_adjac) *
<a name='L176'>                    b-&gt;nruns_avail;
<a name='L177'>                size_t b_val = (b-&gt;nruns_avail - b-&gt;nruns_adjac) *
<a name='L178'>                    a-&gt;nruns_avail;
<a name='L179'>
<a name='L180'>                <b>if</b> (a_val &lt; b_val)
<a name='L181'>                        <b>return</b> (1);
<a name='L182'>                <b>if</b> (a_val &gt; b_val)
<a name='L183'>                        <b>return</b> (-1);
<a name='L184'>        <font color='red'>}</font>
<a name='L185'>        <i><font color='green'>/*</font></i>
<a name='L186'><i><font color='green'>         * Break ties by chunk address.  For fragmented chunks, report lower</font></i>
<a name='L187'><i><font color='green'>         * addresses as "lower", so that fragmentation reduction happens first</font></i>
<a name='L188'><i><font color='green'>         * at lower addresses.  However, use the opposite ordering for</font></i>
<a name='L189'><i><font color='green'>         * unfragmented chunks, in order to increase the chances of</font></i>
<a name='L190'><i><font color='green'>         * re-allocating dirty runs.</font></i>
<a name='L191'><i><font color='green'>         */</font></i>
<a name='L192'>        <font color='red'>{</font>
<a name='L193'>                <a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a> a_chunk = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)a;
<a name='L194'>                <a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a> b_chunk = (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)b;
<a name='L195'>                <b>int</b> ret = ((a_chunk &gt; b_chunk) - (a_chunk &lt; b_chunk));
<a name='L196'>                <b>if</b> (a-&gt;nruns_adjac == 0) <font color='red'>{</font>
<a name='L197'>                        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(b-&gt;nruns_adjac == 0);
<a name='L198'>                        ret = -ret;
<a name='L199'>                <font color='red'>}</font>
<a name='L200'>                <b>return</b> (ret);
<a name='L201'>        <font color='red'>}</font>
<a name='L202'><font color='red'>}</font>
<a name='L203'>
<a name='L204'><i><font color='green'>/* Generate red-black tree functions. */</font></i>
<a name='L205'><a href='../S/197.html#L38' title='Refered from 38 in deps/jemalloc/src/extent.c.'>rb_gen</a>(<b>static</b> <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a>, arena_chunk_dirty_, <a href='../S/146.html#L192' title='Defined at 192 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_tree_t</a>, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a>,
<a name='L206'>    dirty_link, arena_chunk_dirty_comp)
<a name='L207'>
<a name='L208'><b>static</b> <b>inline</b> bool
<a name='L209'>arena_avail_adjac_pred(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t pageind)
<a name='L210'><font color='red'>{</font>
<a name='L211'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret;
<a name='L212'>
<a name='L213'>        <b>if</b> (pageind-1 &lt; <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>)
<a name='L214'>                ret = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L215'>        <b>else</b> <font color='red'>{</font>
<a name='L216'>                ret = (<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind-1) == 0);
<a name='L217'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ret == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> || <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L218'>                    pageind-1) != <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind));
<a name='L219'>        <font color='red'>}</font>
<a name='L220'>        <b>return</b> (ret);
<a name='L221'><font color='red'>}</font>
<a name='L222'>
<a name='L223'><b>static</b> <b>inline</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L224'><a href='../R/1303.html' title='Multiple refered from 3 places.'>arena_avail_adjac_succ</a>(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t pageind, size_t npages)
<a name='L225'><font color='red'>{</font>
<a name='L226'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret;
<a name='L227'>
<a name='L228'>        <b>if</b> (pageind+npages == <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>)
<a name='L229'>                ret = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L230'>        <b>else</b> <font color='red'>{</font>
<a name='L231'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(pageind+npages &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>);
<a name='L232'>                ret = (<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages) == 0);
<a name='L233'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ret == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> || <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind)
<a name='L234'>                    != <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages));
<a name='L235'>        <font color='red'>}</font>
<a name='L236'>        <b>return</b> (ret);
<a name='L237'><font color='red'>}</font>
<a name='L238'>
<a name='L239'><b>static</b> <b>inline</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L240'><a href='../S/203.html#L762' title='Refered from 762 in deps/jemalloc/src/arena.c.'>arena_avail_adjac</a>(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t pageind, size_t npages)
<a name='L241'><font color='red'>{</font>
<a name='L242'>
<a name='L243'>        <b>return</b> (arena_avail_adjac_pred(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) ||
<a name='L244'>            <a href='../S/203.html#L224' title='Defined at 224 in deps/jemalloc/src/arena.c.'>arena_avail_adjac_succ</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, npages));
<a name='L245'><font color='red'>}</font>
<a name='L246'>
<a name='L247'><b>static</b> <b>void</b>
<a name='L248'><a href='../R/1304.html' title='Multiple refered from 4 places.'>arena_avail_insert</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t pageind,
<a name='L249'>    size_t npages, bool maybe_adjac_pred, bool maybe_adjac_succ)
<a name='L250'><font color='red'>{</font>
<a name='L251'>
<a name='L252'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(npages == (<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) &gt;&gt;
<a name='L253'>            LG_PAGE));
<a name='L254'>
<a name='L255'>        <i><font color='green'>/*</font></i>
<a name='L256'><i><font color='green'>         * chunks_dirty is keyed by nruns_{avail,adjac}, so the chunk must be</font></i>
<a name='L257'><i><font color='green'>         * removed and reinserted even if the run to be inserted is clean.</font></i>
<a name='L258'><i><font color='green'>         */</font></i>
<a name='L259'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty != 0)
<a name='L260'>                arena_chunk_dirty_remove(&amp;arena-&gt;chunks_dirty, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L261'>
<a name='L262'>        <b>if</b> (maybe_adjac_pred &amp;&amp; arena_avail_adjac_pred(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind))
<a name='L263'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac++;
<a name='L264'>        <b>if</b> (maybe_adjac_succ &amp;&amp; <a href='../S/203.html#L224' title='Defined at 224 in deps/jemalloc/src/arena.c.'>arena_avail_adjac_succ</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, npages))
<a name='L265'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac++;
<a name='L266'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail++;
<a name='L267'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail &gt; <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac);
<a name='L268'>
<a name='L269'>        <b>if</b> (<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) != 0) <font color='red'>{</font>
<a name='L270'>                arena-&gt;ndirty += npages;
<a name='L271'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty += npages;
<a name='L272'>        <font color='red'>}</font>
<a name='L273'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty != 0)
<a name='L274'>                arena_chunk_dirty_insert(&amp;arena-&gt;chunks_dirty, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L275'>
<a name='L276'>        arena_avail_tree_insert(&amp;arena-&gt;runs_avail, <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L277'>            pageind));
<a name='L278'><font color='red'>}</font>
<a name='L279'>
<a name='L280'><b>static</b> <b>void</b>
<a name='L281'><a href='../R/1305.html' title='Multiple refered from 5 places.'>arena_avail_remove</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t pageind,
<a name='L282'>    size_t npages, bool maybe_adjac_pred, bool maybe_adjac_succ)
<a name='L283'><font color='red'>{</font>
<a name='L284'>
<a name='L285'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(npages == (<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) &gt;&gt;
<a name='L286'>            LG_PAGE));
<a name='L287'>
<a name='L288'>        <i><font color='green'>/*</font></i>
<a name='L289'><i><font color='green'>         * chunks_dirty is keyed by nruns_{avail,adjac}, so the chunk must be</font></i>
<a name='L290'><i><font color='green'>         * removed and reinserted even if the run to be removed is clean.</font></i>
<a name='L291'><i><font color='green'>         */</font></i>
<a name='L292'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty != 0)
<a name='L293'>                arena_chunk_dirty_remove(&amp;arena-&gt;chunks_dirty, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L294'>
<a name='L295'>        <b>if</b> (maybe_adjac_pred &amp;&amp; arena_avail_adjac_pred(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind))
<a name='L296'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac--;
<a name='L297'>        <b>if</b> (maybe_adjac_succ &amp;&amp; <a href='../S/203.html#L224' title='Defined at 224 in deps/jemalloc/src/arena.c.'>arena_avail_adjac_succ</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, npages))
<a name='L298'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac--;
<a name='L299'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail--;
<a name='L300'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail &gt; <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac || (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail
<a name='L301'>            == 0 &amp;&amp; <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac == 0));
<a name='L302'>
<a name='L303'>        <b>if</b> (<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) != 0) <font color='red'>{</font>
<a name='L304'>                arena-&gt;ndirty -= npages;
<a name='L305'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty -= npages;
<a name='L306'>        <font color='red'>}</font>
<a name='L307'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty != 0)
<a name='L308'>                arena_chunk_dirty_insert(&amp;arena-&gt;chunks_dirty, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L309'>
<a name='L310'>        arena_avail_tree_remove(&amp;arena-&gt;runs_avail, <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L311'>            pageind));
<a name='L312'><font color='red'>}</font>
<a name='L313'>
<a name='L314'><b>static</b> <b>inline</b> <b>void</b> *
<a name='L315'><a href='../R/1383.html' title='Multiple refered from 4 places.'>arena_run_reg_alloc</a>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info)
<a name='L316'><font color='red'>{</font>
<a name='L317'>        <b>void</b> *ret;
<a name='L318'>        <b>unsigned</b> regind;
<a name='L319'>        <a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *bitmap = (<a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L320'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;bitmap_offset);
<a name='L321'>
<a name='L322'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run-&gt;nfree &gt; 0);
<a name='L323'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1741.html' title='Multiple defined in 2 places.'>bitmap_full</a>(bitmap, &amp;bin_info-&gt;bitmap_info) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L324'>
<a name='L325'>        regind = <a href='../D/1751.html' title='Multiple defined in 2 places.'>bitmap_sfu</a>(bitmap, &amp;bin_info-&gt;bitmap_info);
<a name='L326'>        ret = (<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;reg0_offset +
<a name='L327'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)(bin_info-&gt;reg_interval * regind));
<a name='L328'>        run-&gt;nfree--;
<a name='L329'>        <b>if</b> (regind == run-&gt;nextind)
<a name='L330'>                run-&gt;nextind++;
<a name='L331'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(regind &lt; run-&gt;nextind);
<a name='L332'>        <b>return</b> (ret);
<a name='L333'><font color='red'>}</font>
<a name='L334'>
<a name='L335'><b>static</b> <b>inline</b> <b>void</b>
<a name='L336'><a href='../S/203.html#L1720' title='Refered from 1720 in deps/jemalloc/src/arena.c.'>arena_run_reg_dalloc</a>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, <b>void</b> *ptr)
<a name='L337'><font color='red'>{</font>
<a name='L338'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L339'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L340'>        size_t mapbits = <a href='../D/1614.html' title='Multiple defined in 2 places.'>arena_mapbits_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L341'>        size_t binind = <a href='../D/1639.html' title='Multiple defined in 2 places.'>arena_ptr_small_binind_get</a>(ptr, mapbits);
<a name='L342'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L343'>        <b>unsigned</b> regind = <a href='../D/1653.html' title='Multiple defined in 2 places.'>arena_run_regind</a>(run, bin_info, ptr);
<a name='L344'>        <a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *bitmap = (<a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L345'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;bitmap_offset);
<a name='L346'>
<a name='L347'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run-&gt;nfree &lt; bin_info-&gt;nregs);
<a name='L348'>        <i><font color='green'>/* Freeing an interior pointer can cause assertion failure. */</font></i>
<a name='L349'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L350'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;reg0_offset)) %
<a name='L351'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;reg_interval == 0);
<a name='L352'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr &gt;= (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L353'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;reg0_offset);
<a name='L354'>        <i><font color='green'>/* Freeing an unallocated pointer can cause assertion failure. */</font></i>
<a name='L355'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1742.html' title='Multiple defined in 2 places.'>bitmap_get</a>(bitmap, &amp;bin_info-&gt;bitmap_info, regind));
<a name='L356'>
<a name='L357'>        <a href='../D/1754.html' title='Multiple defined in 2 places.'>bitmap_unset</a>(bitmap, &amp;bin_info-&gt;bitmap_info, regind);
<a name='L358'>        run-&gt;nfree++;
<a name='L359'><font color='red'>}</font>
<a name='L360'>
<a name='L361'><b>static</b> <b>inline</b> <b>void</b>
<a name='L362'><a href='../R/1329.html' title='Multiple refered from 4 places.'>arena_chunk_validate_zeroed</a>(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, size_t run_ind)
<a name='L363'><font color='red'>{</font>
<a name='L364'>        size_t i;
<a name='L365'>        <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a> size_t *p = (size_t *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (run_ind &lt;&lt; LG_PAGE));
<a name='L366'>
<a name='L367'>        <b>for</b> (i = 0; i &lt; PAGE / <b>sizeof</b>(size_t); i++)
<a name='L368'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(p[i] == 0);
<a name='L369'><font color='red'>}</font>
<a name='L370'>
<a name='L371'><b>static</b> <b>void</b>
<a name='L372'><a href='../R/1387.html' title='Multiple refered from 5 places.'>arena_run_split</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, size_t size, bool large,
<a name='L373'>    size_t binind, bool zero)
<a name='L374'><font color='red'>{</font>
<a name='L375'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L376'>        size_t run_ind, total_pages, need_pages, rem_pages, i;
<a name='L377'>        size_t flag_dirty;
<a name='L378'>
<a name='L379'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((large &amp;&amp; binind == <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>) || (large == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> &amp;&amp; binind
<a name='L380'>            != <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>));
<a name='L381'>
<a name='L382'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L383'>        run_ind = (<b>unsigned</b>)(((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE);
<a name='L384'>        flag_dirty = <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind);
<a name='L385'>        total_pages = <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) &gt;&gt;
<a name='L386'>            LG_PAGE;
<a name='L387'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+total_pages-1) ==
<a name='L388'>            flag_dirty);
<a name='L389'>        need_pages = (size &gt;&gt; LG_PAGE);
<a name='L390'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(need_pages &gt; 0);
<a name='L391'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(need_pages &lt;= total_pages);
<a name='L392'>        rem_pages = total_pages - need_pages;
<a name='L393'>
<a name='L394'>        <a href='../S/203.html#L281' title='Defined at 281 in deps/jemalloc/src/arena.c.'>arena_avail_remove</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, total_pages, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L395'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L396'>                <i><font color='green'>/*</font></i>
<a name='L397'><i><font color='green'>                 * Update stats_cactive if nactive is crossing a chunk</font></i>
<a name='L398'><i><font color='green'>                 * multiple.</font></i>
<a name='L399'><i><font color='green'>                 */</font></i>
<a name='L400'>                size_t cactive_diff = <a href='../S/142.html#L19' title='Defined at 19 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_CEILING</a>((arena-&gt;nactive +
<a name='L401'>                    need_pages) &lt;&lt; LG_PAGE) - <a href='../S/142.html#L19' title='Defined at 19 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_CEILING</a>(arena-&gt;nactive &lt;&lt;
<a name='L402'>                    LG_PAGE);
<a name='L403'>                <b>if</b> (cactive_diff != 0)
<a name='L404'>                        <a href='../D/4211.html' title='Multiple defined in 2 places.'>stats_cactive_add</a>(cactive_diff);
<a name='L405'>        <font color='red'>}</font>
<a name='L406'>        arena-&gt;nactive += need_pages;
<a name='L407'>
<a name='L408'>        <i><font color='green'>/* Keep track of trailing unused pages for later use. */</font></i>
<a name='L409'>        <b>if</b> (rem_pages &gt; 0) <font color='red'>{</font>
<a name='L410'>                <b>if</b> (flag_dirty != 0) <font color='red'>{</font>
<a name='L411'>                        <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages,
<a name='L412'>                            (rem_pages &lt;&lt; LG_PAGE), <a href='../S/146.html#L153' title='Defined at 153 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_DIRTY</a>);
<a name='L413'>                        <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L414'>                            run_ind+total_pages-1, (rem_pages &lt;&lt; LG_PAGE),
<a name='L415'>                            <a href='../S/146.html#L153' title='Defined at 153 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_DIRTY</a>);
<a name='L416'>                <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L417'>                        <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages,
<a name='L418'>                            (rem_pages &lt;&lt; LG_PAGE),
<a name='L419'>                            <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L420'>                            run_ind+need_pages));
<a name='L421'>                        <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L422'>                            run_ind+total_pages-1, (rem_pages &lt;&lt; LG_PAGE),
<a name='L423'>                            <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L424'>                            run_ind+total_pages-1));
<a name='L425'>                <font color='red'>}</font>
<a name='L426'>                <a href='../S/203.html#L248' title='Defined at 248 in deps/jemalloc/src/arena.c.'>arena_avail_insert</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages, rem_pages,
<a name='L427'>                    <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L428'>        <font color='red'>}</font>
<a name='L429'>
<a name='L430'>        <i><font color='green'>/*</font></i>
<a name='L431'><i><font color='green'>         * Update the page map separately for large vs. small runs, since it is</font></i>
<a name='L432'><i><font color='green'>         * possible to avoid iteration for large mallocs.</font></i>
<a name='L433'><i><font color='green'>         */</font></i>
<a name='L434'>        <b>if</b> (large) <font color='red'>{</font>
<a name='L435'>                <b>if</b> (zero) <font color='red'>{</font>
<a name='L436'>                        <b>if</b> (flag_dirty == 0) <font color='red'>{</font>
<a name='L437'>                                <i><font color='green'>/*</font></i>
<a name='L438'><i><font color='green'>                                 * The run is clean, so some pages may be</font></i>
<a name='L439'><i><font color='green'>                                 * zeroed (i.e. never before touched).</font></i>
<a name='L440'><i><font color='green'>                                 */</font></i>
<a name='L441'>                                <b>for</b> (i = 0; i &lt; need_pages; i++) <font color='red'>{</font>
<a name='L442'>                                        <b>if</b> (<a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L443'>                                            run_ind+i) != 0) <font color='red'>{</font>
<a name='L444'>                                                VALGRIND_MAKE_MEM_UNDEFINED(
<a name='L445'>                                                    (<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)
<a name='L446'>                                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + ((run_ind+i) &lt;&lt;
<a name='L447'>                                                    LG_PAGE)), PAGE);
<a name='L448'>                                                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)
<a name='L449'>                                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + ((run_ind+i) &lt;&lt;
<a name='L450'>                                                    LG_PAGE)), 0, PAGE);
<a name='L451'>                                        <font color='red'>}</font> <b>else</b> <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L452'>                                                VALGRIND_MAKE_MEM_DEFINED(
<a name='L453'>                                                    (<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)
<a name='L454'>                                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + ((run_ind+i) &lt;&lt;
<a name='L455'>                                                    LG_PAGE)), PAGE);
<a name='L456'>                                                <a href='../S/203.html#L362' title='Defined at 362 in deps/jemalloc/src/arena.c.'>arena_chunk_validate_zeroed</a>(
<a name='L457'>                                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+i);
<a name='L458'>                                        <font color='red'>}</font>
<a name='L459'>                                <font color='red'>}</font>
<a name='L460'>                        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L461'>                                <i><font color='green'>/*</font></i>
<a name='L462'><i><font color='green'>                                 * The run is dirty, so all pages must be</font></i>
<a name='L463'><i><font color='green'>                                 * zeroed.</font></i>
<a name='L464'><i><font color='green'>                                 */</font></i>
<a name='L465'>                                VALGRIND_MAKE_MEM_UNDEFINED((<b>void</b>
<a name='L466'>                                    *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (run_ind &lt;&lt;
<a name='L467'>                                    LG_PAGE)), (need_pages &lt;&lt; LG_PAGE));
<a name='L468'>                                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (run_ind &lt;&lt;
<a name='L469'>                                    LG_PAGE)), 0, (need_pages &lt;&lt; LG_PAGE));
<a name='L470'>                        <font color='red'>}</font>
<a name='L471'>                <font color='red'>}</font>
<a name='L472'>
<a name='L473'>                <i><font color='green'>/*</font></i>
<a name='L474'><i><font color='green'>                 * Set the last element first, in case the run only contains one</font></i>
<a name='L475'><i><font color='green'>                 * page (i.e. both statements set the same element).</font></i>
<a name='L476'><i><font color='green'>                 */</font></i>
<a name='L477'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages-1, 0,
<a name='L478'>                    flag_dirty);
<a name='L479'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, size, flag_dirty);
<a name='L480'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L481'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L482'>                <i><font color='green'>/*</font></i>
<a name='L483'><i><font color='green'>                 * Propagate the dirty and unzeroed flags to the allocated</font></i>
<a name='L484'><i><font color='green'>                 * small run, so that arena_dalloc_bin_run() has the ability to</font></i>
<a name='L485'><i><font color='green'>                 * conditionally trim clean pages.</font></i>
<a name='L486'><i><font color='green'>                 */</font></i>
<a name='L487'>                <a href='../D/1620.html' title='Multiple defined in 2 places.'>arena_mapbits_small_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, 0, binind, flag_dirty);
<a name='L488'>                <i><font color='green'>/*</font></i>
<a name='L489'><i><font color='green'>                 * The first page will always be dirtied during small run</font></i>
<a name='L490'><i><font color='green'>                 * initialization, so a validation failure here would not</font></i>
<a name='L491'><i><font color='green'>                 * actually cause an observable failure.</font></i>
<a name='L492'><i><font color='green'>                 */</font></i>
<a name='L493'>                <b>if</b> (config_debug &amp;&amp; flag_dirty == 0 &amp;&amp;
<a name='L494'>                    <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) == 0)
<a name='L495'>                        <a href='../S/203.html#L362' title='Defined at 362 in deps/jemalloc/src/arena.c.'>arena_chunk_validate_zeroed</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind);
<a name='L496'>                <b>for</b> (i = 1; i &lt; need_pages - 1; i++) <font color='red'>{</font>
<a name='L497'>                        <a href='../D/1620.html' title='Multiple defined in 2 places.'>arena_mapbits_small_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+i, i, binind, 0);
<a name='L498'>                        <b>if</b> (config_debug &amp;&amp; flag_dirty == 0 &amp;&amp;
<a name='L499'>                            <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+i) == 0)
<a name='L500'>                                <a href='../S/203.html#L362' title='Defined at 362 in deps/jemalloc/src/arena.c.'>arena_chunk_validate_zeroed</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+i);
<a name='L501'>                <font color='red'>}</font>
<a name='L502'>                <a href='../D/1620.html' title='Multiple defined in 2 places.'>arena_mapbits_small_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages-1,
<a name='L503'>                    need_pages-1, binind, flag_dirty);
<a name='L504'>                <b>if</b> (config_debug &amp;&amp; flag_dirty == 0 &amp;&amp;
<a name='L505'>                    <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+need_pages-1) ==
<a name='L506'>                    0) <font color='red'>{</font>
<a name='L507'>                        <a href='../S/203.html#L362' title='Defined at 362 in deps/jemalloc/src/arena.c.'>arena_chunk_validate_zeroed</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L508'>                            run_ind+need_pages-1);
<a name='L509'>                <font color='red'>}</font>
<a name='L510'>        <font color='red'>}</font>
<a name='L511'><font color='red'>}</font>
<a name='L512'>
<a name='L513'><b>static</b> <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *
<a name='L514'><a href='../R/1321.html' title='Multiple refered from 3 places.'>arena_chunk_alloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L515'><font color='red'>{</font>
<a name='L516'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L517'>        size_t i;
<a name='L518'>
<a name='L519'>        <b>if</b> (arena-&gt;spare != NULL) <font color='red'>{</font>
<a name='L520'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = arena-&gt;spare;
<a name='L521'>                arena-&gt;spare = NULL;
<a name='L522'>
<a name='L523'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) == 0);
<a name='L524'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1) == 0);
<a name='L525'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) ==
<a name='L526'>                    <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L527'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L528'>                    <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1) == <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L529'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) ==
<a name='L530'>                    <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1));
<a name='L531'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L532'>                <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> zero;
<a name='L533'>                size_t unzeroed;
<a name='L534'>
<a name='L535'>                zero = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L536'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L537'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../D/1839.html' title='Multiple defined in 2 places.'>chunk_alloc</a>(<a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a>, <a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a>,
<a name='L538'>                    <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, &amp;zero, arena-&gt;dss_prec);
<a name='L539'>                <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L540'>                <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> == NULL)
<a name='L541'>                        <b>return</b> (NULL);
<a name='L542'>                <b>if</b> (config_stats)
<a name='L543'>                        arena-&gt;stats.mapped += <a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a>;
<a name='L544'>
<a name='L545'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;arena = arena;
<a name='L546'>
<a name='L547'>                <i><font color='green'>/*</font></i>
<a name='L548'><i><font color='green'>                 * Claim that no pages are in use, since the header is merely</font></i>
<a name='L549'><i><font color='green'>                 * overhead.</font></i>
<a name='L550'><i><font color='green'>                 */</font></i>
<a name='L551'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty = 0;
<a name='L552'>
<a name='L553'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_avail = 0;
<a name='L554'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac = 0;
<a name='L555'>
<a name='L556'>                <i><font color='green'>/*</font></i>
<a name='L557'><i><font color='green'>                 * Initialize the map to contain one maximal free untouched run.</font></i>
<a name='L558'><i><font color='green'>                 * Mark the pages as zeroed iff chunk_alloc() returned a zeroed</font></i>
<a name='L559'><i><font color='green'>                 * chunk.</font></i>
<a name='L560'><i><font color='green'>                 */</font></i>
<a name='L561'>                unzeroed = zero ? 0 : <a href='../S/146.html#L154' title='Defined at 154 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_UNZEROED</a>;
<a name='L562'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>, <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>,
<a name='L563'>                    unzeroed);
<a name='L564'>                <i><font color='green'>/*</font></i>
<a name='L565'><i><font color='green'>                 * There is no need to initialize the internal page map entries</font></i>
<a name='L566'><i><font color='green'>                 * unless the chunk is not zeroed.</font></i>
<a name='L567'><i><font color='green'>                 */</font></i>
<a name='L568'>                <b>if</b> (zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L569'>                        <b>for</b> (i = <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>+1; i &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1; i++)
<a name='L570'>                                <a href='../D/1625.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, i, unzeroed);
<a name='L571'>                <font color='red'>}</font> <b>else</b> <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L572'>                        <b>for</b> (i = <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>+1; i &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1; i++) <font color='red'>{</font>
<a name='L573'>                                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, i) ==
<a name='L574'>                                    unzeroed);
<a name='L575'>                        <font color='red'>}</font>
<a name='L576'>                <font color='red'>}</font>
<a name='L577'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1,
<a name='L578'>                    <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>, unzeroed);
<a name='L579'>        <font color='red'>}</font>
<a name='L580'>
<a name='L581'>        <i><font color='green'>/* Insert the run into the runs_avail tree. */</font></i>
<a name='L582'>        <a href='../S/203.html#L248' title='Defined at 248 in deps/jemalloc/src/arena.c.'>arena_avail_insert</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>,
<a name='L583'>            <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L584'>
<a name='L585'>        <b>return</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L586'><font color='red'>}</font>
<a name='L587'>
<a name='L588'><b>static</b> <b>void</b>
<a name='L589'><a href='../R/1322.html' title='Multiple refered from 2 places.'>arena_chunk_dealloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk)
<a name='L590'><font color='red'>{</font>
<a name='L591'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) == 0);
<a name='L592'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1) == 0);
<a name='L593'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) ==
<a name='L594'>            <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L595'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1) ==
<a name='L596'>            <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L597'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) ==
<a name='L598'>            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1));
<a name='L599'>
<a name='L600'>        <i><font color='green'>/*</font></i>
<a name='L601'><i><font color='green'>         * Remove run from the runs_avail tree, so that the arena does not use</font></i>
<a name='L602'><i><font color='green'>         * it.</font></i>
<a name='L603'><i><font color='green'>         */</font></i>
<a name='L604'>        <a href='../S/203.html#L281' title='Defined at 281 in deps/jemalloc/src/arena.c.'>arena_avail_remove</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>,
<a name='L605'>            <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L606'>
<a name='L607'>        <b>if</b> (arena-&gt;spare != NULL) <font color='red'>{</font>
<a name='L608'>                <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *spare = arena-&gt;spare;
<a name='L609'>
<a name='L610'>                arena-&gt;spare = <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L611'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L612'>                <a href='../D/1844.html' title='Multiple defined in 2 places.'>chunk_dealloc</a>((<b>void</b> *)spare, <a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L613'>                <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L614'>                <b>if</b> (config_stats)
<a name='L615'>                        arena-&gt;stats.mapped -= <a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a>;
<a name='L616'>        <font color='red'>}</font> <b>else</b>
<a name='L617'>                arena-&gt;spare = <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L618'><font color='red'>}</font>
<a name='L619'>
<a name='L620'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *
<a name='L621'><a href='../R/1381.html' title='Multiple refered from 3 places.'>arena_run_alloc_helper</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, bool large, size_t binind,
<a name='L622'>    bool zero)
<a name='L623'><font color='red'>{</font>
<a name='L624'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L625'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm, key;
<a name='L626'>
<a name='L627'>        key.bits = size | <a href='../S/146.html#L157' title='Defined at 157 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_KEY</a>;
<a name='L628'>        mapelm = arena_avail_tree_nsearch(&amp;arena-&gt;runs_avail, &amp;key);
<a name='L629'>        <b>if</b> (mapelm != NULL) <font color='red'>{</font>
<a name='L630'>                <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *run_chunk = <a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(mapelm);
<a name='L631'>                size_t pageind = (((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)mapelm -
<a name='L632'>                    (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run_chunk-&gt;map) / <b>sizeof</b>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>))
<a name='L633'>                    + <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>;
<a name='L634'>
<a name='L635'>                run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run_chunk + (pageind &lt;&lt;
<a name='L636'>                    LG_PAGE));
<a name='L637'>                <a href='../S/203.html#L372' title='Defined at 372 in deps/jemalloc/src/arena.c.'>arena_run_split</a>(arena, run, size, large, binind, zero);
<a name='L638'>                <b>return</b> (run);
<a name='L639'>        <font color='red'>}</font>
<a name='L640'>
<a name='L641'>        <b>return</b> (NULL);
<a name='L642'><font color='red'>}</font>
<a name='L643'>
<a name='L644'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *
<a name='L645'><a href='../R/1380.html' title='Multiple refered from 4 places.'>arena_run_alloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, bool large, size_t binind,
<a name='L646'>    bool zero)
<a name='L647'><font color='red'>{</font>
<a name='L648'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L649'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L650'>
<a name='L651'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L652'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((size &amp; PAGE_MASK) == 0);
<a name='L653'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((large &amp;&amp; binind == <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>) || (large == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> &amp;&amp; binind
<a name='L654'>            != <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>));
<a name='L655'>
<a name='L656'>        <i><font color='green'>/* Search the arena's chunks for the lowest best fit. */</font></i>
<a name='L657'>        run = <a href='../S/203.html#L621' title='Defined at 621 in deps/jemalloc/src/arena.c.'>arena_run_alloc_helper</a>(arena, size, large, binind, zero);
<a name='L658'>        <b>if</b> (run != NULL)
<a name='L659'>                <b>return</b> (run);
<a name='L660'>
<a name='L661'>        <i><font color='green'>/*</font></i>
<a name='L662'><i><font color='green'>         * No usable runs.  Create a new chunk from which to allocate the run.</font></i>
<a name='L663'><i><font color='green'>         */</font></i>
<a name='L664'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = <a href='../S/203.html#L514' title='Defined at 514 in deps/jemalloc/src/arena.c.'>arena_chunk_alloc</a>(arena);
<a name='L665'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> != NULL) <font color='red'>{</font>
<a name='L666'>                run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> &lt;&lt; LG_PAGE));
<a name='L667'>                <a href='../S/203.html#L372' title='Defined at 372 in deps/jemalloc/src/arena.c.'>arena_run_split</a>(arena, run, size, large, binind, zero);
<a name='L668'>                <b>return</b> (run);
<a name='L669'>        <font color='red'>}</font>
<a name='L670'>
<a name='L671'>        <i><font color='green'>/*</font></i>
<a name='L672'><i><font color='green'>         * arena_chunk_alloc() failed, but another thread may have made</font></i>
<a name='L673'><i><font color='green'>         * sufficient memory available while this one dropped arena-&gt;lock in</font></i>
<a name='L674'><i><font color='green'>         * arena_chunk_alloc(), so search one more time.</font></i>
<a name='L675'><i><font color='green'>         */</font></i>
<a name='L676'>        <b>return</b> (<a href='../S/203.html#L621' title='Defined at 621 in deps/jemalloc/src/arena.c.'>arena_run_alloc_helper</a>(arena, size, large, binind, zero));
<a name='L677'><font color='red'>}</font>
<a name='L678'>
<a name='L679'><b>static</b> <b>inline</b> <b>void</b>
<a name='L680'><a href='../S/203.html#L1093' title='Refered from 1093 in deps/jemalloc/src/arena.c.'>arena_maybe_purge</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L681'><font color='red'>{</font>
<a name='L682'>        size_t npurgeable, threshold;
<a name='L683'>
<a name='L684'>        <i><font color='green'>/* Don't purge if the option is disabled. */</font></i>
<a name='L685'>        <b>if</b> (<a href='../S/138.html#L241' title='Defined at 241 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_lg_dirty_mult</a> &lt; 0)
<a name='L686'>                <b>return</b>;
<a name='L687'>        <i><font color='green'>/* Don't purge if all dirty pages are already being purged. */</font></i>
<a name='L688'>        <b>if</b> (arena-&gt;ndirty &lt;= arena-&gt;npurgatory)
<a name='L689'>                <b>return</b>;
<a name='L690'>        npurgeable = arena-&gt;ndirty - arena-&gt;npurgatory;
<a name='L691'>        threshold = (arena-&gt;nactive &gt;&gt; <a href='../S/138.html#L241' title='Defined at 241 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_lg_dirty_mult</a>);
<a name='L692'>        <i><font color='green'>/*</font></i>
<a name='L693'><i><font color='green'>         * Don't purge unless the number of purgeable pages exceeds the</font></i>
<a name='L694'><i><font color='green'>         * threshold.</font></i>
<a name='L695'><i><font color='green'>         */</font></i>
<a name='L696'>        <b>if</b> (npurgeable &lt;= threshold)
<a name='L697'>                <b>return</b>;
<a name='L698'>
<a name='L699'>        <a href='../S/203.html#L861' title='Defined at 861 in deps/jemalloc/src/arena.c.'>arena_purge</a>(arena, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L700'><font color='red'>}</font>
<a name='L701'>
<a name='L702'><b>static</b> <b>inline</b> size_t
<a name='L703'><a href='../S/203.html#L944' title='Refered from 944 in deps/jemalloc/src/arena.c.'>arena_chunk_purge</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, bool all)
<a name='L704'><font color='red'>{</font>
<a name='L705'>        size_t npurged;
<a name='L706'>        <a href='../S/136.html#L4' title='Defined at 4 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_head</a>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>) mapelms;
<a name='L707'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm;
<a name='L708'>        size_t pageind, npages;
<a name='L709'>        size_t nmadvise;
<a name='L710'>
<a name='L711'>        <a href='../S/136.html#L14' title='Defined at 14 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_new</a>(&amp;mapelms);
<a name='L712'>
<a name='L713'>        <i><font color='green'>/*</font></i>
<a name='L714'><i><font color='green'>         * If chunk is the spare, temporarily re-allocate it, 1) so that its</font></i>
<a name='L715'><i><font color='green'>         * run is reinserted into runs_avail, and 2) so that it cannot be</font></i>
<a name='L716'><i><font color='green'>         * completely discarded by another thread while arena-&gt;lock is dropped</font></i>
<a name='L717'><i><font color='green'>         * by this thread.  Note that the arena_run_dalloc() call will</font></i>
<a name='L718'><i><font color='green'>         * implicitly deallocate the chunk, so no explicit action is required</font></i>
<a name='L719'><i><font color='green'>         * in this function to deallocate the chunk.</font></i>
<a name='L720'><i><font color='green'>         *</font></i>
<a name='L721'><i><font color='green'>         * Note that once a chunk contains dirty pages, it cannot again contain</font></i>
<a name='L722'><i><font color='green'>         * a single run unless 1) it is a dirty run, or 2) this function purges</font></i>
<a name='L723'><i><font color='green'>         * dirty pages and causes the transition to a single clean run.  Thus</font></i>
<a name='L724'><i><font color='green'>         * (chunk == arena-&gt;spare) is possible, but it is not possible for</font></i>
<a name='L725'><i><font color='green'>         * this function to be called on the spare unless it contains a dirty</font></i>
<a name='L726'><i><font color='green'>         * run.</font></i>
<a name='L727'><i><font color='green'>         */</font></i>
<a name='L728'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> == arena-&gt;spare) <font color='red'>{</font>
<a name='L729'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>) != 0);
<a name='L730'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-1) != 0);
<a name='L731'>
<a name='L732'>                <a href='../S/203.html#L514' title='Defined at 514 in deps/jemalloc/src/arena.c.'>arena_chunk_alloc</a>(arena);
<a name='L733'>        <font color='red'>}</font>
<a name='L734'>
<a name='L735'>        <b>if</b> (config_stats)
<a name='L736'>                arena-&gt;stats.purged += <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty;
<a name='L737'>
<a name='L738'>        <i><font color='green'>/*</font></i>
<a name='L739'><i><font color='green'>         * Operate on all dirty runs if there is no clean/dirty run</font></i>
<a name='L740'><i><font color='green'>         * fragmentation.</font></i>
<a name='L741'><i><font color='green'>         */</font></i>
<a name='L742'>        <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac == 0)
<a name='L743'>                all = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L744'>
<a name='L745'>        <i><font color='green'>/*</font></i>
<a name='L746'><i><font color='green'>         * Temporarily allocate free dirty runs within chunk.  If all is false,</font></i>
<a name='L747'><i><font color='green'>         * only operate on dirty runs that are fragments; otherwise operate on</font></i>
<a name='L748'><i><font color='green'>         * all dirty runs.</font></i>
<a name='L749'><i><font color='green'>         */</font></i>
<a name='L750'>        <b>for</b> (pageind = <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>; pageind &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>; pageind += npages) <font color='red'>{</font>
<a name='L751'>                mapelm = <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L752'>                <b>if</b> (<a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) == 0) <font color='red'>{</font>
<a name='L753'>                        size_t run_size =
<a name='L754'>                            <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L755'>
<a name='L756'>                        npages = run_size &gt;&gt; LG_PAGE;
<a name='L757'>                        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(pageind + npages &lt;= <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>);
<a name='L758'>                        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) ==
<a name='L759'>                            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages-1));
<a name='L760'>
<a name='L761'>                        <b>if</b> (<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) != 0 &amp;&amp;
<a name='L762'>                            (all || <a href='../S/203.html#L240' title='Defined at 240 in deps/jemalloc/src/arena.c.'>arena_avail_adjac</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind,
<a name='L763'>                            npages))) <font color='red'>{</font>
<a name='L764'>                                <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)
<a name='L765'>                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)(pageind &lt;&lt; LG_PAGE));
<a name='L766'>
<a name='L767'>                                <a href='../S/203.html#L372' title='Defined at 372 in deps/jemalloc/src/arena.c.'>arena_run_split</a>(arena, run, run_size, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>,
<a name='L768'>                                    <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L769'>                                <i><font color='green'>/* Append to list for later processing. */</font></i>
<a name='L770'>                                <a href='../S/136.html#L18' title='Defined at 18 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_elm_new</a>(mapelm, u.ql_link);
<a name='L771'>                                <a href='../S/136.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_tail_insert</a>(&amp;mapelms, mapelm, u.ql_link);
<a name='L772'>                        <font color='red'>}</font>
<a name='L773'>                <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L774'>                        <i><font color='green'>/* Skip run. */</font></i>
<a name='L775'>                        <b>if</b> (<a href='../D/1616.html' title='Multiple defined in 2 places.'>arena_mapbits_large_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) != 0) <font color='red'>{</font>
<a name='L776'>                                npages = <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L777'>                                    pageind) &gt;&gt; LG_PAGE;
<a name='L778'>                        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L779'>                                size_t binind;
<a name='L780'>                                <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L781'>                                <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)
<a name='L782'>                                    <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)(pageind &lt;&lt; LG_PAGE));
<a name='L783'>
<a name='L784'>                                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1619.html' title='Multiple defined in 2 places.'>arena_mapbits_small_runind_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L785'>                                    pageind) == 0);
<a name='L786'>                                binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(arena, run-&gt;bin);
<a name='L787'>                                bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L788'>                                npages = bin_info-&gt;run_size &gt;&gt; LG_PAGE;
<a name='L789'>                        <font color='red'>}</font>
<a name='L790'>                <font color='red'>}</font>
<a name='L791'>        <font color='red'>}</font>
<a name='L792'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(pageind == <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>);
<a name='L793'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty == 0 || all == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L794'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac == 0);
<a name='L795'>
<a name='L796'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L797'>        <b>if</b> (config_stats)
<a name='L798'>                nmadvise = 0;
<a name='L799'>        npurged = 0;
<a name='L800'>        <a href='../S/136.html#L79' title='Defined at 79 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_foreach</a>(mapelm, &amp;mapelms, u.ql_link) <font color='red'>{</font>
<a name='L801'>                <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> unzeroed;
<a name='L802'>                size_t flag_unzeroed, i;
<a name='L803'>
<a name='L804'>                pageind = (((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)mapelm - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;map) /
<a name='L805'>                    <b>sizeof</b>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>)) + <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>;
<a name='L806'>                npages = <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) &gt;&gt;
<a name='L807'>                    LG_PAGE;
<a name='L808'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(pageind + npages &lt;= <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>);
<a name='L809'>                unzeroed = <a href='../D/3481.html' title='Multiple defined in 2 places.'>pages_purge</a>((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (pageind &lt;&lt;
<a name='L810'>                    LG_PAGE)), (npages &lt;&lt; LG_PAGE));
<a name='L811'>                flag_unzeroed = unzeroed ? <a href='../S/146.html#L154' title='Defined at 154 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_UNZEROED</a> : 0;
<a name='L812'>                <i><font color='green'>/*</font></i>
<a name='L813'><i><font color='green'>                 * Set the unzeroed flag for all pages, now that pages_purge()</font></i>
<a name='L814'><i><font color='green'>                 * has returned whether the pages were zeroed as a side effect</font></i>
<a name='L815'><i><font color='green'>                 * of purging.  This chunk map modification is safe even though</font></i>
<a name='L816'><i><font color='green'>                 * the arena mutex isn't currently owned by this thread,</font></i>
<a name='L817'><i><font color='green'>                 * because the run is marked as allocated, thus protecting it</font></i>
<a name='L818'><i><font color='green'>                 * from being modified by any other thread.  As long as these</font></i>
<a name='L819'><i><font color='green'>                 * writes don't perturb the first and last elements'</font></i>
<a name='L820'><i><font color='green'>                 * CHUNK_MAP_ALLOCATED bits, behavior is well defined.</font></i>
<a name='L821'><i><font color='green'>                 */</font></i>
<a name='L822'>                <b>for</b> (i = 0; i &lt; npages; i++) <font color='red'>{</font>
<a name='L823'>                        <a href='../D/1625.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+i,
<a name='L824'>                            flag_unzeroed);
<a name='L825'>                <font color='red'>}</font>
<a name='L826'>                npurged += npages;
<a name='L827'>                <b>if</b> (config_stats)
<a name='L828'>                        nmadvise++;
<a name='L829'>        <font color='red'>}</font>
<a name='L830'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L831'>        <b>if</b> (config_stats)
<a name='L832'>                arena-&gt;stats.nmadvise += nmadvise;
<a name='L833'>
<a name='L834'>        <i><font color='green'>/* Deallocate runs. */</font></i>
<a name='L835'>        <b>for</b> (mapelm = <a href='../S/136.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_first</a>(&amp;mapelms); mapelm != NULL;
<a name='L836'>            mapelm = <a href='../S/136.html#L20' title='Defined at 20 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_first</a>(&amp;mapelms)) <font color='red'>{</font>
<a name='L837'>                <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L838'>
<a name='L839'>                pageind = (((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)mapelm - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;map) /
<a name='L840'>                    <b>sizeof</b>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>)) + <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>;
<a name='L841'>                run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)(pageind &lt;&lt;
<a name='L842'>                    LG_PAGE));
<a name='L843'>                <a href='../S/136.html#L58' title='Defined at 58 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_remove</a>(&amp;mapelms, mapelm, u.ql_link);
<a name='L844'>                <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(arena, run, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L845'>        <font color='red'>}</font>
<a name='L846'>
<a name='L847'>        <b>return</b> (npurged);
<a name='L848'><font color='red'>}</font>
<a name='L849'>
<a name='L850'><b>static</b> <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *
<a name='L851'><a href='../R/1587.html' title='Multiple refered from 2 places.'>chunks_dirty_iter_cb</a>(<a href='../S/146.html#L192' title='Defined at 192 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_tree_t</a> *tree, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *arg)
<a name='L852'><font color='red'>{</font>
<a name='L853'>       size_t *ndirty = (size_t *)arg;
<a name='L854'>
<a name='L855'>       <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty != 0);
<a name='L856'>       *ndirty += <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty;
<a name='L857'>       <b>return</b> (NULL);
<a name='L858'><font color='red'>}</font>
<a name='L859'>
<a name='L860'><b>static</b> <b>void</b>
<a name='L861'><a href='../R/1373.html' title='Multiple refered from 5 places.'>arena_purge</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, bool all)
<a name='L862'><font color='red'>{</font>
<a name='L863'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L864'>        size_t npurgatory;
<a name='L865'>        <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L866'>                size_t ndirty = 0;
<a name='L867'>
<a name='L868'>                arena_chunk_dirty_iter(&amp;arena-&gt;chunks_dirty, NULL,
<a name='L869'>                    <a href='../S/203.html#L851' title='Defined at 851 in deps/jemalloc/src/arena.c.'>chunks_dirty_iter_cb</a>, (<b>void</b> *)&amp;ndirty);
<a name='L870'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ndirty == arena-&gt;ndirty);
<a name='L871'>        <font color='red'>}</font>
<a name='L872'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(arena-&gt;ndirty &gt; arena-&gt;npurgatory || all);
<a name='L873'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((arena-&gt;nactive &gt;&gt; <a href='../S/138.html#L241' title='Defined at 241 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_lg_dirty_mult</a>) &lt; (arena-&gt;ndirty -
<a name='L874'>            arena-&gt;npurgatory) || all);
<a name='L875'>
<a name='L876'>        <b>if</b> (config_stats)
<a name='L877'>                arena-&gt;stats.npurge++;
<a name='L878'>
<a name='L879'>        <i><font color='green'>/*</font></i>
<a name='L880'><i><font color='green'>         * Compute the minimum number of pages that this thread should try to</font></i>
<a name='L881'><i><font color='green'>         * purge, and add the result to arena-&gt;npurgatory.  This will keep</font></i>
<a name='L882'><i><font color='green'>         * multiple threads from racing to reduce ndirty below the threshold.</font></i>
<a name='L883'><i><font color='green'>         */</font></i>
<a name='L884'>        <font color='red'>{</font>
<a name='L885'>                size_t npurgeable = arena-&gt;ndirty - arena-&gt;npurgatory;
<a name='L886'>
<a name='L887'>                <b>if</b> (all == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L888'>                        size_t threshold = (arena-&gt;nactive &gt;&gt;
<a name='L889'>                            <a href='../S/138.html#L241' title='Defined at 241 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_lg_dirty_mult</a>);
<a name='L890'>
<a name='L891'>                        npurgatory = npurgeable - threshold;
<a name='L892'>                <font color='red'>}</font> <b>else</b>
<a name='L893'>                        npurgatory = npurgeable;
<a name='L894'>        <font color='red'>}</font>
<a name='L895'>        arena-&gt;npurgatory += npurgatory;
<a name='L896'>
<a name='L897'>        <b>while</b> (npurgatory &gt; 0) <font color='red'>{</font>
<a name='L898'>                size_t npurgeable, npurged, nunpurged;
<a name='L899'>
<a name='L900'>                <i><font color='green'>/* Get next chunk with dirty pages. */</font></i>
<a name='L901'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = arena_chunk_dirty_first(&amp;arena-&gt;chunks_dirty);
<a name='L902'>                <b>if</b> (<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> == NULL) <font color='red'>{</font>
<a name='L903'>                        <i><font color='green'>/*</font></i>
<a name='L904'><i><font color='green'>                         * This thread was unable to purge as many pages as</font></i>
<a name='L905'><i><font color='green'>                         * originally intended, due to races with other threads</font></i>
<a name='L906'><i><font color='green'>                         * that either did some of the purging work, or re-used</font></i>
<a name='L907'><i><font color='green'>                         * dirty pages.</font></i>
<a name='L908'><i><font color='green'>                         */</font></i>
<a name='L909'>                        arena-&gt;npurgatory -= npurgatory;
<a name='L910'>                        <b>return</b>;
<a name='L911'>                <font color='red'>}</font>
<a name='L912'>                npurgeable = <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;ndirty;
<a name='L913'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(npurgeable != 0);
<a name='L914'>
<a name='L915'>                <b>if</b> (npurgeable &gt; npurgatory &amp;&amp; <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;nruns_adjac == 0) <font color='red'>{</font>
<a name='L916'>                        <i><font color='green'>/*</font></i>
<a name='L917'><i><font color='green'>                         * This thread will purge all the dirty pages in chunk,</font></i>
<a name='L918'><i><font color='green'>                         * so set npurgatory to reflect this thread's intent to</font></i>
<a name='L919'><i><font color='green'>                         * purge the pages.  This tends to reduce the chances</font></i>
<a name='L920'><i><font color='green'>                         * of the following scenario:</font></i>
<a name='L921'><i><font color='green'>                         *</font></i>
<a name='L922'><i><font color='green'>                         * 1) This thread sets arena-&gt;npurgatory such that</font></i>
<a name='L923'><i><font color='green'>                         *    (arena-&gt;ndirty - arena-&gt;npurgatory) is at the</font></i>
<a name='L924'><i><font color='green'>                         *    threshold.</font></i>
<a name='L925'><i><font color='green'>                         * 2) This thread drops arena-&gt;lock.</font></i>
<a name='L926'><i><font color='green'>                         * 3) Another thread causes one or more pages to be</font></i>
<a name='L927'><i><font color='green'>                         *    dirtied, and immediately determines that it must</font></i>
<a name='L928'><i><font color='green'>                         *    purge dirty pages.</font></i>
<a name='L929'><i><font color='green'>                         *</font></i>
<a name='L930'><i><font color='green'>                         * If this scenario *does* play out, that's okay,</font></i>
<a name='L931'><i><font color='green'>                         * because all of the purging work being done really</font></i>
<a name='L932'><i><font color='green'>                         * needs to happen.</font></i>
<a name='L933'><i><font color='green'>                         */</font></i>
<a name='L934'>                        arena-&gt;npurgatory += npurgeable - npurgatory;
<a name='L935'>                        npurgatory = npurgeable;
<a name='L936'>                <font color='red'>}</font>
<a name='L937'>
<a name='L938'>                <i><font color='green'>/*</font></i>
<a name='L939'><i><font color='green'>                 * Keep track of how many pages are purgeable, versus how many</font></i>
<a name='L940'><i><font color='green'>                 * actually get purged, and adjust counters accordingly.</font></i>
<a name='L941'><i><font color='green'>                 */</font></i>
<a name='L942'>                arena-&gt;npurgatory -= npurgeable;
<a name='L943'>                npurgatory -= npurgeable;
<a name='L944'>                npurged = <a href='../S/203.html#L703' title='Defined at 703 in deps/jemalloc/src/arena.c.'>arena_chunk_purge</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, all);
<a name='L945'>                nunpurged = npurgeable - npurged;
<a name='L946'>                arena-&gt;npurgatory += nunpurged;
<a name='L947'>                npurgatory += nunpurged;
<a name='L948'>        <font color='red'>}</font>
<a name='L949'><font color='red'>}</font>
<a name='L950'>
<a name='L951'><b>void</b>
<a name='L952'><a href='../R/1374.html' title='Multiple refered from 4 places.'>arena_purge_all</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L953'><font color='red'>{</font>
<a name='L954'>
<a name='L955'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L956'>        <a href='../S/203.html#L861' title='Defined at 861 in deps/jemalloc/src/arena.c.'>arena_purge</a>(arena, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L957'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L958'><font color='red'>}</font>
<a name='L959'>
<a name='L960'><b>static</b> <b>void</b>
<a name='L961'><a href='../R/1382.html' title='Multiple refered from 6 places.'>arena_run_dalloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run, bool dirty, bool cleaned)
<a name='L962'><font color='red'>{</font>
<a name='L963'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L964'>        size_t size, run_ind, run_pages, flag_dirty;
<a name='L965'>
<a name='L966'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L967'>        run_ind = (size_t)(((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE);
<a name='L968'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run_ind &gt;= <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>);
<a name='L969'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run_ind &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>);
<a name='L970'>        <b>if</b> (<a href='../D/1616.html' title='Multiple defined in 2 places.'>arena_mapbits_large_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) != 0) <font color='red'>{</font>
<a name='L971'>                size = <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind);
<a name='L972'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size == PAGE ||
<a name='L973'>                    <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L974'>                    run_ind+(size&gt;&gt;LG_PAGE)-1) == 0);
<a name='L975'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L976'>                size_t binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(arena, run-&gt;bin);
<a name='L977'>                <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L978'>                size = bin_info-&gt;run_size;
<a name='L979'>        <font color='red'>}</font>
<a name='L980'>        run_pages = (size &gt;&gt; LG_PAGE);
<a name='L981'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L982'>                <i><font color='green'>/*</font></i>
<a name='L983'><i><font color='green'>                 * Update stats_cactive if nactive is crossing a chunk</font></i>
<a name='L984'><i><font color='green'>                 * multiple.</font></i>
<a name='L985'><i><font color='green'>                 */</font></i>
<a name='L986'>                size_t cactive_diff = <a href='../S/142.html#L19' title='Defined at 19 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_CEILING</a>(arena-&gt;nactive &lt;&lt; LG_PAGE) -
<a name='L987'>                    <a href='../S/142.html#L19' title='Defined at 19 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_CEILING</a>((arena-&gt;nactive - run_pages) &lt;&lt; LG_PAGE);
<a name='L988'>                <b>if</b> (cactive_diff != 0)
<a name='L989'>                        <a href='../D/4213.html' title='Multiple defined in 2 places.'>stats_cactive_sub</a>(cactive_diff);
<a name='L990'>        <font color='red'>}</font>
<a name='L991'>        arena-&gt;nactive -= run_pages;
<a name='L992'>
<a name='L993'>        <i><font color='green'>/*</font></i>
<a name='L994'><i><font color='green'>         * The run is dirty if the caller claims to have dirtied it, as well as</font></i>
<a name='L995'><i><font color='green'>         * if it was already dirty before being allocated and the caller</font></i>
<a name='L996'><i><font color='green'>         * doesn't claim to have cleaned it.</font></i>
<a name='L997'><i><font color='green'>         */</font></i>
<a name='L998'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) ==
<a name='L999'>            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1));
<a name='L1000'>        <b>if</b> (cleaned == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> &amp;&amp; <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) != 0)
<a name='L1001'>                dirty = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L1002'>        flag_dirty = dirty ? <a href='../S/146.html#L153' title='Defined at 153 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_DIRTY</a> : 0;
<a name='L1003'>
<a name='L1004'>        <i><font color='green'>/* Mark pages as unallocated in the chunk map. */</font></i>
<a name='L1005'>        <b>if</b> (dirty) <font color='red'>{</font>
<a name='L1006'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, size,
<a name='L1007'>                    <a href='../S/146.html#L153' title='Defined at 153 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_DIRTY</a>);
<a name='L1008'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1, size,
<a name='L1009'>                    <a href='../S/146.html#L153' title='Defined at 153 in deps/jemalloc/include/jemalloc/internal/arena.h.'>CHUNK_MAP_DIRTY</a>);
<a name='L1010'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1011'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, size,
<a name='L1012'>                    <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind));
<a name='L1013'>                <a href='../D/1621.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1, size,
<a name='L1014'>                    <a href='../D/1624.html' title='Multiple defined in 2 places.'>arena_mapbits_unzeroed_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1));
<a name='L1015'>        <font color='red'>}</font>
<a name='L1016'>
<a name='L1017'>        <i><font color='green'>/* Try to coalesce forward. */</font></i>
<a name='L1018'>        <b>if</b> (run_ind + run_pages &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a> &amp;&amp;
<a name='L1019'>            <a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages) == 0 &amp;&amp;
<a name='L1020'>            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages) == flag_dirty) <font color='red'>{</font>
<a name='L1021'>                size_t nrun_size = <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1022'>                    run_ind+run_pages);
<a name='L1023'>                size_t nrun_pages = nrun_size &gt;&gt; LG_PAGE;
<a name='L1024'>
<a name='L1025'>                <i><font color='green'>/*</font></i>
<a name='L1026'><i><font color='green'>                 * Remove successor from runs_avail; the coalesced run is</font></i>
<a name='L1027'><i><font color='green'>                 * inserted later.</font></i>
<a name='L1028'><i><font color='green'>                 */</font></i>
<a name='L1029'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1030'>                    run_ind+run_pages+nrun_pages-1) == nrun_size);
<a name='L1031'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1032'>                    run_ind+run_pages+nrun_pages-1) == flag_dirty);
<a name='L1033'>                <a href='../S/203.html#L281' title='Defined at 281 in deps/jemalloc/src/arena.c.'>arena_avail_remove</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages, nrun_pages,
<a name='L1034'>                    <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1035'>
<a name='L1036'>                size += nrun_size;
<a name='L1037'>                run_pages += nrun_pages;
<a name='L1038'>
<a name='L1039'>                <a href='../D/1623.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, size);
<a name='L1040'>                <a href='../D/1623.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1,
<a name='L1041'>                    size);
<a name='L1042'>        <font color='red'>}</font>
<a name='L1043'>
<a name='L1044'>        <i><font color='green'>/* Try to coalesce backward. */</font></i>
<a name='L1045'>        <b>if</b> (run_ind &gt; <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> &amp;&amp; <a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind-1)
<a name='L1046'>            == 0 &amp;&amp; <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind-1) == flag_dirty) <font color='red'>{</font>
<a name='L1047'>                size_t prun_size = <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1048'>                    run_ind-1);
<a name='L1049'>                size_t prun_pages = prun_size &gt;&gt; LG_PAGE;
<a name='L1050'>
<a name='L1051'>                run_ind -= prun_pages;
<a name='L1052'>
<a name='L1053'>                <i><font color='green'>/*</font></i>
<a name='L1054'><i><font color='green'>                 * Remove predecessor from runs_avail; the coalesced run is</font></i>
<a name='L1055'><i><font color='green'>                 * inserted later.</font></i>
<a name='L1056'><i><font color='green'>                 */</font></i>
<a name='L1057'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) ==
<a name='L1058'>                    prun_size);
<a name='L1059'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) == flag_dirty);
<a name='L1060'>                <a href='../S/203.html#L281' title='Defined at 281 in deps/jemalloc/src/arena.c.'>arena_avail_remove</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, prun_pages, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>,
<a name='L1061'>                    <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1062'>
<a name='L1063'>                size += prun_size;
<a name='L1064'>                run_pages += prun_pages;
<a name='L1065'>
<a name='L1066'>                <a href='../D/1623.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, size);
<a name='L1067'>                <a href='../D/1623.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1,
<a name='L1068'>                    size);
<a name='L1069'>        <font color='red'>}</font>
<a name='L1070'>
<a name='L1071'>        <i><font color='green'>/* Insert into runs_avail, now that coalescing is complete. */</font></i>
<a name='L1072'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) ==
<a name='L1073'>            <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1));
<a name='L1074'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) ==
<a name='L1075'>            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+run_pages-1));
<a name='L1076'>        <a href='../S/203.html#L248' title='Defined at 248 in deps/jemalloc/src/arena.c.'>arena_avail_insert</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, run_pages, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1077'>
<a name='L1078'>        <i><font color='green'>/* Deallocate chunk if it is now completely unused. */</font></i>
<a name='L1079'>        <b>if</b> (size == <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>) <font color='red'>{</font>
<a name='L1080'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run_ind == <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>);
<a name='L1081'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run_pages == (<a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a> &gt;&gt; LG_PAGE));
<a name='L1082'>                <a href='../S/203.html#L589' title='Defined at 589 in deps/jemalloc/src/arena.c.'>arena_chunk_dealloc</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>);
<a name='L1083'>        <font color='red'>}</font>
<a name='L1084'>
<a name='L1085'>        <i><font color='green'>/*</font></i>
<a name='L1086'><i><font color='green'>         * It is okay to do dirty page processing here even if the chunk was</font></i>
<a name='L1087'><i><font color='green'>         * deallocated above, since in that case it is the spare.  Waiting</font></i>
<a name='L1088'><i><font color='green'>         * until after possible chunk deallocation to do dirty processing</font></i>
<a name='L1089'><i><font color='green'>         * allows for an old spare to be fully deallocated, thus decreasing the</font></i>
<a name='L1090'><i><font color='green'>         * chances of spuriously crossing the dirty page purging threshold.</font></i>
<a name='L1091'><i><font color='green'>         */</font></i>
<a name='L1092'>        <b>if</b> (dirty)
<a name='L1093'>                <a href='../S/203.html#L680' title='Defined at 680 in deps/jemalloc/src/arena.c.'>arena_maybe_purge</a>(arena);
<a name='L1094'><font color='red'>}</font>
<a name='L1095'>
<a name='L1096'><b>static</b> <b>void</b>
<a name='L1097'><a href='../R/1390.html' title='Multiple refered from 2 places.'>arena_run_trim_head</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L1098'>    size_t oldsize, size_t newsize)
<a name='L1099'><font color='red'>{</font>
<a name='L1100'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1101'>        size_t head_npages = (oldsize - newsize) &gt;&gt; LG_PAGE;
<a name='L1102'>        size_t flag_dirty = <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1103'>
<a name='L1104'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(oldsize &gt; newsize);
<a name='L1105'>
<a name='L1106'>        <i><font color='green'>/*</font></i>
<a name='L1107'><i><font color='green'>         * Update the chunk map so that arena_run_dalloc() can treat the</font></i>
<a name='L1108'><i><font color='green'>         * leading run as separately allocated.  Set the last element of each</font></i>
<a name='L1109'><i><font color='green'>         * run first, in case of single-page runs.</font></i>
<a name='L1110'><i><font color='green'>         */</font></i>
<a name='L1111'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) == oldsize);
<a name='L1112'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+head_npages-1, 0, flag_dirty);
<a name='L1113'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, oldsize-newsize, flag_dirty);
<a name='L1114'>
<a name='L1115'>        <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L1116'>                <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a> size_t tail_npages = newsize &gt;&gt; LG_PAGE;
<a name='L1117'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1118'>                    pageind+head_npages+tail_npages-1) == 0);
<a name='L1119'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1120'>                    pageind+head_npages+tail_npages-1) == flag_dirty);
<a name='L1121'>        <font color='red'>}</font>
<a name='L1122'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+head_npages, newsize,
<a name='L1123'>            flag_dirty);
<a name='L1124'>
<a name='L1125'>        <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(arena, run, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1126'><font color='red'>}</font>
<a name='L1127'>
<a name='L1128'><b>static</b> <b>void</b>
<a name='L1129'><a href='../R/1391.html' title='Multiple refered from 4 places.'>arena_run_trim_tail</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L1130'>    size_t oldsize, size_t newsize, bool dirty)
<a name='L1131'><font color='red'>{</font>
<a name='L1132'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1133'>        size_t head_npages = newsize &gt;&gt; LG_PAGE;
<a name='L1134'>        size_t flag_dirty = <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1135'>
<a name='L1136'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(oldsize &gt; newsize);
<a name='L1137'>
<a name='L1138'>        <i><font color='green'>/*</font></i>
<a name='L1139'><i><font color='green'>         * Update the chunk map so that arena_run_dalloc() can treat the</font></i>
<a name='L1140'><i><font color='green'>         * trailing run as separately allocated.  Set the last element of each</font></i>
<a name='L1141'><i><font color='green'>         * run first, in case of single-page runs.</font></i>
<a name='L1142'><i><font color='green'>         */</font></i>
<a name='L1143'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) == oldsize);
<a name='L1144'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+head_npages-1, 0, flag_dirty);
<a name='L1145'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, newsize, flag_dirty);
<a name='L1146'>
<a name='L1147'>        <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L1148'>                <a href='../S/310.html#L70' title='Defined at 70 in deps/lua/src/llimits.h.'>UNUSED</a> size_t tail_npages = (oldsize - newsize) &gt;&gt; LG_PAGE;
<a name='L1149'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1150'>                    pageind+head_npages+tail_npages-1) == 0);
<a name='L1151'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1152'>                    pageind+head_npages+tail_npages-1) == flag_dirty);
<a name='L1153'>        <font color='red'>}</font>
<a name='L1154'>        <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+head_npages, oldsize-newsize,
<a name='L1155'>            flag_dirty);
<a name='L1156'>
<a name='L1157'>        <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(arena, (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run + newsize),
<a name='L1158'>            dirty, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1159'><font color='red'>}</font>
<a name='L1160'>
<a name='L1161'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *
<a name='L1162'><a href='../R/1315.html' title='Multiple refered from 2 places.'>arena_bin_runs_first</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1163'><font color='red'>{</font>
<a name='L1164'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm = arena_run_tree_first(&amp;bin-&gt;runs);
<a name='L1165'>        <b>if</b> (mapelm != NULL) <font color='red'>{</font>
<a name='L1166'>                <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L1167'>                size_t pageind;
<a name='L1168'>                <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1169'>
<a name='L1170'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(mapelm);
<a name='L1171'>                pageind = ((((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)mapelm - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;map) /
<a name='L1172'>                    <b>sizeof</b>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>))) + <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>;
<a name='L1173'>                run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)((pageind -
<a name='L1174'>                    <a href='../D/1619.html' title='Multiple defined in 2 places.'>arena_mapbits_small_runind_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind)) &lt;&lt;
<a name='L1175'>                    LG_PAGE));
<a name='L1176'>                <b>return</b> (run);
<a name='L1177'>        <font color='red'>}</font>
<a name='L1178'>
<a name='L1179'>        <b>return</b> (NULL);
<a name='L1180'><font color='red'>}</font>
<a name='L1181'>
<a name='L1182'><b>static</b> <b>void</b>
<a name='L1183'><a href='../R/1316.html' title='Multiple refered from 3 places.'>arena_bin_runs_insert</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run)
<a name='L1184'><font color='red'>{</font>
<a name='L1185'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = <a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L1186'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1187'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm = <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1188'>
<a name='L1189'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(arena_run_tree_search(&amp;bin-&gt;runs, mapelm) == NULL);
<a name='L1190'>
<a name='L1191'>        arena_run_tree_insert(&amp;bin-&gt;runs, mapelm);
<a name='L1192'><font color='red'>}</font>
<a name='L1193'>
<a name='L1194'><b>static</b> <b>void</b>
<a name='L1195'><a href='../R/1317.html' title='Multiple refered from 3 places.'>arena_bin_runs_remove</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run)
<a name='L1196'><font color='red'>{</font>
<a name='L1197'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L1198'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1199'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm = <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1200'>
<a name='L1201'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(arena_run_tree_search(&amp;bin-&gt;runs, mapelm) != NULL);
<a name='L1202'>
<a name='L1203'>        arena_run_tree_remove(&amp;bin-&gt;runs, mapelm);
<a name='L1204'><font color='red'>}</font>
<a name='L1205'>
<a name='L1206'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *
<a name='L1207'><a href='../R/1314.html' title='Multiple refered from 3 places.'>arena_bin_nonfull_run_tryget</a>(<a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1208'><font color='red'>{</font>
<a name='L1209'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run = <a href='../S/203.html#L1162' title='Defined at 1162 in deps/jemalloc/src/arena.c.'>arena_bin_runs_first</a>(bin);
<a name='L1210'>        <b>if</b> (run != NULL) <font color='red'>{</font>
<a name='L1211'>                <a href='../S/203.html#L1195' title='Defined at 1195 in deps/jemalloc/src/arena.c.'>arena_bin_runs_remove</a>(bin, run);
<a name='L1212'>                <b>if</b> (config_stats)
<a name='L1213'>                        bin-&gt;stats.reruns++;
<a name='L1214'>        <font color='red'>}</font>
<a name='L1215'>        <b>return</b> (run);
<a name='L1216'><font color='red'>}</font>
<a name='L1217'>
<a name='L1218'><b>static</b> <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *
<a name='L1219'><a href='../R/1313.html' title='Multiple refered from 2 places.'>arena_bin_nonfull_run_get</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1220'><font color='red'>{</font>
<a name='L1221'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1222'>        size_t binind;
<a name='L1223'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L1224'>
<a name='L1225'>        <i><font color='green'>/* Look for a usable run. */</font></i>
<a name='L1226'>        run = <a href='../S/203.html#L1207' title='Defined at 1207 in deps/jemalloc/src/arena.c.'>arena_bin_nonfull_run_tryget</a>(bin);
<a name='L1227'>        <b>if</b> (run != NULL)
<a name='L1228'>                <b>return</b> (run);
<a name='L1229'>        <i><font color='green'>/* No existing runs have any space available. */</font></i>
<a name='L1230'>
<a name='L1231'>        binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(arena, bin);
<a name='L1232'>        bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L1233'>
<a name='L1234'>        <i><font color='green'>/* Allocate a new run. */</font></i>
<a name='L1235'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1236'>        <i><font color='green'>/******************************/</font></i>
<a name='L1237'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1238'>        run = <a href='../S/203.html#L645' title='Defined at 645 in deps/jemalloc/src/arena.c.'>arena_run_alloc</a>(arena, bin_info-&gt;run_size, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>, binind, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1239'>        <b>if</b> (run != NULL) <font color='red'>{</font>
<a name='L1240'>                <a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *bitmap = (<a href='../S/133.html#L9' title='Defined at 9 in deps/jemalloc/include/jemalloc/internal/bitmap.h.'>bitmap_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L1241'>                    (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;bitmap_offset);
<a name='L1242'>
<a name='L1243'>                <i><font color='green'>/* Initialize run internals. */</font></i>
<a name='L1244'>                VALGRIND_MAKE_MEM_UNDEFINED(run, bin_info-&gt;reg0_offset -
<a name='L1245'>                    bin_info-&gt;redzone_size);
<a name='L1246'>                run-&gt;bin = bin;
<a name='L1247'>                run-&gt;nextind = 0;
<a name='L1248'>                run-&gt;nfree = bin_info-&gt;nregs;
<a name='L1249'>                <a href='../D/1747.html' title='Multiple defined in 2 places.'>bitmap_init</a>(bitmap, &amp;bin_info-&gt;bitmap_info);
<a name='L1250'>        <font color='red'>}</font>
<a name='L1251'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1252'>        <i><font color='green'>/********************************/</font></i>
<a name='L1253'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L1254'>        <b>if</b> (run != NULL) <font color='red'>{</font>
<a name='L1255'>                <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1256'>                        bin-&gt;stats.nruns++;
<a name='L1257'>                        bin-&gt;stats.curruns++;
<a name='L1258'>                <font color='red'>}</font>
<a name='L1259'>                <b>return</b> (run);
<a name='L1260'>        <font color='red'>}</font>
<a name='L1261'>
<a name='L1262'>        <i><font color='green'>/*</font></i>
<a name='L1263'><i><font color='green'>         * arena_run_alloc() failed, but another thread may have made</font></i>
<a name='L1264'><i><font color='green'>         * sufficient memory available while this one dropped bin-&gt;lock above,</font></i>
<a name='L1265'><i><font color='green'>         * so search one more time.</font></i>
<a name='L1266'><i><font color='green'>         */</font></i>
<a name='L1267'>        run = <a href='../S/203.html#L1207' title='Defined at 1207 in deps/jemalloc/src/arena.c.'>arena_bin_nonfull_run_tryget</a>(bin);
<a name='L1268'>        <b>if</b> (run != NULL)
<a name='L1269'>                <b>return</b> (run);
<a name='L1270'>
<a name='L1271'>        <b>return</b> (NULL);
<a name='L1272'><font color='red'>}</font>
<a name='L1273'>
<a name='L1274'><i><font color='green'>/* Re-fill bin-&gt;runcur, then call arena_run_reg_alloc(). */</font></i>
<a name='L1275'><b>static</b> <b>void</b> *
<a name='L1276'><a href='../R/1312.html' title='Multiple refered from 3 places.'>arena_bin_malloc_hard</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1277'><font color='red'>{</font>
<a name='L1278'>        <b>void</b> *ret;
<a name='L1279'>        size_t binind;
<a name='L1280'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L1281'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1282'>
<a name='L1283'>        binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(arena, bin);
<a name='L1284'>        bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L1285'>        bin-&gt;runcur = NULL;
<a name='L1286'>        run = <a href='../S/203.html#L1219' title='Defined at 1219 in deps/jemalloc/src/arena.c.'>arena_bin_nonfull_run_get</a>(arena, bin);
<a name='L1287'>        <b>if</b> (bin-&gt;runcur != NULL &amp;&amp; bin-&gt;runcur-&gt;nfree &gt; 0) <font color='red'>{</font>
<a name='L1288'>                <i><font color='green'>/*</font></i>
<a name='L1289'><i><font color='green'>                 * Another thread updated runcur while this one ran without the</font></i>
<a name='L1290'><i><font color='green'>                 * bin lock in arena_bin_nonfull_run_get().</font></i>
<a name='L1291'><i><font color='green'>                 */</font></i>
<a name='L1292'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(bin-&gt;runcur-&gt;nfree &gt; 0);
<a name='L1293'>                ret = <a href='../S/203.html#L315' title='Defined at 315 in deps/jemalloc/src/arena.c.'>arena_run_reg_alloc</a>(bin-&gt;runcur, bin_info);
<a name='L1294'>                <b>if</b> (run != NULL) <font color='red'>{</font>
<a name='L1295'>                        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L1296'>
<a name='L1297'>                        <i><font color='green'>/*</font></i>
<a name='L1298'><i><font color='green'>                         * arena_run_alloc() may have allocated run, or it may</font></i>
<a name='L1299'><i><font color='green'>                         * have pulled run from the bin's run tree.  Therefore</font></i>
<a name='L1300'><i><font color='green'>                         * it is unsafe to make any assumptions about how run</font></i>
<a name='L1301'><i><font color='green'>                         * has previously been used, and arena_bin_lower_run()</font></i>
<a name='L1302'><i><font color='green'>                         * must be called, as if a region were just deallocated</font></i>
<a name='L1303'><i><font color='green'>                         * from the run.</font></i>
<a name='L1304'><i><font color='green'>                         */</font></i>
<a name='L1305'>                        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L1306'>                        <b>if</b> (run-&gt;nfree == bin_info-&gt;nregs)
<a name='L1307'>                                <a href='../S/203.html#L1627' title='Defined at 1627 in deps/jemalloc/src/arena.c.'>arena_dalloc_bin_run</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, bin);
<a name='L1308'>                        <b>else</b>
<a name='L1309'>                                <a href='../S/203.html#L1678' title='Defined at 1678 in deps/jemalloc/src/arena.c.'>arena_bin_lower_run</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, bin);
<a name='L1310'>                <font color='red'>}</font>
<a name='L1311'>                <b>return</b> (ret);
<a name='L1312'>        <font color='red'>}</font>
<a name='L1313'>
<a name='L1314'>        <b>if</b> (run == NULL)
<a name='L1315'>                <b>return</b> (NULL);
<a name='L1316'>
<a name='L1317'>        bin-&gt;runcur = run;
<a name='L1318'>
<a name='L1319'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(bin-&gt;runcur-&gt;nfree &gt; 0);
<a name='L1320'>
<a name='L1321'>        <b>return</b> (<a href='../S/203.html#L315' title='Defined at 315 in deps/jemalloc/src/arena.c.'>arena_run_reg_alloc</a>(bin-&gt;runcur, bin_info));
<a name='L1322'><font color='red'>}</font>
<a name='L1323'>
<a name='L1324'><b>void</b>
<a name='L1325'><a href='../R/1368.html' title='Multiple refered from 8 places.'>arena_prof_accum</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> accumbytes)
<a name='L1326'><font color='red'>{</font>
<a name='L1327'>
<a name='L1328'>        <a href='../S/149.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/util.h.'>cassert</a>(config_prof);
<a name='L1329'>
<a name='L1330'>        <b>if</b> (config_prof &amp;&amp; <a href='../S/138.html#L273' title='Defined at 273 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>prof_interval</a> != 0) <font color='red'>{</font>
<a name='L1331'>                arena-&gt;prof_accumbytes += accumbytes;
<a name='L1332'>                <b>if</b> (arena-&gt;prof_accumbytes &gt;= <a href='../S/138.html#L273' title='Defined at 273 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>prof_interval</a>) <font color='red'>{</font>
<a name='L1333'>                        <a href='../D/3563.html' title='Multiple defined in 2 places.'>prof_idump</a>();
<a name='L1334'>                        arena-&gt;prof_accumbytes -= <a href='../S/138.html#L273' title='Defined at 273 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>prof_interval</a>;
<a name='L1335'>                <font color='red'>}</font>
<a name='L1336'>        <font color='red'>}</font>
<a name='L1337'><font color='red'>}</font>
<a name='L1338'>
<a name='L1339'><b>void</b>
<a name='L1340'><a href='../R/1398.html' title='Multiple refered from 3 places.'>arena_tcache_fill_small</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/151.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/tcache.h.'>tcache_bin_t</a> *tbin, size_t binind,
<a name='L1341'>    <a href='../S/160.html#L90' title='Defined at 90 in deps/jemalloc/include/msvc_compat/stdint.h.'>uint64_t</a> prof_accumbytes)
<a name='L1342'><font color='red'>{</font>
<a name='L1343'>        <b>unsigned</b> i, nfill;
<a name='L1344'>        <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin;
<a name='L1345'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1346'>        <b>void</b> *ptr;
<a name='L1347'>
<a name='L1348'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(tbin-&gt;ncached == 0);
<a name='L1349'>
<a name='L1350'>        <b>if</b> (config_prof) <font color='red'>{</font>
<a name='L1351'>                <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1352'>                <a href='../D/1635.html' title='Multiple defined in 2 places.'>arena_prof_accum</a>(arena, prof_accumbytes);
<a name='L1353'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1354'>        <font color='red'>}</font>
<a name='L1355'>        bin = &amp;arena-&gt;bins[binind];
<a name='L1356'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L1357'>        <b>for</b> (i = 0, nfill = (<a href='../S/138.html#L326' title='Defined at 326 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>tcache_bin_info</a>[binind].ncached_max &gt;&gt;
<a name='L1358'>            tbin-&gt;lg_fill_div); i &lt; nfill; i++) <font color='red'>{</font>
<a name='L1359'>                <b>if</b> ((run = bin-&gt;runcur) != NULL &amp;&amp; run-&gt;nfree &gt; 0)
<a name='L1360'>                        ptr = <a href='../S/203.html#L315' title='Defined at 315 in deps/jemalloc/src/arena.c.'>arena_run_reg_alloc</a>(run, &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind]);
<a name='L1361'>                <b>else</b>
<a name='L1362'>                        ptr = <a href='../S/203.html#L1276' title='Defined at 1276 in deps/jemalloc/src/arena.c.'>arena_bin_malloc_hard</a>(arena, bin);
<a name='L1363'>                <b>if</b> (ptr == NULL)
<a name='L1364'>                        <b>break</b>;
<a name='L1365'>                <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>) <font color='red'>{</font>
<a name='L1366'>                        <a href='../D/1565.html' title='Multiple defined in 2 places.'>arena_alloc_junk_small</a>(ptr, &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind],
<a name='L1367'>                            <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1368'>                <font color='red'>}</font>
<a name='L1369'>                <i><font color='green'>/* Insert such that low regions get used first. */</font></i>
<a name='L1370'>                tbin-&gt;avail[nfill - 1 - i] = ptr;
<a name='L1371'>        <font color='red'>}</font>
<a name='L1372'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1373'>                bin-&gt;stats.allocated += i * <a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind].reg_size;
<a name='L1374'>                bin-&gt;stats.nmalloc += i;
<a name='L1375'>                bin-&gt;stats.nrequests += tbin-&gt;tstats.nrequests;
<a name='L1376'>                bin-&gt;stats.nfills++;
<a name='L1377'>                tbin-&gt;tstats.nrequests = 0;
<a name='L1378'>        <font color='red'>}</font>
<a name='L1379'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1380'>        tbin-&gt;ncached = i;
<a name='L1381'><font color='red'>}</font>
<a name='L1382'>
<a name='L1383'><b>void</b>
<a name='L1384'><a href='../R/1301.html' title='Multiple refered from 8 places.'>arena_alloc_junk_small</a>(<b>void</b> *ptr, <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info, bool zero)
<a name='L1385'><font color='red'>{</font>
<a name='L1386'>
<a name='L1387'>        <b>if</b> (zero) <font color='red'>{</font>
<a name='L1388'>                size_t redzone_size = bin_info-&gt;redzone_size;
<a name='L1389'>                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - redzone_size), 0xa5,
<a name='L1390'>                    redzone_size);
<a name='L1391'>                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + bin_info-&gt;reg_size), 0xa5,
<a name='L1392'>                    redzone_size);
<a name='L1393'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1394'>                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - bin_info-&gt;redzone_size), 0xa5,
<a name='L1395'>                    bin_info-&gt;reg_interval);
<a name='L1396'>        <font color='red'>}</font>
<a name='L1397'><font color='red'>}</font>
<a name='L1398'>
<a name='L1399'><b>void</b>
<a name='L1400'><a href='../R/1334.html' title='Multiple refered from 4 places.'>arena_dalloc_junk_small</a>(<b>void</b> *ptr, <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info)
<a name='L1401'><font color='red'>{</font>
<a name='L1402'>        size_t size = bin_info-&gt;reg_size;
<a name='L1403'>        size_t redzone_size = bin_info-&gt;redzone_size;
<a name='L1404'>        size_t i;
<a name='L1405'>        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> <a href='../D/2172.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>;
<a name='L1406'>
<a name='L1407'>        <b>for</b> (i = 1; i &lt;= redzone_size; i++) <font color='red'>{</font>
<a name='L1408'>                <b>unsigned</b> byte;
<a name='L1409'>                <b>if</b> ((byte = *(<a href='../D/4431.html' title='Multiple defined in 2 places.'>uint8_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - i)) != 0xa5) <font color='red'>{</font>
<a name='L1410'>                        <a href='../D/2172.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L1411'>                        <a href='../S/138.html#L219' title='Defined at 219 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>malloc_printf</a>("&lt;jemalloc&gt;: Corrupt redzone "
<a name='L1412'>                            "%zu byte%s before %p (size %zu), byte=%#x\n", i,
<a name='L1413'>                            (i == 1) ? "" : "s", ptr, size, byte);
<a name='L1414'>                <font color='red'>}</font>
<a name='L1415'>        <font color='red'>}</font>
<a name='L1416'>        <b>for</b> (i = 0; i &lt; redzone_size; i++) <font color='red'>{</font>
<a name='L1417'>                <b>unsigned</b> byte;
<a name='L1418'>                <b>if</b> ((byte = *(<a href='../D/4431.html' title='Multiple defined in 2 places.'>uint8_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + size + i)) != 0xa5) <font color='red'>{</font>
<a name='L1419'>                        <a href='../D/2172.html' title='Multiple defined in 3 places.'>error</a> = <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>;
<a name='L1420'>                        <a href='../S/138.html#L219' title='Defined at 219 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>malloc_printf</a>("&lt;jemalloc&gt;: Corrupt redzone "
<a name='L1421'>                            "%zu byte%s after end of %p (size %zu), byte=%#x\n",
<a name='L1422'>                            i, (i == 1) ? "" : "s", ptr, size, byte);
<a name='L1423'>                <font color='red'>}</font>
<a name='L1424'>        <font color='red'>}</font>
<a name='L1425'>        <b>if</b> (<a href='../S/138.html#L238' title='Defined at 238 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_abort</a> &amp;&amp; <a href='../D/2172.html' title='Multiple defined in 3 places.'>error</a>)
<a name='L1426'>                abort();
<a name='L1427'>
<a name='L1428'>        memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - redzone_size), 0x5a,
<a name='L1429'>            bin_info-&gt;reg_interval);
<a name='L1430'><font color='red'>}</font>
<a name='L1431'>
<a name='L1432'><b>void</b> *
<a name='L1433'><a href='../R/1343.html' title='Multiple refered from 4 places.'>arena_malloc_small</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, bool zero)
<a name='L1434'><font color='red'>{</font>
<a name='L1435'>        <b>void</b> *ret;
<a name='L1436'>        <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin;
<a name='L1437'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1438'>        size_t binind;
<a name='L1439'>
<a name='L1440'>        binind = <a href='../S/146.html#L395' title='Defined at 395 in deps/jemalloc/include/jemalloc/internal/arena.h.'>SMALL_SIZE2BIN</a>(size);
<a name='L1441'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(binind &lt; NBINS);
<a name='L1442'>        bin = &amp;arena-&gt;bins[binind];
<a name='L1443'>        size = <a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind].reg_size;
<a name='L1444'>
<a name='L1445'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L1446'>        <b>if</b> ((run = bin-&gt;runcur) != NULL &amp;&amp; run-&gt;nfree &gt; 0)
<a name='L1447'>                ret = <a href='../S/203.html#L315' title='Defined at 315 in deps/jemalloc/src/arena.c.'>arena_run_reg_alloc</a>(run, &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind]);
<a name='L1448'>        <b>else</b>
<a name='L1449'>                ret = <a href='../S/203.html#L1276' title='Defined at 1276 in deps/jemalloc/src/arena.c.'>arena_bin_malloc_hard</a>(arena, bin);
<a name='L1450'>
<a name='L1451'>        <b>if</b> (ret == NULL) <font color='red'>{</font>
<a name='L1452'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1453'>                <b>return</b> (NULL);
<a name='L1454'>        <font color='red'>}</font>
<a name='L1455'>
<a name='L1456'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1457'>                bin-&gt;stats.allocated += size;
<a name='L1458'>                bin-&gt;stats.nmalloc++;
<a name='L1459'>                bin-&gt;stats.nrequests++;
<a name='L1460'>        <font color='red'>}</font>
<a name='L1461'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1462'>        <b>if</b> (config_prof &amp;&amp; <a href='../D/2573.html' title='Multiple defined in 3 places.'>isthreaded</a> == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L1463'>                <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1464'>                <a href='../D/1635.html' title='Multiple defined in 2 places.'>arena_prof_accum</a>(arena, size);
<a name='L1465'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1466'>        <font color='red'>}</font>
<a name='L1467'>
<a name='L1468'>        <b>if</b> (zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L1469'>                <b>if</b> (config_fill) <font color='red'>{</font>
<a name='L1470'>                        <b>if</b> (<a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>) <font color='red'>{</font>
<a name='L1471'>                                <a href='../D/1565.html' title='Multiple defined in 2 places.'>arena_alloc_junk_small</a>(ret,
<a name='L1472'>                                    &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind], <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1473'>                        <font color='red'>}</font> <b>else</b> <b>if</b> (<a href='../S/138.html#L260' title='Defined at 260 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_zero</a>)
<a name='L1474'>                                memset(ret, 0, size);
<a name='L1475'>                <font color='red'>}</font>
<a name='L1476'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1477'>                <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>) <font color='red'>{</font>
<a name='L1478'>                        <a href='../D/1565.html' title='Multiple defined in 2 places.'>arena_alloc_junk_small</a>(ret, &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind],
<a name='L1479'>                            <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1480'>                <font color='red'>}</font>
<a name='L1481'>                VALGRIND_MAKE_MEM_UNDEFINED(ret, size);
<a name='L1482'>                memset(ret, 0, size);
<a name='L1483'>        <font color='red'>}</font>
<a name='L1484'>
<a name='L1485'>        <b>return</b> (ret);
<a name='L1486'><font color='red'>}</font>
<a name='L1487'>
<a name='L1488'><b>void</b> *
<a name='L1489'><a href='../R/1342.html' title='Multiple refered from 5 places.'>arena_malloc_large</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, bool zero)
<a name='L1490'><font color='red'>{</font>
<a name='L1491'>        <b>void</b> *ret;
<a name='L1492'>
<a name='L1493'>        <i><font color='green'>/* Large allocation. */</font></i>
<a name='L1494'>        size = PAGE_CEILING(size);
<a name='L1495'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1496'>        ret = (<b>void</b> *)<a href='../S/203.html#L645' title='Defined at 645 in deps/jemalloc/src/arena.c.'>arena_run_alloc</a>(arena, size, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>, zero);
<a name='L1497'>        <b>if</b> (ret == NULL) <font color='red'>{</font>
<a name='L1498'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1499'>                <b>return</b> (NULL);
<a name='L1500'>        <font color='red'>}</font>
<a name='L1501'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1502'>                arena-&gt;stats.nmalloc_large++;
<a name='L1503'>                arena-&gt;stats.nrequests_large++;
<a name='L1504'>                arena-&gt;stats.allocated_large += size;
<a name='L1505'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nmalloc++;
<a name='L1506'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nrequests++;
<a name='L1507'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].curruns++;
<a name='L1508'>        <font color='red'>}</font>
<a name='L1509'>        <b>if</b> (config_prof)
<a name='L1510'>                <a href='../D/1635.html' title='Multiple defined in 2 places.'>arena_prof_accum</a>(arena, size);
<a name='L1511'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1512'>
<a name='L1513'>        <b>if</b> (zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L1514'>                <b>if</b> (config_fill) <font color='red'>{</font>
<a name='L1515'>                        <b>if</b> (<a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>)
<a name='L1516'>                                memset(ret, 0xa5, size);
<a name='L1517'>                        <b>else</b> <b>if</b> (<a href='../S/138.html#L260' title='Defined at 260 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_zero</a>)
<a name='L1518'>                                memset(ret, 0, size);
<a name='L1519'>                <font color='red'>}</font>
<a name='L1520'>        <font color='red'>}</font>
<a name='L1521'>
<a name='L1522'>        <b>return</b> (ret);
<a name='L1523'><font color='red'>}</font>
<a name='L1524'>
<a name='L1525'><i><font color='green'>/* Only handles large allocations that require more than page alignment. */</font></i>
<a name='L1526'><b>void</b> *
<a name='L1527'><a href='../R/1364.html' title='Multiple refered from 2 places.'>arena_palloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, size_t size, size_t alignment, bool zero)
<a name='L1528'><font color='red'>{</font>
<a name='L1529'>        <b>void</b> *ret;
<a name='L1530'>        size_t alloc_size, leadsize, trailsize;
<a name='L1531'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1532'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L1533'>
<a name='L1534'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>((size &amp; PAGE_MASK) == 0);
<a name='L1535'>
<a name='L1536'>        alignment = PAGE_CEILING(alignment);
<a name='L1537'>        alloc_size = size + alignment - PAGE;
<a name='L1538'>
<a name='L1539'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1540'>        run = <a href='../S/203.html#L645' title='Defined at 645 in deps/jemalloc/src/arena.c.'>arena_run_alloc</a>(arena, alloc_size, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>, zero);
<a name='L1541'>        <b>if</b> (run == NULL) <font color='red'>{</font>
<a name='L1542'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1543'>                <b>return</b> (NULL);
<a name='L1544'>        <font color='red'>}</font>
<a name='L1545'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(run);
<a name='L1546'>
<a name='L1547'>        leadsize = ALIGNMENT_CEILING((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run, alignment) -
<a name='L1548'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run;
<a name='L1549'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(alloc_size &gt;= leadsize + size);
<a name='L1550'>        trailsize = alloc_size - leadsize - size;
<a name='L1551'>        ret = (<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run + leadsize);
<a name='L1552'>        <b>if</b> (leadsize != 0) <font color='red'>{</font>
<a name='L1553'>                <a href='../S/203.html#L1097' title='Defined at 1097 in deps/jemalloc/src/arena.c.'>arena_run_trim_head</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, alloc_size, alloc_size -
<a name='L1554'>                    leadsize);
<a name='L1555'>        <font color='red'>}</font>
<a name='L1556'>        <b>if</b> (trailsize != 0) <font color='red'>{</font>
<a name='L1557'>                <a href='../S/203.html#L1129' title='Defined at 1129 in deps/jemalloc/src/arena.c.'>arena_run_trim_tail</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ret, size + trailsize, size,
<a name='L1558'>                    <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1559'>        <font color='red'>}</font>
<a name='L1560'>
<a name='L1561'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1562'>                arena-&gt;stats.nmalloc_large++;
<a name='L1563'>                arena-&gt;stats.nrequests_large++;
<a name='L1564'>                arena-&gt;stats.allocated_large += size;
<a name='L1565'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nmalloc++;
<a name='L1566'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nrequests++;
<a name='L1567'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].curruns++;
<a name='L1568'>        <font color='red'>}</font>
<a name='L1569'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1570'>
<a name='L1571'>        <b>if</b> (config_fill &amp;&amp; zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L1572'>                <b>if</b> (<a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>)
<a name='L1573'>                        memset(ret, 0xa5, size);
<a name='L1574'>                <b>else</b> <b>if</b> (<a href='../S/138.html#L260' title='Defined at 260 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_zero</a>)
<a name='L1575'>                        memset(ret, 0, size);
<a name='L1576'>        <font color='red'>}</font>
<a name='L1577'>        <b>return</b> (ret);
<a name='L1578'><font color='red'>}</font>
<a name='L1579'>
<a name='L1580'><b>void</b>
<a name='L1581'><a href='../R/1371.html' title='Multiple refered from 9 places.'>arena_prof_promoted</a>(<b>const</b> <b>void</b> *ptr, size_t size)
<a name='L1582'><font color='red'>{</font>
<a name='L1583'>        <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L1584'>        size_t pageind, binind;
<a name='L1585'>
<a name='L1586'>        <a href='../S/149.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/util.h.'>cassert</a>(config_prof);
<a name='L1587'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(ptr != NULL);
<a name='L1588'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(ptr) != ptr);
<a name='L1589'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L206' title='Defined at 206 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>isalloc</a>(ptr, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) == PAGE);
<a name='L1590'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L206' title='Defined at 206 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>isalloc</a>(ptr, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>) == PAGE);
<a name='L1591'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size &lt;= SMALL_MAXCLASS);
<a name='L1592'>
<a name='L1593'>        <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(ptr);
<a name='L1594'>        pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1595'>        binind = <a href='../S/146.html#L395' title='Defined at 395 in deps/jemalloc/include/jemalloc/internal/arena.h.'>SMALL_SIZE2BIN</a>(size);
<a name='L1596'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(binind &lt; NBINS);
<a name='L1597'>        <a href='../D/1615.html' title='Multiple defined in 2 places.'>arena_mapbits_large_binind_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, binind);
<a name='L1598'>
<a name='L1599'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L206' title='Defined at 206 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>isalloc</a>(ptr, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) == PAGE);
<a name='L1600'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L206' title='Defined at 206 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>isalloc</a>(ptr, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>) == size);
<a name='L1601'><font color='red'>}</font>
<a name='L1602'>
<a name='L1603'><b>static</b> <b>void</b>
<a name='L1604'><a href='../R/1338.html' title='Multiple refered from 2 places.'>arena_dissociate_bin_run</a>(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L1605'>    <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1606'><font color='red'>{</font>
<a name='L1607'>
<a name='L1608'>        <i><font color='green'>/* Dissociate run from bin. */</font></i>
<a name='L1609'>        <b>if</b> (run == bin-&gt;runcur)
<a name='L1610'>                bin-&gt;runcur = NULL;
<a name='L1611'>        <b>else</b> <font color='red'>{</font>
<a name='L1612'>                size_t binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;arena, bin);
<a name='L1613'>                <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L1614'>
<a name='L1615'>                <b>if</b> (bin_info-&gt;nregs != 1) <font color='red'>{</font>
<a name='L1616'>                        <i><font color='green'>/*</font></i>
<a name='L1617'><i><font color='green'>                         * This block's conditional is necessary because if the</font></i>
<a name='L1618'><i><font color='green'>                         * run only contains one region, then it never gets</font></i>
<a name='L1619'><i><font color='green'>                         * inserted into the non-full runs tree.</font></i>
<a name='L1620'><i><font color='green'>                         */</font></i>
<a name='L1621'>                        <a href='../S/203.html#L1195' title='Defined at 1195 in deps/jemalloc/src/arena.c.'>arena_bin_runs_remove</a>(bin, run);
<a name='L1622'>                <font color='red'>}</font>
<a name='L1623'>        <font color='red'>}</font>
<a name='L1624'><font color='red'>}</font>
<a name='L1625'>
<a name='L1626'><b>static</b> <b>void</b>
<a name='L1627'><a href='../R/1333.html' title='Multiple refered from 3 places.'>arena_dalloc_bin_run</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L1628'>    <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1629'><font color='red'>{</font>
<a name='L1630'>        size_t binind;
<a name='L1631'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L1632'>        size_t npages, run_ind, past;
<a name='L1633'>
<a name='L1634'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(run != bin-&gt;runcur);
<a name='L1635'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(arena_run_tree_search(&amp;bin-&gt;runs,
<a name='L1636'>            <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run-(<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>)&gt;&gt;LG_PAGE))
<a name='L1637'>            == NULL);
<a name='L1638'>
<a name='L1639'>        binind = <a href='../D/1571.html' title='Multiple defined in 2 places.'>arena_bin_index</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;arena, run-&gt;bin);
<a name='L1640'>        bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L1641'>
<a name='L1642'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1643'>        <i><font color='green'>/******************************/</font></i>
<a name='L1644'>        npages = bin_info-&gt;run_size &gt;&gt; LG_PAGE;
<a name='L1645'>        run_ind = (size_t)(((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE);
<a name='L1646'>        past = (size_t)(PAGE_CEILING((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run +
<a name='L1647'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin_info-&gt;reg0_offset + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)(run-&gt;nextind *
<a name='L1648'>            bin_info-&gt;reg_interval - bin_info-&gt;redzone_size) -
<a name='L1649'>            (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE);
<a name='L1650'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1651'>
<a name='L1652'>        <i><font color='green'>/*</font></i>
<a name='L1653'><i><font color='green'>         * If the run was originally clean, and some pages were never touched,</font></i>
<a name='L1654'><i><font color='green'>         * trim the clean pages before deallocating the dirty portion of the</font></i>
<a name='L1655'><i><font color='green'>         * run.</font></i>
<a name='L1656'><i><font color='green'>         */</font></i>
<a name='L1657'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) ==
<a name='L1658'>            <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+npages-1));
<a name='L1659'>        <b>if</b> (<a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind) == 0 &amp;&amp; past - run_ind &lt;
<a name='L1660'>            npages) <font color='red'>{</font>
<a name='L1661'>                <i><font color='green'>/* Trim clean pages.  Convert to large run beforehand. */</font></i>
<a name='L1662'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(npages &gt; 0);
<a name='L1663'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind, bin_info-&gt;run_size, 0);
<a name='L1664'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run_ind+npages-1, 0, 0);
<a name='L1665'>                <a href='../S/203.html#L1129' title='Defined at 1129 in deps/jemalloc/src/arena.c.'>arena_run_trim_tail</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, (npages &lt;&lt; LG_PAGE),
<a name='L1666'>                    ((past - run_ind) &lt;&lt; LG_PAGE), <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1667'>                <i><font color='green'>/* npages = past - run_ind; */</font></i>
<a name='L1668'>        <font color='red'>}</font>
<a name='L1669'>        <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(arena, run, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1670'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1671'>        <i><font color='green'>/****************************/</font></i>
<a name='L1672'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L1673'>        <b>if</b> (config_stats)
<a name='L1674'>                bin-&gt;stats.curruns--;
<a name='L1675'><font color='red'>}</font>
<a name='L1676'>
<a name='L1677'><b>static</b> <b>void</b>
<a name='L1678'><a href='../R/1311.html' title='Multiple refered from 3 places.'>arena_bin_lower_run</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run,
<a name='L1679'>    <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin)
<a name='L1680'><font color='red'>{</font>
<a name='L1681'>
<a name='L1682'>        <i><font color='green'>/*</font></i>
<a name='L1683'><i><font color='green'>         * Make sure that if bin-&gt;runcur is non-NULL, it refers to the lowest</font></i>
<a name='L1684'><i><font color='green'>         * non-full run.  It is okay to NULL runcur out rather than proactively</font></i>
<a name='L1685'><i><font color='green'>         * keeping it pointing at the lowest non-full run.</font></i>
<a name='L1686'><i><font color='green'>         */</font></i>
<a name='L1687'>        <b>if</b> ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)run &lt; (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)bin-&gt;runcur) <font color='red'>{</font>
<a name='L1688'>                <i><font color='green'>/* Switch runcur. */</font></i>
<a name='L1689'>                <b>if</b> (bin-&gt;runcur-&gt;nfree &gt; 0)
<a name='L1690'>                        <a href='../S/203.html#L1183' title='Defined at 1183 in deps/jemalloc/src/arena.c.'>arena_bin_runs_insert</a>(bin, bin-&gt;runcur);
<a name='L1691'>                bin-&gt;runcur = run;
<a name='L1692'>                <b>if</b> (config_stats)
<a name='L1693'>                        bin-&gt;stats.reruns++;
<a name='L1694'>        <font color='red'>}</font> <b>else</b>
<a name='L1695'>                <a href='../S/203.html#L1183' title='Defined at 1183 in deps/jemalloc/src/arena.c.'>arena_bin_runs_insert</a>(bin, run);
<a name='L1696'><font color='red'>}</font>
<a name='L1697'>
<a name='L1698'><b>void</b>
<a name='L1699'><a href='../R/1332.html' title='Multiple refered from 4 places.'>arena_dalloc_bin_locked</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr,
<a name='L1700'>    <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm)
<a name='L1701'><font color='red'>{</font>
<a name='L1702'>        size_t pageind;
<a name='L1703'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1704'>        <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin;
<a name='L1705'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L1706'>        size_t size, binind;
<a name='L1707'>
<a name='L1708'>        pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1709'>        run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)((pageind -
<a name='L1710'>            <a href='../D/1619.html' title='Multiple defined in 2 places.'>arena_mapbits_small_runind_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind)) &lt;&lt; LG_PAGE));
<a name='L1711'>        bin = run-&gt;bin;
<a name='L1712'>        binind = <a href='../D/1639.html' title='Multiple defined in 2 places.'>arena_ptr_small_binind_get</a>(ptr, mapelm-&gt;bits);
<a name='L1713'>        bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[binind];
<a name='L1714'>        <b>if</b> (config_fill || config_stats)
<a name='L1715'>                size = bin_info-&gt;reg_size;
<a name='L1716'>
<a name='L1717'>        <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>)
<a name='L1718'>                <a href='../D/1598.html' title='Multiple defined in 2 places.'>arena_dalloc_junk_small</a>(ptr, bin_info);
<a name='L1719'>
<a name='L1720'>        <a href='../S/203.html#L336' title='Defined at 336 in deps/jemalloc/src/arena.c.'>arena_run_reg_dalloc</a>(run, ptr);
<a name='L1721'>        <b>if</b> (run-&gt;nfree == bin_info-&gt;nregs) <font color='red'>{</font>
<a name='L1722'>                <a href='../S/203.html#L1604' title='Defined at 1604 in deps/jemalloc/src/arena.c.'>arena_dissociate_bin_run</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, bin);
<a name='L1723'>                <a href='../S/203.html#L1627' title='Defined at 1627 in deps/jemalloc/src/arena.c.'>arena_dalloc_bin_run</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, bin);
<a name='L1724'>        <font color='red'>}</font> <b>else</b> <b>if</b> (run-&gt;nfree == 1 &amp;&amp; run != bin-&gt;runcur)
<a name='L1725'>                <a href='../S/203.html#L1678' title='Defined at 1678 in deps/jemalloc/src/arena.c.'>arena_bin_lower_run</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, run, bin);
<a name='L1726'>
<a name='L1727'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1728'>                bin-&gt;stats.allocated -= size;
<a name='L1729'>                bin-&gt;stats.ndalloc++;
<a name='L1730'>        <font color='red'>}</font>
<a name='L1731'><font color='red'>}</font>
<a name='L1732'>
<a name='L1733'><b>void</b>
<a name='L1734'><a href='../R/1331.html' title='Multiple refered from 4 places.'>arena_dalloc_bin</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr,
<a name='L1735'>    size_t pageind, <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm)
<a name='L1736'><font color='red'>{</font>
<a name='L1737'>        <a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *run;
<a name='L1738'>        <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin;
<a name='L1739'>
<a name='L1740'>        run = (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> + (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)((pageind -
<a name='L1741'>            <a href='../D/1619.html' title='Multiple defined in 2 places.'>arena_mapbits_small_runind_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind)) &lt;&lt; LG_PAGE));
<a name='L1742'>        bin = run-&gt;bin;
<a name='L1743'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L1744'>        <a href='../D/1596.html' title='Multiple defined in 2 places.'>arena_dalloc_bin_locked</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ptr, mapelm);
<a name='L1745'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L1746'><font color='red'>}</font>
<a name='L1747'>
<a name='L1748'><b>void</b>
<a name='L1749'><a href='../R/1337.html' title='Multiple refered from 3 places.'>arena_dalloc_small</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr,
<a name='L1750'>    size_t pageind)
<a name='L1751'><font color='red'>{</font>
<a name='L1752'>        <a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a> *mapelm;
<a name='L1753'>
<a name='L1754'>        <b>if</b> (config_debug) <font color='red'>{</font>
<a name='L1755'>                <i><font color='green'>/* arena_ptr_small_binind_get() does extra sanity checking. */</font></i>
<a name='L1756'>                <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../D/1639.html' title='Multiple defined in 2 places.'>arena_ptr_small_binind_get</a>(ptr, <a href='../D/1614.html' title='Multiple defined in 2 places.'>arena_mapbits_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1757'>                    pageind)) != <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>);
<a name='L1758'>        <font color='red'>}</font>
<a name='L1759'>        mapelm = <a href='../D/1627.html' title='Multiple defined in 2 places.'>arena_mapp_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1760'>        <a href='../D/1595.html' title='Multiple defined in 2 places.'>arena_dalloc_bin</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ptr, pageind, mapelm);
<a name='L1761'><font color='red'>}</font>
<a name='L1762'>
<a name='L1763'><b>void</b>
<a name='L1764'><a href='../R/1336.html' title='Multiple refered from 4 places.'>arena_dalloc_large_locked</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr)
<a name='L1765'><font color='red'>{</font>
<a name='L1766'>
<a name='L1767'>        <b>if</b> (config_fill || config_stats) <font color='red'>{</font>
<a name='L1768'>                size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1769'>                size_t size = <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind);
<a name='L1770'>
<a name='L1771'>                <b>if</b> (config_fill &amp;&amp; config_stats &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>)
<a name='L1772'>                        memset(ptr, 0x5a, size);
<a name='L1773'>                <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1774'>                        arena-&gt;stats.ndalloc_large++;
<a name='L1775'>                        arena-&gt;stats.allocated_large -= size;
<a name='L1776'>                        arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].ndalloc++;
<a name='L1777'>                        arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].curruns--;
<a name='L1778'>                <font color='red'>}</font>
<a name='L1779'>        <font color='red'>}</font>
<a name='L1780'>
<a name='L1781'>        <a href='../S/203.html#L961' title='Defined at 961 in deps/jemalloc/src/arena.c.'>arena_run_dalloc</a>(arena, (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)ptr, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>, <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1782'><font color='red'>}</font>
<a name='L1783'>
<a name='L1784'><b>void</b>
<a name='L1785'><a href='../R/1335.html' title='Multiple refered from 4 places.'>arena_dalloc_large</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr)
<a name='L1786'><font color='red'>{</font>
<a name='L1787'>
<a name='L1788'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1789'>        <a href='../D/1600.html' title='Multiple defined in 2 places.'>arena_dalloc_large_locked</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ptr);
<a name='L1790'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1791'><font color='red'>}</font>
<a name='L1792'>
<a name='L1793'><b>static</b> <b>void</b>
<a name='L1794'><a href='../R/1378.html' title='Multiple refered from 2 places.'>arena_ralloc_large_shrink</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr,
<a name='L1795'>    size_t oldsize, size_t size)
<a name='L1796'><font color='red'>{</font>
<a name='L1797'>
<a name='L1798'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size &lt; oldsize);
<a name='L1799'>
<a name='L1800'>        <i><font color='green'>/*</font></i>
<a name='L1801'><i><font color='green'>         * Shrink the run, and make trailing pages available for other</font></i>
<a name='L1802'><i><font color='green'>         * allocations.</font></i>
<a name='L1803'><i><font color='green'>         */</font></i>
<a name='L1804'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1805'>        <a href='../S/203.html#L1129' title='Defined at 1129 in deps/jemalloc/src/arena.c.'>arena_run_trim_tail</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)ptr, oldsize, size,
<a name='L1806'>            <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1807'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1808'>                arena-&gt;stats.ndalloc_large++;
<a name='L1809'>                arena-&gt;stats.allocated_large -= oldsize;
<a name='L1810'>                arena-&gt;stats.lstats[(oldsize &gt;&gt; LG_PAGE) - 1].ndalloc++;
<a name='L1811'>                arena-&gt;stats.lstats[(oldsize &gt;&gt; LG_PAGE) - 1].curruns--;
<a name='L1812'>
<a name='L1813'>                arena-&gt;stats.nmalloc_large++;
<a name='L1814'>                arena-&gt;stats.nrequests_large++;
<a name='L1815'>                arena-&gt;stats.allocated_large += size;
<a name='L1816'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nmalloc++;
<a name='L1817'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nrequests++;
<a name='L1818'>                arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].curruns++;
<a name='L1819'>        <font color='red'>}</font>
<a name='L1820'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1821'><font color='red'>}</font>
<a name='L1822'>
<a name='L1823'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L1824'><a href='../R/1377.html' title='Multiple refered from 2 places.'>arena_ralloc_large_grow</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *chunk, <b>void</b> *ptr,
<a name='L1825'>    size_t oldsize, size_t size, size_t extra, bool zero)
<a name='L1826'><font color='red'>{</font>
<a name='L1827'>        size_t pageind = ((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr - (<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>) &gt;&gt; LG_PAGE;
<a name='L1828'>        size_t npages = oldsize &gt;&gt; LG_PAGE;
<a name='L1829'>        size_t followsize;
<a name='L1830'>
<a name='L1831'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(oldsize == <a href='../D/1618.html' title='Multiple defined in 2 places.'>arena_mapbits_large_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind));
<a name='L1832'>
<a name='L1833'>        <i><font color='green'>/* Try to extend the run. */</font></i>
<a name='L1834'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size + extra &gt; oldsize);
<a name='L1835'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L1836'>        <b>if</b> (pageind + npages &lt; <a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a> &amp;&amp;
<a name='L1837'>            <a href='../D/1611.html' title='Multiple defined in 2 places.'>arena_mapbits_allocated_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages) == 0 &amp;&amp;
<a name='L1838'>            (followsize = <a href='../D/1622.html' title='Multiple defined in 2 places.'>arena_mapbits_unallocated_size_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>,
<a name='L1839'>            pageind+npages)) &gt;= size - oldsize) <font color='red'>{</font>
<a name='L1840'>                <i><font color='green'>/*</font></i>
<a name='L1841'><i><font color='green'>                 * The next run is available and sufficiently large.  Split the</font></i>
<a name='L1842'><i><font color='green'>                 * following run, then merge the first part with the existing</font></i>
<a name='L1843'><i><font color='green'>                 * allocation.</font></i>
<a name='L1844'><i><font color='green'>                 */</font></i>
<a name='L1845'>                size_t flag_dirty;
<a name='L1846'>                size_t splitsize = (oldsize + followsize &lt;= size + extra)
<a name='L1847'>                    ? followsize : size + extra - oldsize;
<a name='L1848'>                <a href='../S/203.html#L372' title='Defined at 372 in deps/jemalloc/src/arena.c.'>arena_run_split</a>(arena, (<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> +
<a name='L1849'>                    ((pageind+npages) &lt;&lt; LG_PAGE)), splitsize, <a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>,
<a name='L1850'>                    <a href='../S/146.html#L148' title='Defined at 148 in deps/jemalloc/include/jemalloc/internal/arena.h.'>BININD_INVALID</a>, zero);
<a name='L1851'>
<a name='L1852'>                size = oldsize + splitsize;
<a name='L1853'>                npages = size &gt;&gt; LG_PAGE;
<a name='L1854'>
<a name='L1855'>                <i><font color='green'>/*</font></i>
<a name='L1856'><i><font color='green'>                 * Mark the extended run as dirty if either portion of the run</font></i>
<a name='L1857'><i><font color='green'>                 * was dirty before allocation.  This is rather pedantic,</font></i>
<a name='L1858'><i><font color='green'>                 * because there's not actually any sequence of events that</font></i>
<a name='L1859'><i><font color='green'>                 * could cause the resulting run to be passed to</font></i>
<a name='L1860'><i><font color='green'>                 * arena_run_dalloc() with the dirty argument set to false</font></i>
<a name='L1861'><i><font color='green'>                 * (which is when dirty flag consistency would really matter).</font></i>
<a name='L1862'><i><font color='green'>                 */</font></i>
<a name='L1863'>                flag_dirty = <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind) |
<a name='L1864'>                    <a href='../D/1613.html' title='Multiple defined in 2 places.'>arena_mapbits_dirty_get</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages-1);
<a name='L1865'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind, size, flag_dirty);
<a name='L1866'>                <a href='../D/1617.html' title='Multiple defined in 2 places.'>arena_mapbits_large_set</a>(<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, pageind+npages-1, 0, flag_dirty);
<a name='L1867'>
<a name='L1868'>                <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L1869'>                        arena-&gt;stats.ndalloc_large++;
<a name='L1870'>                        arena-&gt;stats.allocated_large -= oldsize;
<a name='L1871'>                        arena-&gt;stats.lstats[(oldsize &gt;&gt; LG_PAGE) - 1].ndalloc++;
<a name='L1872'>                        arena-&gt;stats.lstats[(oldsize &gt;&gt; LG_PAGE) - 1].curruns--;
<a name='L1873'>
<a name='L1874'>                        arena-&gt;stats.nmalloc_large++;
<a name='L1875'>                        arena-&gt;stats.nrequests_large++;
<a name='L1876'>                        arena-&gt;stats.allocated_large += size;
<a name='L1877'>                        arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nmalloc++;
<a name='L1878'>                        arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].nrequests++;
<a name='L1879'>                        arena-&gt;stats.lstats[(size &gt;&gt; LG_PAGE) - 1].curruns++;
<a name='L1880'>                <font color='red'>}</font>
<a name='L1881'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1882'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1883'>        <font color='red'>}</font>
<a name='L1884'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L1885'>
<a name='L1886'>        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L1887'><font color='red'>}</font>
<a name='L1888'>
<a name='L1889'><i><font color='green'>/*</font></i>
<a name='L1890'><i><font color='green'> * Try to resize a large allocation, in order to avoid copying.  This will</font></i>
<a name='L1891'><i><font color='green'> * always fail if growing an object, and the following run is already in use.</font></i>
<a name='L1892'><i><font color='green'> */</font></i>
<a name='L1893'><b>static</b> <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L1894'><a href='../R/1376.html' title='Multiple refered from 2 places.'>arena_ralloc_large</a>(<b>void</b> *ptr, size_t oldsize, size_t size, size_t extra,
<a name='L1895'>    bool zero)
<a name='L1896'><font color='red'>{</font>
<a name='L1897'>        size_t psize;
<a name='L1898'>
<a name='L1899'>        psize = PAGE_CEILING(size + extra);
<a name='L1900'>        <b>if</b> (psize == oldsize) <font color='red'>{</font>
<a name='L1901'>                <i><font color='green'>/* Same size class. */</font></i>
<a name='L1902'>                <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a> &amp;&amp; size &lt; oldsize) <font color='red'>{</font>
<a name='L1903'>                        memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + size), 0x5a, oldsize -
<a name='L1904'>                            size);
<a name='L1905'>                <font color='red'>}</font>
<a name='L1906'>                <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1907'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1908'>                <a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *<a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>;
<a name='L1909'>                <a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena;
<a name='L1910'>
<a name='L1911'>                <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a> = (<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a> *)<a href='../S/142.html#L11' title='Defined at 11 in deps/jemalloc/include/jemalloc/internal/chunk.h.'>CHUNK_ADDR2BASE</a>(ptr);
<a name='L1912'>                arena = <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>-&gt;arena;
<a name='L1913'>
<a name='L1914'>                <b>if</b> (psize &lt; oldsize) <font color='red'>{</font>
<a name='L1915'>                        <i><font color='green'>/* Fill before shrinking in order avoid a race. */</font></i>
<a name='L1916'>                        <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a>) <font color='red'>{</font>
<a name='L1917'>                                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + size), 0x5a,
<a name='L1918'>                                    oldsize - size);
<a name='L1919'>                        <font color='red'>}</font>
<a name='L1920'>                        <a href='../S/203.html#L1794' title='Defined at 1794 in deps/jemalloc/src/arena.c.'>arena_ralloc_large_shrink</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ptr, oldsize,
<a name='L1921'>                            psize);
<a name='L1922'>                        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L1923'>                <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1924'>                        <a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a> ret = <a href='../S/203.html#L1824' title='Defined at 1824 in deps/jemalloc/src/arena.c.'>arena_ralloc_large_grow</a>(arena, <a href='../S/304.html#L1325' title='Defined at 1325 in deps/lua/src/lparser.c.'>chunk</a>, ptr,
<a name='L1925'>                            oldsize, PAGE_CEILING(size),
<a name='L1926'>                            psize - PAGE_CEILING(size), zero);
<a name='L1927'>                        <b>if</b> (config_fill &amp;&amp; ret == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> &amp;&amp; zero == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a> &amp;&amp;
<a name='L1928'>                            <a href='../S/138.html#L260' title='Defined at 260 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_zero</a>) <font color='red'>{</font>
<a name='L1929'>                                memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + oldsize), 0,
<a name='L1930'>                                    size - oldsize);
<a name='L1931'>                        <font color='red'>}</font>
<a name='L1932'>                        <b>return</b> (ret);
<a name='L1933'>                <font color='red'>}</font>
<a name='L1934'>        <font color='red'>}</font>
<a name='L1935'><font color='red'>}</font>
<a name='L1936'>
<a name='L1937'><b>void</b> *
<a name='L1938'><a href='../R/1379.html' title='Multiple refered from 3 places.'>arena_ralloc_no_move</a>(<b>void</b> *ptr, size_t oldsize, size_t size, size_t extra,
<a name='L1939'>    bool zero)
<a name='L1940'><font color='red'>{</font>
<a name='L1941'>
<a name='L1942'>        <i><font color='green'>/*</font></i>
<a name='L1943'><i><font color='green'>         * Avoid moving the allocation if the size class can be left the same.</font></i>
<a name='L1944'><i><font color='green'>         */</font></i>
<a name='L1945'>        <b>if</b> (oldsize &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>) <font color='red'>{</font>
<a name='L1946'>                <b>if</b> (oldsize &lt;= SMALL_MAXCLASS) <font color='red'>{</font>
<a name='L1947'>                        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[<a href='../S/146.html#L395' title='Defined at 395 in deps/jemalloc/include/jemalloc/internal/arena.h.'>SMALL_SIZE2BIN</a>(oldsize)].reg_size
<a name='L1948'>                            == oldsize);
<a name='L1949'>                        <b>if</b> ((size + extra &lt;= SMALL_MAXCLASS &amp;&amp;
<a name='L1950'>                            <a href='../S/146.html#L395' title='Defined at 395 in deps/jemalloc/include/jemalloc/internal/arena.h.'>SMALL_SIZE2BIN</a>(size + extra) ==
<a name='L1951'>                            <a href='../S/146.html#L395' title='Defined at 395 in deps/jemalloc/include/jemalloc/internal/arena.h.'>SMALL_SIZE2BIN</a>(oldsize)) || (size &lt;= oldsize &amp;&amp;
<a name='L1952'>                            size + extra &gt;= oldsize)) <font color='red'>{</font>
<a name='L1953'>                                <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L239' title='Defined at 239 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_junk</a> &amp;&amp; size &lt; oldsize) <font color='red'>{</font>
<a name='L1954'>                                        memset((<b>void</b> *)((<a href='../D/4441.html' title='Multiple defined in 2 places.'>uintptr_t</a>)ptr + size),
<a name='L1955'>                                            0x5a, oldsize - size);
<a name='L1956'>                                <font color='red'>}</font>
<a name='L1957'>                                <b>return</b> (ptr);
<a name='L1958'>                        <font color='red'>}</font>
<a name='L1959'>                <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L1960'>                        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(size &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L1961'>                        <b>if</b> (size + extra &gt; SMALL_MAXCLASS) <font color='red'>{</font>
<a name='L1962'>                                <b>if</b> (<a href='../S/203.html#L1894' title='Defined at 1894 in deps/jemalloc/src/arena.c.'>arena_ralloc_large</a>(ptr, oldsize, size,
<a name='L1963'>                                    extra, zero) == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>)
<a name='L1964'>                                        <b>return</b> (ptr);
<a name='L1965'>                        <font color='red'>}</font>
<a name='L1966'>                <font color='red'>}</font>
<a name='L1967'>        <font color='red'>}</font>
<a name='L1968'>
<a name='L1969'>        <i><font color='green'>/* Reallocation would require a move. */</font></i>
<a name='L1970'>        <b>return</b> (NULL);
<a name='L1971'><font color='red'>}</font>
<a name='L1972'>
<a name='L1973'><b>void</b> *
<a name='L1974'><a href='../R/1375.html' title='Multiple refered from 2 places.'>arena_ralloc</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <b>void</b> *ptr, size_t oldsize, size_t size,
<a name='L1975'>    size_t extra, size_t alignment, bool zero, bool try_tcache_alloc,
<a name='L1976'>    bool try_tcache_dalloc)
<a name='L1977'><font color='red'>{</font>
<a name='L1978'>        <b>void</b> *ret;
<a name='L1979'>        size_t copysize;
<a name='L1980'>
<a name='L1981'>        <i><font color='green'>/* Try to avoid moving the allocation. */</font></i>
<a name='L1982'>        ret = <a href='../D/1646.html' title='Multiple defined in 2 places.'>arena_ralloc_no_move</a>(ptr, oldsize, size, extra, zero);
<a name='L1983'>        <b>if</b> (ret != NULL)
<a name='L1984'>                <b>return</b> (ret);
<a name='L1985'>
<a name='L1986'>        <i><font color='green'>/*</font></i>
<a name='L1987'><i><font color='green'>         * size and oldsize are different enough that we need to move the</font></i>
<a name='L1988'><i><font color='green'>         * object.  In that case, fall back to allocating new space and</font></i>
<a name='L1989'><i><font color='green'>         * copying.</font></i>
<a name='L1990'><i><font color='green'>         */</font></i>
<a name='L1991'>        <b>if</b> (alignment != 0) <font color='red'>{</font>
<a name='L1992'>                size_t usize = <a href='../S/138.html#L310' title='Defined at 310 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>sa2u</a>(size + extra, alignment);
<a name='L1993'>                <b>if</b> (usize == 0)
<a name='L1994'>                        <b>return</b> (NULL);
<a name='L1995'>                ret = <a href='../S/138.html#L201' title='Defined at 201 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>ipallocx</a>(usize, alignment, zero, try_tcache_alloc, arena);
<a name='L1996'>        <font color='red'>}</font> <b>else</b>
<a name='L1997'>                ret = <a href='../D/1608.html' title='Multiple defined in 2 places.'>arena_malloc</a>(arena, size + extra, zero, try_tcache_alloc);
<a name='L1998'>
<a name='L1999'>        <b>if</b> (ret == NULL) <font color='red'>{</font>
<a name='L2000'>                <b>if</b> (extra == 0)
<a name='L2001'>                        <b>return</b> (NULL);
<a name='L2002'>                <i><font color='green'>/* Try again, this time without extra. */</font></i>
<a name='L2003'>                <b>if</b> (alignment != 0) <font color='red'>{</font>
<a name='L2004'>                        size_t usize = <a href='../S/138.html#L310' title='Defined at 310 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>sa2u</a>(size, alignment);
<a name='L2005'>                        <b>if</b> (usize == 0)
<a name='L2006'>                                <b>return</b> (NULL);
<a name='L2007'>                        ret = <a href='../S/138.html#L201' title='Defined at 201 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>ipallocx</a>(usize, alignment, zero, try_tcache_alloc,
<a name='L2008'>                            arena);
<a name='L2009'>                <font color='red'>}</font> <b>else</b>
<a name='L2010'>                        ret = <a href='../D/1608.html' title='Multiple defined in 2 places.'>arena_malloc</a>(arena, size, zero, try_tcache_alloc);
<a name='L2011'>
<a name='L2012'>                <b>if</b> (ret == NULL)
<a name='L2013'>                        <b>return</b> (NULL);
<a name='L2014'>        <font color='red'>}</font>
<a name='L2015'>
<a name='L2016'>        <i><font color='green'>/* Junk/zero-filling were already done by ipalloc()/arena_malloc(). */</font></i>
<a name='L2017'>
<a name='L2018'>        <i><font color='green'>/*</font></i>
<a name='L2019'><i><font color='green'>         * Copy at most size bytes (not size+extra), since the caller has no</font></i>
<a name='L2020'><i><font color='green'>         * expectation that the extra bytes will be reliably preserved.</font></i>
<a name='L2021'><i><font color='green'>         */</font></i>
<a name='L2022'>        copysize = (size &lt; oldsize) ? size : oldsize;
<a name='L2023'>        VALGRIND_MAKE_MEM_UNDEFINED(ret, copysize);
<a name='L2024'>        memcpy(ret, ptr, copysize);
<a name='L2025'>        <a href='../S/138.html#L203' title='Defined at 203 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>iqallocx</a>(ptr, try_tcache_dalloc);
<a name='L2026'>        <b>return</b> (ret);
<a name='L2027'><font color='red'>}</font>
<a name='L2028'>
<a name='L2029'><a href='../S/130.html#L10' title='Defined at 10 in deps/jemalloc/include/jemalloc/internal/chunk_dss.h.'>dss_prec_t</a>
<a name='L2030'><a href='../R/1339.html' title='Multiple refered from 3 places.'>arena_dss_prec_get</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L2031'><font color='red'>{</font>
<a name='L2032'>        <a href='../S/130.html#L10' title='Defined at 10 in deps/jemalloc/include/jemalloc/internal/chunk_dss.h.'>dss_prec_t</a> ret;
<a name='L2033'>
<a name='L2034'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L2035'>        ret = arena-&gt;dss_prec;
<a name='L2036'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L2037'>        <b>return</b> (ret);
<a name='L2038'><font color='red'>}</font>
<a name='L2039'>
<a name='L2040'><b>void</b>
<a name='L2041'><a href='../R/1340.html' title='Multiple refered from 3 places.'>arena_dss_prec_set</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <a href='../S/130.html#L10' title='Defined at 10 in deps/jemalloc/include/jemalloc/internal/chunk_dss.h.'>dss_prec_t</a> dss_prec)
<a name='L2042'><font color='red'>{</font>
<a name='L2043'>
<a name='L2044'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L2045'>        arena-&gt;dss_prec = dss_prec;
<a name='L2046'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L2047'><font color='red'>}</font>
<a name='L2048'>
<a name='L2049'><b>void</b>
<a name='L2050'><a href='../R/1394.html' title='Multiple refered from 3 places.'>arena_stats_merge</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <b>const</b> <b>char</b> **dss, size_t *nactive,
<a name='L2051'>    size_t *ndirty, <a href='../S/137.html#L7' title='Defined at 7 in deps/jemalloc/include/jemalloc/internal/stats.h.'>arena_stats_t</a> *astats, <a href='../S/137.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_bin_stats_t</a> *bstats,
<a name='L2052'>    <a href='../S/137.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_large_stats_t</a> *lstats)
<a name='L2053'><font color='red'>{</font>
<a name='L2054'>        <b>unsigned</b> i;
<a name='L2055'>
<a name='L2056'>        <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;arena-&gt;lock);
<a name='L2057'>        *dss = <a href='../S/138.html#L142' title='Defined at 142 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>dss_prec_names</a>[arena-&gt;dss_prec];
<a name='L2058'>        *nactive += arena-&gt;nactive;
<a name='L2059'>        *ndirty += arena-&gt;ndirty;
<a name='L2060'>
<a name='L2061'>        astats-&gt;mapped += arena-&gt;stats.mapped;
<a name='L2062'>        astats-&gt;npurge += arena-&gt;stats.npurge;
<a name='L2063'>        astats-&gt;nmadvise += arena-&gt;stats.nmadvise;
<a name='L2064'>        astats-&gt;purged += arena-&gt;stats.purged;
<a name='L2065'>        astats-&gt;allocated_large += arena-&gt;stats.allocated_large;
<a name='L2066'>        astats-&gt;nmalloc_large += arena-&gt;stats.nmalloc_large;
<a name='L2067'>        astats-&gt;ndalloc_large += arena-&gt;stats.ndalloc_large;
<a name='L2068'>        astats-&gt;nrequests_large += arena-&gt;stats.nrequests_large;
<a name='L2069'>
<a name='L2070'>        <b>for</b> (i = 0; i &lt; <a href='../S/146.html#L400' title='Defined at 400 in deps/jemalloc/include/jemalloc/internal/arena.h.'>nlclasses</a>; i++) <font color='red'>{</font>
<a name='L2071'>                lstats[i].nmalloc += arena-&gt;stats.lstats[i].nmalloc;
<a name='L2072'>                lstats[i].ndalloc += arena-&gt;stats.lstats[i].ndalloc;
<a name='L2073'>                lstats[i].nrequests += arena-&gt;stats.lstats[i].nrequests;
<a name='L2074'>                lstats[i].curruns += arena-&gt;stats.lstats[i].curruns;
<a name='L2075'>        <font color='red'>}</font>
<a name='L2076'>        <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;arena-&gt;lock);
<a name='L2077'>
<a name='L2078'>        <b>for</b> (i = 0; i &lt; NBINS; i++) <font color='red'>{</font>
<a name='L2079'>                <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin = &amp;arena-&gt;bins[i];
<a name='L2080'>
<a name='L2081'>                <a href='../D/3273.html' title='Multiple defined in 2 places.'>malloc_mutex_lock</a>(&amp;bin-&gt;lock);
<a name='L2082'>                bstats[i].allocated += bin-&gt;stats.allocated;
<a name='L2083'>                bstats[i].nmalloc += bin-&gt;stats.nmalloc;
<a name='L2084'>                bstats[i].ndalloc += bin-&gt;stats.ndalloc;
<a name='L2085'>                bstats[i].nrequests += bin-&gt;stats.nrequests;
<a name='L2086'>                <b>if</b> (config_tcache) <font color='red'>{</font>
<a name='L2087'>                        bstats[i].nfills += bin-&gt;stats.nfills;
<a name='L2088'>                        bstats[i].nflushes += bin-&gt;stats.nflushes;
<a name='L2089'>                <font color='red'>}</font>
<a name='L2090'>                bstats[i].nruns += bin-&gt;stats.nruns;
<a name='L2091'>                bstats[i].reruns += bin-&gt;stats.reruns;
<a name='L2092'>                bstats[i].curruns += bin-&gt;stats.curruns;
<a name='L2093'>                <a href='../D/3279.html' title='Multiple defined in 2 places.'>malloc_mutex_unlock</a>(&amp;bin-&gt;lock);
<a name='L2094'>        <font color='red'>}</font>
<a name='L2095'><font color='red'>}</font>
<a name='L2096'>
<a name='L2097'><a href='../S/159.html#L10' title='Defined at 10 in deps/jemalloc/include/msvc_compat/stdbool.h.'>bool</a>
<a name='L2098'><a href='../R/1363.html' title='Multiple refered from 3 places.'>arena_new</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena, <b>unsigned</b> ind)
<a name='L2099'><font color='red'>{</font>
<a name='L2100'>        <b>unsigned</b> i;
<a name='L2101'>        <a href='../S/146.html#L50' title='Defined at 50 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_t</a> *bin;
<a name='L2102'>
<a name='L2103'>        arena-&gt;ind = ind;
<a name='L2104'>        arena-&gt;nthreads = 0;
<a name='L2105'>
<a name='L2106'>        <b>if</b> (<a href='../D/3272.html' title='Multiple defined in 2 places.'>malloc_mutex_init</a>(&amp;arena-&gt;lock))
<a name='L2107'>                <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L2108'>
<a name='L2109'>        <b>if</b> (config_stats) <font color='red'>{</font>
<a name='L2110'>                memset(&amp;arena-&gt;stats, 0, <b>sizeof</b>(<a href='../S/137.html#L7' title='Defined at 7 in deps/jemalloc/include/jemalloc/internal/stats.h.'>arena_stats_t</a>));
<a name='L2111'>                arena-&gt;stats.lstats =
<a name='L2112'>                    (<a href='../S/137.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_large_stats_t</a> *)<a href='../D/1715.html' title='Multiple defined in 2 places.'>base_alloc</a>(<a href='../S/146.html#L400' title='Defined at 400 in deps/jemalloc/include/jemalloc/internal/arena.h.'>nlclasses</a> *
<a name='L2113'>                    <b>sizeof</b>(<a href='../S/137.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_large_stats_t</a>));
<a name='L2114'>                <b>if</b> (arena-&gt;stats.lstats == NULL)
<a name='L2115'>                        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L2116'>                memset(arena-&gt;stats.lstats, 0, <a href='../S/146.html#L400' title='Defined at 400 in deps/jemalloc/include/jemalloc/internal/arena.h.'>nlclasses</a> *
<a name='L2117'>                    <b>sizeof</b>(<a href='../S/137.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_large_stats_t</a>));
<a name='L2118'>                <b>if</b> (config_tcache)
<a name='L2119'>                        <a href='../S/136.html#L14' title='Defined at 14 in deps/jemalloc/include/jemalloc/internal/ql.h.'>ql_new</a>(&amp;arena-&gt;tcache_ql);
<a name='L2120'>        <font color='red'>}</font>
<a name='L2121'>
<a name='L2122'>        <b>if</b> (config_prof)
<a name='L2123'>                arena-&gt;prof_accumbytes = 0;
<a name='L2124'>
<a name='L2125'>        arena-&gt;dss_prec = <a href='../D/1849.html' title='Multiple defined in 2 places.'>chunk_dss_prec_get</a>();
<a name='L2126'>
<a name='L2127'>        <i><font color='green'>/* Initialize chunks. */</font></i>
<a name='L2128'>        arena_chunk_dirty_new(&amp;arena-&gt;chunks_dirty);
<a name='L2129'>        arena-&gt;spare = NULL;
<a name='L2130'>
<a name='L2131'>        arena-&gt;nactive = 0;
<a name='L2132'>        arena-&gt;ndirty = 0;
<a name='L2133'>        arena-&gt;npurgatory = 0;
<a name='L2134'>
<a name='L2135'>        arena_avail_tree_new(&amp;arena-&gt;runs_avail);
<a name='L2136'>
<a name='L2137'>        <i><font color='green'>/* Initialize bins. */</font></i>
<a name='L2138'>        <b>for</b> (i = 0; i &lt; NBINS; i++) <font color='red'>{</font>
<a name='L2139'>                bin = &amp;arena-&gt;bins[i];
<a name='L2140'>                <b>if</b> (<a href='../D/3272.html' title='Multiple defined in 2 places.'>malloc_mutex_init</a>(&amp;bin-&gt;lock))
<a name='L2141'>                        <b>return</b> (<a href='../S/159.html#L11' title='Defined at 11 in deps/jemalloc/include/msvc_compat/stdbool.h.'>true</a>);
<a name='L2142'>                bin-&gt;runcur = NULL;
<a name='L2143'>                arena_run_tree_new(&amp;bin-&gt;runs);
<a name='L2144'>                <b>if</b> (config_stats)
<a name='L2145'>                        memset(&amp;bin-&gt;stats, 0, <b>sizeof</b>(<a href='../S/137.html#L5' title='Defined at 5 in deps/jemalloc/include/jemalloc/internal/stats.h.'>malloc_bin_stats_t</a>));
<a name='L2146'>        <font color='red'>}</font>
<a name='L2147'>
<a name='L2148'>        <b>return</b> (<a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>);
<a name='L2149'><font color='red'>}</font>
<a name='L2150'>
<a name='L2151'><i><font color='green'>/*</font></i>
<a name='L2152'><i><font color='green'> * Calculate bin_info-&gt;run_size such that it meets the following constraints:</font></i>
<a name='L2153'><i><font color='green'> *</font></i>
<a name='L2154'><i><font color='green'> *   *) bin_info-&gt;run_size &gt;= min_run_size</font></i>
<a name='L2155'><i><font color='green'> *   *) bin_info-&gt;run_size &lt;= arena_maxclass</font></i>
<a name='L2156'><i><font color='green'> *   *) run header overhead &lt;= RUN_MAX_OVRHD (or header overhead relaxed).</font></i>
<a name='L2157'><i><font color='green'> *   *) bin_info-&gt;nregs &lt;= RUN_MAXREGS</font></i>
<a name='L2158'><i><font color='green'> *</font></i>
<a name='L2159'><i><font color='green'> * bin_info-&gt;nregs, bin_info-&gt;bitmap_offset, and bin_info-&gt;reg0_offset are also</font></i>
<a name='L2160'><i><font color='green'> * calculated here, since these settings are all interdependent.</font></i>
<a name='L2161'><i><font color='green'> */</font></i>
<a name='L2162'><b>static</b> size_t
<a name='L2163'><a href='../R/1457.html' title='Multiple refered from 2 places.'>bin_info_run_size_calc</a>(<a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info, size_t min_run_size)
<a name='L2164'><font color='red'>{</font>
<a name='L2165'>        size_t pad_size;
<a name='L2166'>        size_t try_run_size, good_run_size;
<a name='L2167'>        <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> try_nregs, good_nregs;
<a name='L2168'>        <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> try_hdr_size, good_hdr_size;
<a name='L2169'>        <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> try_bitmap_offset, good_bitmap_offset;
<a name='L2170'>        <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> try_ctx0_offset, good_ctx0_offset;
<a name='L2171'>        <a href='../D/4429.html' title='Multiple defined in 2 places.'>uint32_t</a> try_redzone0_offset, good_redzone0_offset;
<a name='L2172'>
<a name='L2173'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(min_run_size &gt;= PAGE);
<a name='L2174'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(min_run_size &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>);
<a name='L2175'>
<a name='L2176'>        <i><font color='green'>/*</font></i>
<a name='L2177'><i><font color='green'>         * Determine redzone size based on minimum alignment and minimum</font></i>
<a name='L2178'><i><font color='green'>         * redzone size.  Add padding to the end of the run if it is needed to</font></i>
<a name='L2179'><i><font color='green'>         * align the regions.  The padding allows each redzone to be half the</font></i>
<a name='L2180'><i><font color='green'>         * minimum alignment; without the padding, each redzone would have to</font></i>
<a name='L2181'><i><font color='green'>         * be twice as large in order to maintain alignment.</font></i>
<a name='L2182'><i><font color='green'>         */</font></i>
<a name='L2183'>        <b>if</b> (config_fill &amp;&amp; <a href='../S/138.html#L254' title='Defined at 254 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_redzone</a>) <font color='red'>{</font>
<a name='L2184'>                size_t align_min = ZU(1) &lt;&lt; (<a href='../S/157.html#L17' title='Defined at 17 in deps/jemalloc/include/msvc_compat/strings.h.'>ffs</a>(bin_info-&gt;reg_size) - 1);
<a name='L2185'>                <b>if</b> (align_min &lt;= <a href='../S/146.html#L34' title='Defined at 34 in deps/jemalloc/include/jemalloc/internal/arena.h.'>REDZONE_MINSIZE</a>) <font color='red'>{</font>
<a name='L2186'>                        bin_info-&gt;redzone_size = <a href='../S/146.html#L34' title='Defined at 34 in deps/jemalloc/include/jemalloc/internal/arena.h.'>REDZONE_MINSIZE</a>;
<a name='L2187'>                        pad_size = 0;
<a name='L2188'>                <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L2189'>                        bin_info-&gt;redzone_size = align_min &gt;&gt; 1;
<a name='L2190'>                        pad_size = bin_info-&gt;redzone_size;
<a name='L2191'>                <font color='red'>}</font>
<a name='L2192'>        <font color='red'>}</font> <b>else</b> <font color='red'>{</font>
<a name='L2193'>                bin_info-&gt;redzone_size = 0;
<a name='L2194'>                pad_size = 0;
<a name='L2195'>        <font color='red'>}</font>
<a name='L2196'>        bin_info-&gt;reg_interval = bin_info-&gt;reg_size +
<a name='L2197'>            (bin_info-&gt;redzone_size &lt;&lt; 1);
<a name='L2198'>
<a name='L2199'>        <i><font color='green'>/*</font></i>
<a name='L2200'><i><font color='green'>         * Calculate known-valid settings before entering the run_size</font></i>
<a name='L2201'><i><font color='green'>         * expansion loop, so that the first part of the loop always copies</font></i>
<a name='L2202'><i><font color='green'>         * valid settings.</font></i>
<a name='L2203'><i><font color='green'>         *</font></i>
<a name='L2204'><i><font color='green'>         * The do..while loop iteratively reduces the number of regions until</font></i>
<a name='L2205'><i><font color='green'>         * the run header and the regions no longer overlap.  A closed formula</font></i>
<a name='L2206'><i><font color='green'>         * would be quite messy, since there is an interdependency between the</font></i>
<a name='L2207'><i><font color='green'>         * header's mask length and the number of regions.</font></i>
<a name='L2208'><i><font color='green'>         */</font></i>
<a name='L2209'>        try_run_size = min_run_size;
<a name='L2210'>        try_nregs = ((try_run_size - <b>sizeof</b>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>)) /
<a name='L2211'>            bin_info-&gt;reg_interval)
<a name='L2212'>            + 1; <i><font color='green'>/* Counter-act try_nregs-- in loop. */</font></i>
<a name='L2213'>        <b>if</b> (try_nregs &gt; <a href='../S/146.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAXREGS</a>) <font color='red'>{</font>
<a name='L2214'>                try_nregs = <a href='../S/146.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAXREGS</a>
<a name='L2215'>                    + 1; <i><font color='green'>/* Counter-act try_nregs-- in loop. */</font></i>
<a name='L2216'>        <font color='red'>}</font>
<a name='L2217'>        <b>do</b> <font color='red'>{</font>
<a name='L2218'>                try_nregs--;
<a name='L2219'>                try_hdr_size = <b>sizeof</b>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>);
<a name='L2220'>                <i><font color='green'>/* Pad to a long boundary. */</font></i>
<a name='L2221'>                try_hdr_size = LONG_CEILING(try_hdr_size);
<a name='L2222'>                try_bitmap_offset = try_hdr_size;
<a name='L2223'>                <i><font color='green'>/* Add space for bitmap. */</font></i>
<a name='L2224'>                try_hdr_size += <a href='../D/1752.html' title='Multiple defined in 2 places.'>bitmap_size</a>(try_nregs);
<a name='L2225'>                <b>if</b> (config_prof &amp;&amp; <a href='../S/138.html#L246' title='Defined at 246 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_prof</a> &amp;&amp; <a href='../S/138.html#L280' title='Defined at 280 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>prof_promote</a> == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L2226'>                        <i><font color='green'>/* Pad to a quantum boundary. */</font></i>
<a name='L2227'>                        try_hdr_size = QUANTUM_CEILING(try_hdr_size);
<a name='L2228'>                        try_ctx0_offset = try_hdr_size;
<a name='L2229'>                        <i><font color='green'>/* Add space for one (prof_ctx_t *) per region. */</font></i>
<a name='L2230'>                        try_hdr_size += try_nregs * <b>sizeof</b>(<a href='../S/141.html#L7' title='Defined at 7 in deps/jemalloc/include/jemalloc/internal/prof.h.'>prof_ctx_t</a> *);
<a name='L2231'>                <font color='red'>}</font> <b>else</b>
<a name='L2232'>                        try_ctx0_offset = 0;
<a name='L2233'>                try_redzone0_offset = try_run_size - (try_nregs *
<a name='L2234'>                    bin_info-&gt;reg_interval) - pad_size;
<a name='L2235'>        <font color='red'>}</font> <b>while</b> (try_hdr_size &gt; try_redzone0_offset);
<a name='L2236'>
<a name='L2237'>        <i><font color='green'>/* run_size expansion loop. */</font></i>
<a name='L2238'>        <b>do</b> <font color='red'>{</font>
<a name='L2239'>                <i><font color='green'>/*</font></i>
<a name='L2240'><i><font color='green'>                 * Copy valid settings before trying more aggressive settings.</font></i>
<a name='L2241'><i><font color='green'>                 */</font></i>
<a name='L2242'>                good_run_size = try_run_size;
<a name='L2243'>                good_nregs = try_nregs;
<a name='L2244'>                good_hdr_size = try_hdr_size;
<a name='L2245'>                good_bitmap_offset = try_bitmap_offset;
<a name='L2246'>                good_ctx0_offset = try_ctx0_offset;
<a name='L2247'>                good_redzone0_offset = try_redzone0_offset;
<a name='L2248'>
<a name='L2249'>                <i><font color='green'>/* Try more aggressive settings. */</font></i>
<a name='L2250'>                try_run_size += PAGE;
<a name='L2251'>                try_nregs = ((try_run_size - <b>sizeof</b>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>) - pad_size) /
<a name='L2252'>                    bin_info-&gt;reg_interval)
<a name='L2253'>                    + 1; <i><font color='green'>/* Counter-act try_nregs-- in loop. */</font></i>
<a name='L2254'>                <b>if</b> (try_nregs &gt; <a href='../S/146.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAXREGS</a>) <font color='red'>{</font>
<a name='L2255'>                        try_nregs = <a href='../S/146.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAXREGS</a>
<a name='L2256'>                            + 1; <i><font color='green'>/* Counter-act try_nregs-- in loop. */</font></i>
<a name='L2257'>                <font color='red'>}</font>
<a name='L2258'>                <b>do</b> <font color='red'>{</font>
<a name='L2259'>                        try_nregs--;
<a name='L2260'>                        try_hdr_size = <b>sizeof</b>(<a href='../S/146.html#L48' title='Defined at 48 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_run_t</a>);
<a name='L2261'>                        <i><font color='green'>/* Pad to a long boundary. */</font></i>
<a name='L2262'>                        try_hdr_size = LONG_CEILING(try_hdr_size);
<a name='L2263'>                        try_bitmap_offset = try_hdr_size;
<a name='L2264'>                        <i><font color='green'>/* Add space for bitmap. */</font></i>
<a name='L2265'>                        try_hdr_size += <a href='../D/1752.html' title='Multiple defined in 2 places.'>bitmap_size</a>(try_nregs);
<a name='L2266'>                        <b>if</b> (config_prof &amp;&amp; <a href='../S/138.html#L246' title='Defined at 246 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>opt_prof</a> &amp;&amp; <a href='../S/138.html#L280' title='Defined at 280 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>prof_promote</a> == <a href='../S/159.html#L12' title='Defined at 12 in deps/jemalloc/include/msvc_compat/stdbool.h.'>false</a>) <font color='red'>{</font>
<a name='L2267'>                                <i><font color='green'>/* Pad to a quantum boundary. */</font></i>
<a name='L2268'>                                try_hdr_size = QUANTUM_CEILING(try_hdr_size);
<a name='L2269'>                                try_ctx0_offset = try_hdr_size;
<a name='L2270'>                                <i><font color='green'>/*</font></i>
<a name='L2271'><i><font color='green'>                                 * Add space for one (prof_ctx_t *) per region.</font></i>
<a name='L2272'><i><font color='green'>                                 */</font></i>
<a name='L2273'>                                try_hdr_size += try_nregs *
<a name='L2274'>                                    <b>sizeof</b>(<a href='../S/141.html#L7' title='Defined at 7 in deps/jemalloc/include/jemalloc/internal/prof.h.'>prof_ctx_t</a> *);
<a name='L2275'>                        <font color='red'>}</font>
<a name='L2276'>                        try_redzone0_offset = try_run_size - (try_nregs *
<a name='L2277'>                            bin_info-&gt;reg_interval) - pad_size;
<a name='L2278'>                <font color='red'>}</font> <b>while</b> (try_hdr_size &gt; try_redzone0_offset);
<a name='L2279'>        <font color='red'>}</font> <b>while</b> (try_run_size &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>
<a name='L2280'>            &amp;&amp; try_run_size &lt;= <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a>
<a name='L2281'>            &amp;&amp; <a href='../S/146.html#L23' title='Defined at 23 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAX_OVRHD</a> * (bin_info-&gt;reg_interval &lt;&lt; 3) &gt;
<a name='L2282'>            <a href='../S/146.html#L24' title='Defined at 24 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAX_OVRHD_RELAX</a>
<a name='L2283'>            &amp;&amp; (try_redzone0_offset &lt;&lt; <a href='../S/146.html#L21' title='Defined at 21 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_BFP</a>) &gt; <a href='../S/146.html#L23' title='Defined at 23 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAX_OVRHD</a> * try_run_size
<a name='L2284'>            &amp;&amp; try_nregs &lt; <a href='../S/146.html#L28' title='Defined at 28 in deps/jemalloc/include/jemalloc/internal/arena.h.'>RUN_MAXREGS</a>);
<a name='L2285'>
<a name='L2286'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(good_hdr_size &lt;= good_redzone0_offset);
<a name='L2287'>
<a name='L2288'>        <i><font color='green'>/* Copy final settings. */</font></i>
<a name='L2289'>        bin_info-&gt;run_size = good_run_size;
<a name='L2290'>        bin_info-&gt;nregs = good_nregs;
<a name='L2291'>        bin_info-&gt;bitmap_offset = good_bitmap_offset;
<a name='L2292'>        bin_info-&gt;ctx0_offset = good_ctx0_offset;
<a name='L2293'>        bin_info-&gt;reg0_offset = good_redzone0_offset + bin_info-&gt;redzone_size;
<a name='L2294'>
<a name='L2295'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(bin_info-&gt;reg0_offset - bin_info-&gt;redzone_size + (bin_info-&gt;nregs
<a name='L2296'>            * bin_info-&gt;reg_interval) + pad_size == bin_info-&gt;run_size);
<a name='L2297'>
<a name='L2298'>        <b>return</b> (good_run_size);
<a name='L2299'><font color='red'>}</font>
<a name='L2300'>
<a name='L2301'><b>static</b> <b>void</b>
<a name='L2302'><a href='../R/1456.html' title='Multiple refered from 2 places.'>bin_info_init</a>(<b>void</b>)
<a name='L2303'><font color='red'>{</font>
<a name='L2304'>        <a href='../S/146.html#L49' title='Defined at 49 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_bin_info_t</a> *bin_info;
<a name='L2305'>        size_t prev_run_size = PAGE;
<a name='L2306'>
<a name='L2307'><font color='darkred'>#define</font> SIZE_CLASS(bin, delta, size)                                    \
<a name='L2308'>        bin_info = &amp;<a href='../S/138.html#L6' title='Defined at 6 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_bin_info</a>[bin];                                \
<a name='L2309'>        bin_info-&gt;reg_size = size;                                      \
<a name='L2310'>        prev_run_size = <a href='../S/203.html#L2163' title='Defined at 2163 in deps/jemalloc/src/arena.c.'>bin_info_run_size_calc</a>(bin_info, prev_run_size);\
<a name='L2311'>        <a href='../D/1743.html' title='Multiple defined in 2 places.'>bitmap_info_init</a>(&amp;bin_info-&gt;bitmap_info, bin_info-&gt;nregs);
<a name='L2312'>        SIZE_CLASSES
<a name='L2313'><font color='darkred'>#undef</font> SIZE_CLASS
<a name='L2314'><font color='red'>}</font>
<a name='L2315'>
<a name='L2316'><b>void</b>
<a name='L2317'><a href='../R/1320.html' title='Multiple refered from 3 places.'>arena_boot</a>(<b>void</b>)
<a name='L2318'><font color='red'>{</font>
<a name='L2319'>        size_t header_size;
<a name='L2320'>        <b>unsigned</b> i;
<a name='L2321'>
<a name='L2322'>        <i><font color='green'>/*</font></i>
<a name='L2323'><i><font color='green'>         * Compute the header size such that it is large enough to contain the</font></i>
<a name='L2324'><i><font color='green'>         * page map.  The page map is biased to omit entries for the header</font></i>
<a name='L2325'><i><font color='green'>         * itself, so some iteration is necessary to compute the map bias.</font></i>
<a name='L2326'><i><font color='green'>         *</font></i>
<a name='L2327'><i><font color='green'>         * 1) Compute safe header_size and map_bias values that include enough</font></i>
<a name='L2328'><i><font color='green'>         *    space for an unbiased page map.</font></i>
<a name='L2329'><i><font color='green'>         * 2) Refine map_bias based on (1) to omit the header pages in the page</font></i>
<a name='L2330'><i><font color='green'>         *    map.  The resulting map_bias may be one too small.</font></i>
<a name='L2331'><i><font color='green'>         * 3) Refine map_bias based on (2).  The result will be &gt;= the result</font></i>
<a name='L2332'><i><font color='green'>         *    from (2), and will always be correct.</font></i>
<a name='L2333'><i><font color='green'>         */</font></i>
<a name='L2334'>        <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> = 0;
<a name='L2335'>        <b>for</b> (i = 0; i &lt; 3; i++) <font color='red'>{</font>
<a name='L2336'>                header_size = offsetof(<a href='../S/146.html#L47' title='Defined at 47 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_t</a>, map) +
<a name='L2337'>                    (<b>sizeof</b>(<a href='../S/146.html#L46' title='Defined at 46 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_chunk_map_t</a>) * (<a href='../S/138.html#L109' title='Defined at 109 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunk_npages</a>-<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a>));
<a name='L2338'>                <a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> = (header_size &gt;&gt; LG_PAGE) + ((header_size &amp; PAGE_MASK)
<a name='L2339'>                    != 0);
<a name='L2340'>        <font color='red'>}</font>
<a name='L2341'>        <a href='../D/1684.html' title='Multiple defined in 3 places.'>assert</a>(<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> &gt; 0);
<a name='L2342'>
<a name='L2343'>        <a href='../S/138.html#L37' title='Defined at 37 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>arena_maxclass</a> = <a href='../S/138.html#L116' title='Defined at 116 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>chunksize</a> - (<a href='../S/138.html#L230' title='Defined at 230 in deps/jemalloc/include/jemalloc/internal/private_namespace.h.'>map_bias</a> &lt;&lt; LG_PAGE);
<a name='L2344'>
<a name='L2345'>        <a href='../S/203.html#L2302' title='Defined at 2302 in deps/jemalloc/src/arena.c.'>bin_info_init</a>();
<a name='L2346'><font color='red'>}</font>
<a name='L2347'>
<a name='L2348'><b>void</b>
<a name='L2349'><a href='../R/1367.html' title='Multiple refered from 3 places.'>arena_prefork</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L2350'><font color='red'>{</font>
<a name='L2351'>        <b>unsigned</b> i;
<a name='L2352'>
<a name='L2353'>        <a href='../D/3276.html' title='Multiple defined in 2 places.'>malloc_mutex_prefork</a>(&amp;arena-&gt;lock);
<a name='L2354'>        <b>for</b> (i = 0; i &lt; NBINS; i++)
<a name='L2355'>                <a href='../D/3276.html' title='Multiple defined in 2 places.'>malloc_mutex_prefork</a>(&amp;arena-&gt;bins[i].lock);
<a name='L2356'><font color='red'>}</font>
<a name='L2357'>
<a name='L2358'><b>void</b>
<a name='L2359'><a href='../R/1366.html' title='Multiple refered from 3 places.'>arena_postfork_parent</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L2360'><font color='red'>{</font>
<a name='L2361'>        <b>unsigned</b> i;
<a name='L2362'>
<a name='L2363'>        <b>for</b> (i = 0; i &lt; NBINS; i++)
<a name='L2364'>                <a href='../D/3275.html' title='Multiple defined in 2 places.'>malloc_mutex_postfork_parent</a>(&amp;arena-&gt;bins[i].lock);
<a name='L2365'>        <a href='../D/3275.html' title='Multiple defined in 2 places.'>malloc_mutex_postfork_parent</a>(&amp;arena-&gt;lock);
<a name='L2366'><font color='red'>}</font>
<a name='L2367'>
<a name='L2368'><b>void</b>
<a name='L2369'><a href='../R/1365.html' title='Multiple refered from 3 places.'>arena_postfork_child</a>(<a href='../S/146.html#L51' title='Defined at 51 in deps/jemalloc/include/jemalloc/internal/arena.h.'>arena_t</a> *arena)
<a name='L2370'><font color='red'>{</font>
<a name='L2371'>        <b>unsigned</b> i;
<a name='L2372'>
<a name='L2373'>        <b>for</b> (i = 0; i &lt; NBINS; i++)
<a name='L2374'>                <a href='../D/3274.html' title='Multiple defined in 2 places.'>malloc_mutex_postfork_child</a>(&amp;arena-&gt;bins[i].lock);
<a name='L2375'>        <a href='../D/3274.html' title='Multiple defined in 2 places.'>malloc_mutex_postfork_child</a>(&amp;arena-&gt;lock);
<a name='L2376'><font color='red'>}</font>
</pre>
<hr>
<a name='BOTTOM'>
<i><font color='green'>/* [&lt;][&gt;]<a href='#L91'>[^]</a><a href='#L2369'>[v]</a><a href='#TOP'>[top]</a>[bottom]<a href='../mains.html'>[index]</a><a href='../help.html'>[help]</a> */</font></i>
</body>
</html>
